LINK MODEL "MPI_SENTIO" "742.004"
{
View model_window 1 "Model"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P34 P198 P357 C27"
element 0 "Name" "DriverVersion"
element 0 "Value" "WaferPro Express 700.100"
element 1 "Name" "Mode"
element 1 "Value" ""
element 2 "Name" "Debug"
element 2 "Value" "0"
element 3 "Name" "RoutineMdl"
element 3 "Value" ""
element 4 "Name" "OFFLINETest"
element 4 "Value" "0"
element 5 "Name" "____________________0"
element 5 "Value" ""
element 6 "Name" "MEASURE_FAST"
element 6 "Value" "YES"
element 7 "Name" "MDS_MEASURE_FAST"
element 7 "Value" "YES"
element 8 "Name" "____________________1"
element 8 "Value" ""
element 9 "Name" "Date"
element 9 "Value" ""
element 10 "Name" "Version"
element 10 "Value" ""
element 11 "Name" "____________________2"
element 11 "Value" ""
element 12 "Name" "bRet"
element 12 "Value" "1"
element 13 "Name" "ErrorMsg"
element 13 "Value" "At or near Line 16: Function iccap_func could not locate 'do_SENTIO_cmd'.At or near Line 21: Uninitialized argument for VAL$At or near Line 16: Wait failedAt or near Line 1: Attempting to convert argument to text,  operand is uninitializedAt or near Line 16: HPIB_readstr: need a scalar number for argument 2 but got something else"
element 14 "Name" "ErrorOccurred"
element 14 "Value" "1"
element 15 "Name" "ICCAP_ERROR_CALLBACK"
element 15 "Value" "check_error"
element 16 "Name" "____________________3"
element 16 "Value" ""
element 17 "Name" "model"
element 17 "Value" "Driver"
element 18 "Name" "c_duts"
element 18 "Value" "ICCAP_ARRAY[0]"
element 19 "Name" "c_setups"
element 19 "Value" "ICCAP_ARRAY[0]"
element 20 "Name" "varlist"
element 20 "Value" "ICCAP_ARRAY[0]"
element 21 "Name" "vallist"
element 21 "Value" "ICCAP_ARRAY[0]"
element 22 "Name" "TmpVar"
element 22 "Value" ""
element 23 "Name" "____________________4"
element 23 "Value" ""
element 24 "Name" "no_dies"
element 24 "Value" "1"
element 25 "Name" "no_wafers"
element 25 "Value" "1"
element 26 "Name" ""
element 26 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "Plot Options" "742.004"
{
TABLE "Trace Settings" "742.004"
{
element 0 "Name" "Data 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 0 "Symbol" "Square" "A"
element 0 "Measured" "Default" "A"
element 0 "Simulated" "Default" "A"
element 1 "Name" "Data 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 1 "Symbol" "Triangle" "A"
element 1 "Measured" "Default" "A"
element 1 "Simulated" "Default" "A"
element 2 "Name" "Data 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 2 "Symbol" "Diamond" "A"
element 2 "Measured" "Default" "A"
element 2 "Simulated" "Default" "A"
element 3 "Name" "Data 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 3 "Symbol" "Circle" "A"
element 3 "Measured" "Default" "A"
element 3 "Simulated" "Default" "A"
element 4 "Name" "Data 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 4 "Symbol" "Cross" "A"
element 4 "Measured" "Default" "A"
element 4 "Simulated" "Default" "A"
element 5 "Name" "Data 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 5 "Symbol" "X" "A"
element 5 "Measured" "Default" "A"
element 5 "Simulated" "Default" "A"
element 6 "Name" "Data 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 6 "Symbol" "Square" "A"
element 6 "Measured" "Default" "A"
element 6 "Simulated" "Default" "A"
element 7 "Name" "Data 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 7 "Symbol" "Square" "A"
element 7 "Measured" "Default" "A"
element 7 "Simulated" "Default" "A"
element 8 "Name" "Y2 Data"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 8 "Symbol" "Square" "A"
element 8 "Measured" "Default" "A"
element 8 "Simulated" "Default" "A"
element 9 "Name" "Data 8"
element 9 "On White" "114" "A"
element 9 "On Black" "114" "A"
element 9 "Symbol" "Square" "N"
element 9 "Measured" "Default" "A"
element 9 "Simulated" "Default" "A"
element 10 "Name" "Data 9"
element 10 "On White" "14" "A"
element 10 "On Black" "94" "A"
element 10 "Symbol" "Square" "N"
element 10 "Measured" "Default" "A"
element 10 "Simulated" "Default" "A"
element 11 "Name" "Data 10"
element 11 "On White" "23" "A"
element 11 "On Black" "81" "A"
element 11 "Symbol" "Square" "N"
element 11 "Measured" "Default" "A"
element 11 "Simulated" "Default" "A"
element 12 "Name" "Data 11"
element 12 "On White" "102" "A"
element 12 "On Black" "50" "A"
element 12 "Symbol" "Square" "N"
element 12 "Measured" "Default" "A"
element 12 "Simulated" "Default" "A"
element 13 "Name" "Data 12"
element 13 "On White" "27" "A"
element 13 "On Black" "115" "A"
element 13 "Symbol" "Square" "N"
element 13 "Measured" "Default" "A"
element 13 "Simulated" "Default" "A"
element 14 "Name" "Data 13"
element 14 "On White" "54" "A"
element 14 "On Black" "54" "A"
element 14 "Symbol" "Square" "N"
element 14 "Measured" "Default" "A"
element 14 "Simulated" "Default" "A"
element 15 "Name" "Data 14"
element 15 "On White" "106" "A"
element 15 "On Black" "106" "A"
element 15 "Symbol" "Square" "N"
element 15 "Measured" "Default" "A"
element 15 "Simulated" "Default" "A"
element 16 "Name" "Data 15"
element 16 "On White" "120" "A"
element 16 "On Black" "120" "A"
element 16 "Symbol" "Square" "N"
element 16 "Measured" "Default" "A"
element 16 "Simulated" "Default" "A"
element 17 "Name" "Data 16"
element 17 "On White" "87" "A"
element 17 "On Black" "87" "A"
element 17 "Symbol" "Square" "N"
element 17 "Measured" "Default" "A"
element 17 "Simulated" "Default" "A"
element 18 "Name" "Data 17"
element 18 "On White" "29" "A"
element 18 "On Black" "79" "A"
element 18 "Symbol" "Square" "N"
element 18 "Measured" "Default" "A"
element 18 "Simulated" "Default" "A"
element 19 "Name" "Data 18"
element 19 "On White" "81" "A"
element 19 "On Black" "81" "A"
element 19 "Symbol" "Square" "N"
element 19 "Measured" "Default" "A"
element 19 "Simulated" "Default" "A"
element 20 "Name" "Data 19"
element 20 "On White" "1" "A"
element 20 "On Black" "1" "A"
element 20 "Symbol" "Circle" "A"
element 20 "Measured" "Default" "A"
element 20 "Simulated" "Dot Line" "A"
element 21 "Name" "Data 20"
element 21 "On White" "5" "A"
element 21 "On Black" "2" "N"
element 21 "Symbol" "Reverse Triangle" "A"
element 21 "Measured" "Default" "A"
element 21 "Simulated" "Dot Line" "A"
element 22 "Name" "Data 21"
element 22 "On White" "6" "A"
element 22 "On Black" "6" "A"
element 22 "Symbol" "Star" "A"
element 22 "Measured" "Default" "A"
element 22 "Simulated" "Dot Line" "A"
element 23 "Name" "Data 22"
element 23 "On White" "3" "A"
element 23 "On Black" "3" "A"
element 23 "Symbol" "Triangle" "A"
element 23 "Measured" "Default" "A"
element 23 "Simulated" "Dot Line" "A"
element 24 "Name" "Data 23"
element 24 "On White" "88" "A"
element 24 "On Black" "88" "A"
element 24 "Symbol" "Square" "N"
element 24 "Measured" "Default" "A"
element 24 "Simulated" "Dot Line" "A"
element 25 "Name" "Data 24"
element 25 "On White" "4" "A"
element 25 "On Black" "4" "A"
element 25 "Symbol" "Cross" "A"
element 25 "Measured" "Default" "A"
element 25 "Simulated" "Dot Line" "A"
element 26 "Name" "Data 25"
element 26 "On White" "25" "A"
element 26 "On Black" "117" "A"
element 26 "Symbol" "Circle" "A"
element 26 "Measured" "Default" "A"
element 26 "Simulated" "Dot Line" "A"
element 27 "Name" "Data 26"
element 27 "On White" "40" "A"
element 27 "On Black" "40" "A"
element 27 "Symbol" "Circle" "A"
element 27 "Measured" "Default" "A"
element 27 "Simulated" "Dot Line" "A"
element 28 "Name" "Data 27"
element 28 "On White" "28" "A"
element 28 "On Black" "28" "A"
element 28 "Symbol" "Circle" "A"
element 28 "Measured" "Default" "A"
element 28 "Simulated" "Dot Line" "A"
element 29 "Name" "Data 28"
element 29 "On White" "114" "A"
element 29 "On Black" "114" "A"
element 29 "Symbol" "Circle" "A"
element 29 "Measured" "Default" "A"
element 29 "Simulated" "Dot Line" "A"
element 30 "Name" "Data 29"
element 30 "On White" "14" "A"
element 30 "On Black" "94" "A"
element 30 "Symbol" "Circle" "A"
element 30 "Measured" "Default" "A"
element 30 "Simulated" "Dot Line" "A"
element 31 "Name" "Data 30"
element 31 "On White" "23" "A"
element 31 "On Black" "81" "A"
element 31 "Symbol" "Circle" "A"
element 31 "Measured" "Default" "A"
element 31 "Simulated" "Dot Line" "A"
element 32 "Name" "Data 31"
element 32 "On White" "102" "A"
element 32 "On Black" "50" "A"
element 32 "Symbol" "Circle" "A"
element 32 "Measured" "Default" "A"
element 32 "Simulated" "Dot Line" "A"
element 33 "Name" "Data 32"
element 33 "On White" "27" "A"
element 33 "On Black" "115" "A"
element 33 "Symbol" "Circle" "A"
element 33 "Measured" "Default" "A"
element 33 "Simulated" "Dot Line" "A"
element 34 "Name" "Data 33"
element 34 "On White" "54" "A"
element 34 "On Black" "54" "A"
element 34 "Symbol" "Circle" "A"
element 34 "Measured" "Default" "A"
element 34 "Simulated" "Dot Line" "A"
element 35 "Name" "Data 34"
element 35 "On White" "106" "A"
element 35 "On Black" "106" "A"
element 35 "Symbol" "Circle" "A"
element 35 "Measured" "Default" "A"
element 35 "Simulated" "Dot Line" "A"
element 36 "Name" "Data 35"
element 36 "On White" "120" "A"
element 36 "On Black" "120" "A"
element 36 "Symbol" "Circle" "A"
element 36 "Measured" "Default" "A"
element 36 "Simulated" "Dot Line" "A"
element 37 "Name" "Data 36"
element 37 "On White" "87" "A"
element 37 "On Black" "87" "A"
element 37 "Symbol" "Circle" "A"
element 37 "Measured" "Default" "A"
element 37 "Simulated" "Dot Line" "A"
element 38 "Name" "Data 37"
element 38 "On White" "29" "A"
element 38 "On Black" "79" "A"
element 38 "Symbol" "Circle" "A"
element 38 "Measured" "Default" "A"
element 38 "Simulated" "Dot Line" "A"
element 39 "Name" "Data 38"
element 39 "On White" "81" "A"
element 39 "On Black" "81" "A"
element 39 "Symbol" "Circle" "A"
element 39 "Measured" "Default" "A"
element 39 "Simulated" "Dot Line" "A"
element 40 "Name" "Data 39"
element 40 "On White" "1" "A"
element 40 "On Black" "1" "A"
element 40 "Symbol" "Triangle" "A"
element 40 "Measured" "Default" "A"
element 40 "Simulated" "Dot Dot Line" "A"
element 41 "Name" "Data 40"
element 41 "On White" "5" "A"
element 41 "On Black" "2" "N"
element 41 "Symbol" "Diamond" "A"
element 41 "Measured" "Default" "A"
element 41 "Simulated" "Dot Dot Line" "A"
element 42 "Name" "Data 41"
element 42 "On White" "6" "A"
element 42 "On Black" "6" "A"
element 42 "Symbol" "X" "A"
element 42 "Measured" "Default" "A"
element 42 "Simulated" "Dot Dot Line" "A"
element 43 "Name" "Data 42"
element 43 "On White" "3" "A"
element 43 "On Black" "3" "A"
element 43 "Symbol" "Reverse Triangle" "A"
element 43 "Measured" "Default" "A"
element 43 "Simulated" "Dot Dot Line" "A"
element 44 "Name" "Data 43"
element 44 "On White" "88" "A"
element 44 "On Black" "88" "A"
element 44 "Symbol" "Circle" "A"
element 44 "Measured" "Default" "A"
element 44 "Simulated" "Dot Dot Line" "A"
element 45 "Name" "Data 44"
element 45 "On White" "4" "A"
element 45 "On Black" "4" "A"
element 45 "Symbol" "Square" "N"
element 45 "Measured" "Default" "A"
element 45 "Simulated" "Dot Dot Line" "A"
element 46 "Name" "Data 45"
element 46 "On White" "25" "A"
element 46 "On Black" "117" "A"
element 46 "Symbol" "Triangle" "A"
element 46 "Measured" "Default" "A"
element 46 "Simulated" "Dot Dot Line" "A"
element 47 "Name" "Data 46"
element 47 "On White" "40" "A"
element 47 "On Black" "40" "A"
element 47 "Symbol" "Triangle" "A"
element 47 "Measured" "Default" "A"
element 47 "Simulated" "Dot Dot Line" "A"
element 48 "Name" "Data 47"
element 48 "On White" "28" "A"
element 48 "On Black" "28" "A"
element 48 "Symbol" "Triangle" "A"
element 48 "Measured" "Default" "A"
element 48 "Simulated" "Dot Dot Line" "A"
element 49 "Name" "Data 48"
element 49 "On White" "114" "A"
element 49 "On Black" "114" "A"
element 49 "Symbol" "Triangle" "A"
element 49 "Measured" "Default" "A"
element 49 "Simulated" "Dot Dot Line" "A"
element 50 "Name" "Data 49"
element 50 "On White" "14" "A"
element 50 "On Black" "94" "A"
element 50 "Symbol" "Triangle" "A"
element 50 "Measured" "Default" "A"
element 50 "Simulated" "Dot Dot Line" "A"
element 51 "Name" "Data 50"
element 51 "On White" "23" "A"
element 51 "On Black" "81" "A"
element 51 "Symbol" "Triangle" "A"
element 51 "Measured" "Default" "A"
element 51 "Simulated" "Dot Dot Line" "A"
element 52 "Name" "Data 51"
element 52 "On White" "102" "A"
element 52 "On Black" "50" "A"
element 52 "Symbol" "Triangle" "A"
element 52 "Measured" "Default" "A"
element 52 "Simulated" "Dot Dot Line" "A"
element 53 "Name" "Data 52"
element 53 "On White" "27" "A"
element 53 "On Black" "115" "A"
element 53 "Symbol" "Triangle" "A"
element 53 "Measured" "Default" "A"
element 53 "Simulated" "Dot Dot Line" "A"
element 54 "Name" "Data 53"
element 54 "On White" "54" "A"
element 54 "On Black" "54" "A"
element 54 "Symbol" "Triangle" "A"
element 54 "Measured" "Default" "A"
element 54 "Simulated" "Dot Dot Line" "A"
element 55 "Name" "Data 54"
element 55 "On White" "106" "A"
element 55 "On Black" "106" "A"
element 55 "Symbol" "Triangle" "A"
element 55 "Measured" "Default" "A"
element 55 "Simulated" "Dot Dot Line" "A"
element 56 "Name" "Data 55"
element 56 "On White" "120" "A"
element 56 "On Black" "120" "A"
element 56 "Symbol" "Triangle" "A"
element 56 "Measured" "Default" "A"
element 56 "Simulated" "Dot Dot Line" "A"
element 57 "Name" "Data 56"
element 57 "On White" "87" "A"
element 57 "On Black" "87" "A"
element 57 "Symbol" "Triangle" "A"
element 57 "Measured" "Default" "A"
element 57 "Simulated" "Dot Dot Line" "A"
element 58 "Name" "Data 57"
element 58 "On White" "29" "A"
element 58 "On Black" "79" "A"
element 58 "Symbol" "Triangle" "A"
element 58 "Measured" "Default" "A"
element 58 "Simulated" "Dot Dot Line" "A"
element 59 "Name" "Data 58"
element 59 "On White" "81" "A"
element 59 "On Black" "81" "A"
element 59 "Symbol" "Triangle" "A"
element 59 "Measured" "Default" "A"
element 59 "Simulated" "Dot Dot Line" "A"
element 60 "Name" "Data 59"
element 60 "On White" "1" "A"
element 60 "On Black" "1" "A"
element 60 "Symbol" "Reverse Triangle" "A"
element 60 "Measured" "Default" "A"
element 60 "Simulated" "Dashed Line" "A"
element 61 "Name" "Data 60"
element 61 "On White" "5" "A"
element 61 "On Black" "2" "N"
element 61 "Symbol" "Star" "A"
element 61 "Measured" "Default" "A"
element 61 "Simulated" "Dashed Line" "A"
element 62 "Name" "Data 61"
element 62 "On White" "6" "A"
element 62 "On Black" "6" "A"
element 62 "Symbol" "Cross" "A"
element 62 "Measured" "Default" "A"
element 62 "Simulated" "Dashed Line" "A"
element 63 "Name" "Data 62"
element 63 "On White" "3" "A"
element 63 "On Black" "3" "A"
element 63 "Symbol" "Diamond" "A"
element 63 "Measured" "Default" "A"
element 63 "Simulated" "Dashed Line" "A"
element 64 "Name" "Data 63"
element 64 "On White" "88" "A"
element 64 "On Black" "88" "A"
element 64 "Symbol" "Triangle" "A"
element 64 "Measured" "Default" "A"
element 64 "Simulated" "Dashed Line" "A"
element 65 "Name" "Data 64"
element 65 "On White" "4" "A"
element 65 "On Black" "4" "A"
element 65 "Symbol" "Circle" "A"
element 65 "Measured" "Default" "A"
element 65 "Simulated" "Dashed Line" "A"
element 66 "Name" "Data 65"
element 66 "On White" "25" "A"
element 66 "On Black" "117" "A"
element 66 "Symbol" "Reverse Triangle" "A"
element 66 "Measured" "Default" "A"
element 66 "Simulated" "Dashed Line" "A"
element 67 "Name" "Data 66"
element 67 "On White" "40" "A"
element 67 "On Black" "40" "A"
element 67 "Symbol" "Reverse Triangle" "A"
element 67 "Measured" "Default" "A"
element 67 "Simulated" "Dashed Line" "A"
element 68 "Name" "Data 67"
element 68 "On White" "28" "A"
element 68 "On Black" "28" "A"
element 68 "Symbol" "Reverse Triangle" "A"
element 68 "Measured" "Default" "A"
element 68 "Simulated" "Dashed Line" "A"
element 69 "Name" "Data 68"
element 69 "On White" "114" "A"
element 69 "On Black" "114" "A"
element 69 "Symbol" "Reverse Triangle" "A"
element 69 "Measured" "Default" "A"
element 69 "Simulated" "Dashed Line" "A"
element 70 "Name" "Data 69"
element 70 "On White" "14" "A"
element 70 "On Black" "94" "A"
element 70 "Symbol" "Reverse Triangle" "A"
element 70 "Measured" "Default" "A"
element 70 "Simulated" "Dashed Line" "A"
element 71 "Name" "Data 70"
element 71 "On White" "23" "A"
element 71 "On Black" "81" "A"
element 71 "Symbol" "Reverse Triangle" "A"
element 71 "Measured" "Default" "A"
element 71 "Simulated" "Dashed Line" "A"
element 72 "Name" "Data 71"
element 72 "On White" "102" "A"
element 72 "On Black" "50" "A"
element 72 "Symbol" "Reverse Triangle" "A"
element 72 "Measured" "Default" "A"
element 72 "Simulated" "Dashed Line" "A"
element 73 "Name" "Data 72"
element 73 "On White" "27" "A"
element 73 "On Black" "115" "A"
element 73 "Symbol" "Reverse Triangle" "A"
element 73 "Measured" "Default" "A"
element 73 "Simulated" "Dashed Line" "A"
element 74 "Name" "Data 73"
element 74 "On White" "54" "A"
element 74 "On Black" "54" "A"
element 74 "Symbol" "Reverse Triangle" "A"
element 74 "Measured" "Default" "A"
element 74 "Simulated" "Dashed Line" "A"
element 75 "Name" "Data 74"
element 75 "On White" "106" "A"
element 75 "On Black" "106" "A"
element 75 "Symbol" "Reverse Triangle" "A"
element 75 "Measured" "Default" "A"
element 75 "Simulated" "Dashed Line" "A"
element 76 "Name" "Data 75"
element 76 "On White" "120" "A"
element 76 "On Black" "120" "A"
element 76 "Symbol" "Reverse Triangle" "A"
element 76 "Measured" "Default" "A"
element 76 "Simulated" "Dashed Line" "A"
element 77 "Name" "Data 76"
element 77 "On White" "87" "A"
element 77 "On Black" "87" "A"
element 77 "Symbol" "Reverse Triangle" "A"
element 77 "Measured" "Default" "A"
element 77 "Simulated" "Dashed Line" "A"
element 78 "Name" "Data 77"
element 78 "On White" "29" "A"
element 78 "On Black" "79" "A"
element 78 "Symbol" "Reverse Triangle" "A"
element 78 "Measured" "Default" "A"
element 78 "Simulated" "Dashed Line" "A"
element 79 "Name" "Data 78"
element 79 "On White" "81" "A"
element 79 "On Black" "81" "A"
element 79 "Symbol" "Reverse Triangle" "A"
element 79 "Measured" "Default" "A"
element 79 "Simulated" "Dashed Line" "A"
element 80 "Name" "Data 79"
element 80 "On White" "1" "A"
element 80 "On Black" "1" "A"
element 80 "Symbol" "Diamond" "A"
element 80 "Measured" "Default" "A"
element 80 "Simulated" "Dot Dashed Line" "A"
element 81 "Name" "Data 80"
element 81 "On White" "5" "A"
element 81 "On Black" "2" "N"
element 81 "Symbol" "X" "A"
element 81 "Measured" "Default" "A"
element 81 "Simulated" "Dot Dashed Line" "A"
element 82 "Name" "Data 81"
element 82 "On White" "6" "A"
element 82 "On Black" "6" "A"
element 82 "Symbol" "Square" "N"
element 82 "Measured" "Default" "A"
element 82 "Simulated" "Dot Dashed Line" "A"
element 83 "Name" "Data 82"
element 83 "On White" "3" "A"
element 83 "On Black" "3" "A"
element 83 "Symbol" "Star" "A"
element 83 "Measured" "Default" "A"
element 83 "Simulated" "Dot Dashed Line" "A"
element 84 "Name" "Data 83"
element 84 "On White" "88" "A"
element 84 "On Black" "88" "A"
element 84 "Symbol" "Reverse Triangle" "A"
element 84 "Measured" "Default" "A"
element 84 "Simulated" "Dot Dashed Line" "A"
element 85 "Name" "Data 84"
element 85 "On White" "4" "A"
element 85 "On Black" "4" "A"
element 85 "Symbol" "Triangle" "A"
element 85 "Measured" "Default" "A"
element 85 "Simulated" "Dot Dashed Line" "A"
element 86 "Name" "Data 85"
element 86 "On White" "25" "A"
element 86 "On Black" "117" "A"
element 86 "Symbol" "Diamond" "A"
element 86 "Measured" "Default" "A"
element 86 "Simulated" "Dot Dashed Line" "A"
element 87 "Name" "Data 86"
element 87 "On White" "40" "A"
element 87 "On Black" "40" "A"
element 87 "Symbol" "Diamond" "A"
element 87 "Measured" "Default" "A"
element 87 "Simulated" "Dot Dashed Line" "A"
element 88 "Name" "Data 87"
element 88 "On White" "28" "A"
element 88 "On Black" "28" "A"
element 88 "Symbol" "Diamond" "A"
element 88 "Measured" "Default" "A"
element 88 "Simulated" "Dot Dashed Line" "A"
element 89 "Name" "Data 88"
element 89 "On White" "114" "A"
element 89 "On Black" "114" "A"
element 89 "Symbol" "Diamond" "A"
element 89 "Measured" "Default" "A"
element 89 "Simulated" "Dot Dashed Line" "A"
element 90 "Name" "Data 89"
element 90 "On White" "14" "A"
element 90 "On Black" "94" "A"
element 90 "Symbol" "Diamond" "A"
element 90 "Measured" "Default" "A"
element 90 "Simulated" "Dot Dashed Line" "A"
element 91 "Name" "Data 90"
element 91 "On White" "23" "A"
element 91 "On Black" "81" "A"
element 91 "Symbol" "Diamond" "A"
element 91 "Measured" "Default" "A"
element 91 "Simulated" "Dot Dashed Line" "A"
element 92 "Name" "Data 91"
element 92 "On White" "102" "A"
element 92 "On Black" "50" "A"
element 92 "Symbol" "Diamond" "A"
element 92 "Measured" "Default" "A"
element 92 "Simulated" "Dot Dashed Line" "A"
element 93 "Name" "Data 92"
element 93 "On White" "27" "A"
element 93 "On Black" "115" "A"
element 93 "Symbol" "Diamond" "A"
element 93 "Measured" "Default" "A"
element 93 "Simulated" "Dot Dashed Line" "A"
element 94 "Name" "Data 93"
element 94 "On White" "54" "A"
element 94 "On Black" "54" "A"
element 94 "Symbol" "Diamond" "A"
element 94 "Measured" "Default" "A"
element 94 "Simulated" "Dot Dashed Line" "A"
element 95 "Name" "Data 94"
element 95 "On White" "106" "A"
element 95 "On Black" "106" "A"
element 95 "Symbol" "Diamond" "A"
element 95 "Measured" "Default" "A"
element 95 "Simulated" "Dot Dashed Line" "A"
element 96 "Name" "Data 95"
element 96 "On White" "120" "A"
element 96 "On Black" "120" "A"
element 96 "Symbol" "Diamond" "A"
element 96 "Measured" "Default" "A"
element 96 "Simulated" "Dot Dashed Line" "A"
element 97 "Name" "Data 96"
element 97 "On White" "87" "A"
element 97 "On Black" "87" "A"
element 97 "Symbol" "Diamond" "A"
element 97 "Measured" "Default" "A"
element 97 "Simulated" "Dot Dashed Line" "A"
element 98 "Name" "Data 97"
element 98 "On White" "29" "A"
element 98 "On Black" "79" "A"
element 98 "Symbol" "Diamond" "A"
element 98 "Measured" "Default" "A"
element 98 "Simulated" "Dot Dashed Line" "A"
element 99 "Name" "Data 98"
element 99 "On White" "81" "A"
element 99 "On Black" "81" "A"
element 99 "Symbol" "Diamond" "A"
element 99 "Measured" "Default" "A"
element 99 "Simulated" "Dot Dashed Line" "A"
element 100 "Name" "Data 99"
element 100 "On White" "1" "A"
element 100 "On Black" "1" "A"
element 100 "Symbol" "Star" "A"
element 100 "Measured" "Default" "A"
element 100 "Simulated" "Long Dashed Line" "A"
element 101 "Name" "Data 100"
element 101 "On White" "5" "A"
element 101 "On Black" "2" "N"
element 101 "Symbol" "Cross" "A"
element 101 "Measured" "Default" "A"
element 101 "Simulated" "Long Dashed Line" "A"
element 102 "Name" "Data 101"
element 102 "On White" "6" "A"
element 102 "On Black" "6" "A"
element 102 "Symbol" "Circle" "A"
element 102 "Measured" "Default" "A"
element 102 "Simulated" "Long Dashed Line" "A"
element 103 "Name" "Data 102"
element 103 "On White" "3" "A"
element 103 "On Black" "3" "A"
element 103 "Symbol" "X" "A"
element 103 "Measured" "Default" "A"
element 103 "Simulated" "Long Dashed Line" "A"
element 104 "Name" "Data 103"
element 104 "On White" "88" "A"
element 104 "On Black" "88" "A"
element 104 "Symbol" "Diamond" "A"
element 104 "Measured" "Default" "A"
element 104 "Simulated" "Long Dashed Line" "A"
element 105 "Name" "Data 104"
element 105 "On White" "4" "A"
element 105 "On Black" "4" "A"
element 105 "Symbol" "Reverse Triangle" "A"
element 105 "Measured" "Default" "A"
element 105 "Simulated" "Long Dashed Line" "A"
element 106 "Name" "Data 105"
element 106 "On White" "25" "A"
element 106 "On Black" "117" "A"
element 106 "Symbol" "Star" "A"
element 106 "Measured" "Default" "A"
element 106 "Simulated" "Long Dashed Line" "A"
element 107 "Name" "Data 106"
element 107 "On White" "40" "A"
element 107 "On Black" "40" "A"
element 107 "Symbol" "Star" "A"
element 107 "Measured" "Default" "A"
element 107 "Simulated" "Long Dashed Line" "A"
element 108 "Name" "Data 107"
element 108 "On White" "28" "A"
element 108 "On Black" "28" "A"
element 108 "Symbol" "Star" "A"
element 108 "Measured" "Default" "A"
element 108 "Simulated" "Long Dashed Line" "A"
element 109 "Name" "Data 108"
element 109 "On White" "114" "A"
element 109 "On Black" "114" "A"
element 109 "Symbol" "Star" "A"
element 109 "Measured" "Default" "A"
element 109 "Simulated" "Long Dashed Line" "A"
element 110 "Name" "Data 109"
element 110 "On White" "14" "A"
element 110 "On Black" "94" "A"
element 110 "Symbol" "Star" "A"
element 110 "Measured" "Default" "A"
element 110 "Simulated" "Long Dashed Line" "A"
element 111 "Name" "Data 110"
element 111 "On White" "23" "A"
element 111 "On Black" "81" "A"
element 111 "Symbol" "Star" "A"
element 111 "Measured" "Default" "A"
element 111 "Simulated" "Long Dashed Line" "A"
element 112 "Name" "Data 111"
element 112 "On White" "102" "A"
element 112 "On Black" "50" "A"
element 112 "Symbol" "Star" "A"
element 112 "Measured" "Default" "A"
element 112 "Simulated" "Long Dashed Line" "A"
element 113 "Name" "Data 112"
element 113 "On White" "27" "A"
element 113 "On Black" "115" "A"
element 113 "Symbol" "Star" "A"
element 113 "Measured" "Default" "A"
element 113 "Simulated" "Long Dashed Line" "A"
element 114 "Name" "Data 113"
element 114 "On White" "54" "A"
element 114 "On Black" "54" "A"
element 114 "Symbol" "Star" "A"
element 114 "Measured" "Default" "A"
element 114 "Simulated" "Long Dashed Line" "A"
element 115 "Name" "Data 114"
element 115 "On White" "106" "A"
element 115 "On Black" "106" "A"
element 115 "Symbol" "Star" "A"
element 115 "Measured" "Default" "A"
element 115 "Simulated" "Long Dashed Line" "A"
element 116 "Name" "Data 115"
element 116 "On White" "120" "A"
element 116 "On Black" "120" "A"
element 116 "Symbol" "Star" "A"
element 116 "Measured" "Default" "A"
element 116 "Simulated" "Long Dashed Line" "A"
element 117 "Name" "Data 116"
element 117 "On White" "87" "A"
element 117 "On Black" "87" "A"
element 117 "Symbol" "Star" "A"
element 117 "Measured" "Default" "A"
element 117 "Simulated" "Long Dashed Line" "A"
element 118 "Name" "Data 117"
element 118 "On White" "29" "A"
element 118 "On Black" "79" "A"
element 118 "Symbol" "Star" "A"
element 118 "Measured" "Default" "A"
element 118 "Simulated" "Long Dashed Line" "A"
element 119 "Name" "Data 118"
element 119 "On White" "81" "A"
element 119 "On Black" "81" "A"
element 119 "Symbol" "Star" "A"
element 119 "Measured" "Default" "A"
element 119 "Simulated" "Long Dashed Line" "A"
element 120 "Name" "Data 119"
element 120 "On White" "1" "A"
element 120 "On Black" "1" "A"
element 120 "Symbol" "X" "A"
element 120 "Measured" "Default" "A"
element 120 "Simulated" "Long Dot Dashed Line" "A"
element 121 "Name" "Data 120"
element 121 "On White" "5" "A"
element 121 "On Black" "2" "N"
element 121 "Symbol" "Square" "N"
element 121 "Measured" "Default" "A"
element 121 "Simulated" "Long Dot Dashed Line" "A"
element 122 "Name" "Data 121"
element 122 "On White" "6" "A"
element 122 "On Black" "6" "A"
element 122 "Symbol" "Triangle" "A"
element 122 "Measured" "Default" "A"
element 122 "Simulated" "Long Dot Dashed Line" "A"
element 123 "Name" "Data 122"
element 123 "On White" "3" "A"
element 123 "On Black" "3" "A"
element 123 "Symbol" "Cross" "A"
element 123 "Measured" "Default" "A"
element 123 "Simulated" "Long Dot Dashed Line" "A"
element 124 "Name" "Data 123"
element 124 "On White" "88" "A"
element 124 "On Black" "88" "A"
element 124 "Symbol" "Star" "A"
element 124 "Measured" "Default" "A"
element 124 "Simulated" "Long Dot Dashed Line" "A"
element 125 "Name" "Data 124"
element 125 "On White" "4" "A"
element 125 "On Black" "4" "A"
element 125 "Symbol" "Diamond" "A"
element 125 "Measured" "Default" "A"
element 125 "Simulated" "Long Dot Dashed Line" "A"
element 126 "Name" "Data 125"
element 126 "On White" "25" "A"
element 126 "On Black" "117" "A"
element 126 "Symbol" "X" "A"
element 126 "Measured" "Default" "A"
element 126 "Simulated" "Long Dot Dashed Line" "A"
element 127 "Name" "Data 126"
element 127 "On White" "40" "A"
element 127 "On Black" "40" "A"
element 127 "Symbol" "X" "A"
element 127 "Measured" "Default" "A"
element 127 "Simulated" "Long Dot Dashed Line" "A"
element 128 "Name" "Data 127"
element 128 "On White" "28" "A"
element 128 "On Black" "28" "A"
element 128 "Symbol" "X" "A"
element 128 "Measured" "Default" "A"
element 128 "Simulated" "Long Dot Dashed Line" "A"
element 129 "Name" "Data 128"
element 129 "On White" "114" "A"
element 129 "On Black" "114" "A"
element 129 "Symbol" "X" "A"
element 129 "Measured" "Default" "A"
element 129 "Simulated" "Long Dot Dashed Line" "A"
element 130 "Name" "Data 129"
element 130 "On White" "14" "A"
element 130 "On Black" "94" "A"
element 130 "Symbol" "X" "A"
element 130 "Measured" "Default" "A"
element 130 "Simulated" "Long Dot Dashed Line" "A"
element 131 "Name" "Data 130"
element 131 "On White" "23" "A"
element 131 "On Black" "81" "A"
element 131 "Symbol" "X" "A"
element 131 "Measured" "Default" "A"
element 131 "Simulated" "Long Dot Dashed Line" "A"
element 132 "Name" "Data 131"
element 132 "On White" "102" "A"
element 132 "On Black" "50" "A"
element 132 "Symbol" "X" "A"
element 132 "Measured" "Default" "A"
element 132 "Simulated" "Long Dot Dashed Line" "A"
element 133 "Name" "Data 132"
element 133 "On White" "27" "A"
element 133 "On Black" "115" "A"
element 133 "Symbol" "X" "A"
element 133 "Measured" "Default" "A"
element 133 "Simulated" "Long Dot Dashed Line" "A"
element 134 "Name" "Data 133"
element 134 "On White" "54" "A"
element 134 "On Black" "54" "A"
element 134 "Symbol" "X" "A"
element 134 "Measured" "Default" "A"
element 134 "Simulated" "Long Dot Dashed Line" "A"
element 135 "Name" "Data 134"
element 135 "On White" "106" "A"
element 135 "On Black" "106" "A"
element 135 "Symbol" "X" "A"
element 135 "Measured" "Default" "A"
element 135 "Simulated" "Long Dot Dashed Line" "A"
element 136 "Name" "Data 135"
element 136 "On White" "120" "A"
element 136 "On Black" "120" "A"
element 136 "Symbol" "X" "A"
element 136 "Measured" "Default" "A"
element 136 "Simulated" "Long Dot Dashed Line" "A"
element 137 "Name" "Data 136"
element 137 "On White" "87" "A"
element 137 "On Black" "87" "A"
element 137 "Symbol" "X" "A"
element 137 "Measured" "Default" "A"
element 137 "Simulated" "Long Dot Dashed Line" "A"
element 138 "Name" "Data 137"
element 138 "On White" "29" "A"
element 138 "On Black" "79" "A"
element 138 "Symbol" "X" "A"
element 138 "Measured" "Default" "A"
element 138 "Simulated" "Long Dot Dashed Line" "A"
element 139 "Name" "Data 138"
element 139 "On White" "81" "A"
element 139 "On Black" "81" "A"
element 139 "Symbol" "X" "A"
element 139 "Measured" "Default" "A"
element 139 "Simulated" "Long Dot Dashed Line" "A"
element 140 "Name" "Data 139"
element 140 "On White" "1" "A"
element 140 "On Black" "1" "A"
element 140 "Symbol" "Cross" "A"
element 140 "Measured" "Default" "A"
element 140 "Simulated" "Solid Line" "A"
element 141 "Name" "Data 140"
element 141 "On White" "5" "A"
element 141 "On Black" "2" "N"
element 141 "Symbol" "Circle" "A"
element 141 "Measured" "Default" "A"
element 141 "Simulated" "Solid Line" "A"
element 142 "Name" "Data 141"
element 142 "On White" "6" "A"
element 142 "On Black" "6" "A"
element 142 "Symbol" "Reverse Triangle" "A"
element 142 "Measured" "Default" "A"
element 142 "Simulated" "Solid Line" "A"
element 143 "Name" "Data 142"
element 143 "On White" "3" "A"
element 143 "On Black" "3" "A"
element 143 "Symbol" "Square" "N"
element 143 "Measured" "Default" "A"
element 143 "Simulated" "Solid Line" "A"
element 144 "Name" "Data 143"
element 144 "On White" "88" "A"
element 144 "On Black" "88" "A"
element 144 "Symbol" "X" "A"
element 144 "Measured" "Default" "A"
element 144 "Simulated" "Solid Line" "A"
element 145 "Name" "Data 144"
element 145 "On White" "4" "A"
element 145 "On Black" "4" "A"
element 145 "Symbol" "Star" "A"
element 145 "Measured" "Default" "A"
element 145 "Simulated" "Solid Line" "A"
element 146 "Name" "Data 145"
element 146 "On White" "25" "A"
element 146 "On Black" "117" "A"
element 146 "Symbol" "Cross" "A"
element 146 "Measured" "Default" "A"
element 146 "Simulated" "Solid Line" "A"
element 147 "Name" "Data 146"
element 147 "On White" "40" "A"
element 147 "On Black" "40" "A"
element 147 "Symbol" "Cross" "A"
element 147 "Measured" "Default" "A"
element 147 "Simulated" "Solid Line" "A"
element 148 "Name" "Data 147"
element 148 "On White" "28" "A"
element 148 "On Black" "28" "A"
element 148 "Symbol" "Cross" "A"
element 148 "Measured" "Default" "A"
element 148 "Simulated" "Solid Line" "A"
element 149 "Name" "Data 148"
element 149 "On White" "114" "A"
element 149 "On Black" "114" "A"
element 149 "Symbol" "Cross" "A"
element 149 "Measured" "Default" "A"
element 149 "Simulated" "Solid Line" "A"
element 150 "Name" "Data 149"
element 150 "On White" "14" "A"
element 150 "On Black" "94" "A"
element 150 "Symbol" "Cross" "A"
element 150 "Measured" "Default" "A"
element 150 "Simulated" "Solid Line" "A"
}
TABLE "Curve Settings" "742.004"
{
element 0 "Curve" "Curve 0"
element 0 "On White" "1" "A"
element 0 "On Black" "1" "A"
element 1 "Curve" "Curve 1"
element 1 "On White" "5" "A"
element 1 "On Black" "2" "A"
element 2 "Curve" "Curve 2"
element 2 "On White" "6" "A"
element 2 "On Black" "6" "A"
element 3 "Curve" "Curve 3"
element 3 "On White" "3" "A"
element 3 "On Black" "3" "A"
element 4 "Curve" "Curve 4"
element 4 "On White" "88" "A"
element 4 "On Black" "88" "A"
element 5 "Curve" "Curve 5"
element 5 "On White" "4" "A"
element 5 "On Black" "4" "A"
element 6 "Curve" "Curve 6"
element 6 "On White" "25" "A"
element 6 "On Black" "117" "A"
element 7 "Curve" "Curve 7"
element 7 "On White" "40" "A"
element 7 "On Black" "40" "A"
element 8 "Curve" "Curve 8"
element 8 "On White" "28" "A"
element 8 "On Black" "28" "A"
element 9 "Curve" "Curve 9"
element 9 "On White" "114" "A"
element 9 "On Black" "114" "A"
}
TABLE "Plot Settings" "742.004"
{
element 0 "Multicolor" "Display all curves with the configured trace color" "A"
element 0 "Measured Trace" "Solid Line with Symbols" "N"
element 0 "Simulated Trace" "Solid Line" "A"
element 0 "Transform Result" "Solid Line with Symbols" "N"
element 0 "Error Trace" "Solid Line" "A"
element 0 "Show Title" "Yes" "A"
element 0 "Show Multiplot Header" "Yes" "A"
element 0 "Show Multiplot Footer" "Yes" "A"
element 0 "Show Header" "Yes" "A"
element 0 "Show Footer" "Yes" "A"
element 0 "Show Legend" "No" "A"
element 0 "White Background" "No" "N"
element 0 "Show Area Tools" "Yes" "A"
element 0 "Enable Annotation" "No" "N"
element 0 "Annotation Location" "Upper Left" "A"
element 0 "PEL Control" "No" "A"
element 0 "Annotation Text" ""
element 0 "PEL Transform" ""
element 0 "PEL Call Type" "1"
element 0 "Font Type" "Arial For CAE" "A"
element 0 "Font Size" "12.00" "A"
element 0 "Annotation Font Name" "Arial For CAE" "A"
element 0 "Annotation Font Sz" "9.000" "A"
element 0 "Symbol Size" "4.000" "A"
element 0 "Plot Selection Callback" "" "A"
}
}
LINK CIRC "Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK PS "Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P23 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK MACRO "README" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 Debug <0><1><2>: 
    <0>: no comments during Macro executions,
    <1>: printing Transform names only to Status window
    <2>: printing all info also from inside the Transforms, 
         interrupting Macro execution (for debugging) with LINPUTs
}
}
}
LINK MACRO "____________________1" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{

}
}
}
LINK MACRO "SetVersion" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 Date = "" 
 Version = ""
 
 dummy = WPro_lookup_info("Context", "Date", "Date")
 dummy = WPro_lookup_info("Context", "Version", "Version")
 
 DriverVersion = VAL$(Version)&" - "&VAL$(Date)
}
}
}
LINK MACRO "cleanup" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 !-- Clean Up Variables
 
 Date = ""
 Version = ""
 
 model=WHOIS(".","PartName")
 PRINT VAL$(model)
 c_duts = "ICCAP_ARRAY[0]"
 ICCAP_FIND_CHILDREN "/"&VAL$(model),"DUT",c_duts
 
 I=0
 WHILE I < SIZEOF(c_duts)
   PRINT "  +--"&VAL$(c_duts[I])
   c_setups = "ICCAP_ARRAY[0]"
   ICCAP_FIND_CHILDREN "/"&VAL$(model)&"/"&VAL$(c_duts[I]),"Setup",c_setups
 
   !======================================
   NN=2
   varlist = "ICCAP_ARRAY["&VAL$(NN)&"]"
   varlist[0] = "bRet"
   varlist[1] = "ErrorMsg"
 
   vallist = "ICCAP_ARRAY["&VAL$(NN)&"]"
   vallist[0] = "1"
   vallist[1] = ""
   !======================================
 
   K=0
   WHILE K < SIZEOF(c_setups)
     PRINT "    +--"&VAL$(c_setups[K])
     path$ = "/"&VAL$(model)&"/"&VAL$(c_duts[I])&"/"&VAL$(c_setups[K])
     !------------------------------------
     N=0
     WHILE N < SIZEOF(varlist)
       varname$ = path$&"/"&VAL$(varlist[N])
       x=LOOKUP_VAR(varname$,errstr)
       !--IF errstr<>"" THEN PRINT errstr
       IF errstr=="" THEN
         ICCAP_FUNC(path$,"SetVariableTableValue",VAL$(varlist[N]),VAL$(vallist[N])) 
         PRINT "    |   >"&varname$&" = "&"'"&VAL$(vallist[N])&"'"
       END IF
       N=N+1
     END WHILE
     !------------------------------------
     K=K+1
   END WHILE
   I=I+1
 END WHILE
 
 c_duts = "ICCAP_ARRAY[0]"
 c_setups = "ICCAP_ARRAY[0]"
 varlist = "ICCAP_ARRAY[0]"
 vallist = "ICCAP_ARRAY[0]"
 
 dummy = WPro_lookup_info("Context", "Date", "Date")
 dummy = WPro_lookup_info("Context", "Version", "Version")
 
 DriverVersion = VAL$(Version)&" - "&VAL$(Date)
}
}
}
LINK MACRO "test_home" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 print fix_path$(system$("echo $HOME"))
}
}
}
LINK MACRO "check_error" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 GET_STRING "text",text
 ErrorMsg = VAL$(ErrorMsg) & text & chr$(10)
 ErrorOccurred = 1
}
}
}
LINK MACRO "clear_error" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{
 !--- Initialize Variables
 bRet = 1
 ErrorMsg = ""
 ErrorOccurred = 0
}
}
}
LINK MACRO "____________________2" "742.004"
{
TABLE "Edit Macro Info" "742.004"
{
element 0 "MacroType" "PEL"
}
data
{
BLKEDIT "Macro Editor"
{

}
}
}
LINK DUT "Utilities" "742.004"
{
View tree_dut 1 "0"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P15 C15 C15 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "742.004"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "gpib" "742.004"
{
View in_out 0 "0.811427528295 3556 2062"
View plot 0 "1.8 8007 5844"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P140 P207 C10"
element 0 "Name" "hpib_interface"
element 0 "Value" "hpib25"
element 1 "Name" "hpib_addr"
element 1 "Value" "5"
element 2 "Name" "hpib_suffix"
element 2 "Value" "\r"
element 3 "Name" "hpib_command"
element 3 "Value" "f1\r\n"
element 4 "Name" "nb_char"
element 4 "Value" "7"
element 5 "Name" "--"
element 5 "Value" ""
element 6 "Name" "success_id[0]"
element 6 "Value" "74"
element 7 "Name" "success_id[1]"
element 7 "Value" "70"
element 8 "Name" "success_id"
element 8 "Value" "ICCAP_ARRAY[2]"
element 9 "Name" "ErrorMsg"
element 9 "Value" ""
element 10 "Name" "failure_msg[0]"
element 10 "Value" "Prober Alignment Failed"
element 11 "Name" "failure_msg[1]"
element 11 "Value" "Wafer Load Failed"
element 12 "Name" "failure_msg[2]"
element 12 "Value" "prober error"
element 13 "Name" "failure_msg[3]"
element 13 "Value" "command error"
element 14 "Name" "failure_msg[4]"
element 14 "Value" "parameter error"
element 15 "Name" "failure_msg"
element 15 "Value" "ICCAP_ARRAY[5]"
element 16 "Name" "failure_id[0]"
element 16 "Value" "76"
element 17 "Name" "failure_id[1]"
element 17 "Value" "101"
element 18 "Name" "failure_id[2]"
element 18 "Value" "80"
element 19 "Name" "failure_id[3]"
element 19 "Value" "254"
element 20 "Name" "failure_id[4]"
element 20 "Value" "255"
element 21 "Name" "failure_id"
element 21 "Value" "ICCAP_ARRAY[5]"
element 22 "Name" "gpib_answer"
element 22 "Value" "053.0"
element 23 "Name" "UserStop"
element 23 "Value" "FALSE"
element 24 "Name" ""
element 24 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! GPIB functions / utilities
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "send_gpib_cmd" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 ! This Program sends a command to an instrument,
 ! waits for the response of the fulfilled command
 ! and returns the success of the command.
 
 !---start of the program
 LINPUT "hpib_interface",  hpib_interface
 LINPUT "hpib_address",    hpib_addr
 LINPUT "hpib_suffix",     hpib_suffix
 
 LINPUT "enter gpib command", hpib_command
 LINPUT "check max.timeout for receiving response [sec]", loop_timeout
 LINPUT "enter expected success ids", success_id_list
 LINPUT "enter expected failure ids", failure_id_list
 LINPUT "enter expected failure msg", failure_msg_list
 
 hpib_addr = VAL(hpib_addr)
 loop_timeout = VAL(loop_timeout)
 
 PRINT "sending command: ";hpib_command
 
 
 !======prepare====================================================
 hpib_command=VAL$(hpib_command)&VAL$(hpib_suffix)&"\n"
 
 !-- handle success ids
 ICCAP_FUNC("../string/cut_string","execute",VAL$(success_id_list))
 success_id="ICCAP_ARRAY["&VAL$(sizeof(../string/substring))&"]"
 i=0
 WHILE i < sizeof(../string/substring)
   success_id[i]=../string/substring[i]
   i = i + 1
 END WHILE
 
 !-- handle failure ids
 ICCAP_FUNC("../string/cut_string","execute",VAL$(failure_id_list))
 failure_id="ICCAP_ARRAY["&VAL$(sizeof(../string/substring))&"]"
 i=0
 WHILE i < sizeof(../string/substring)
   failure_id[i]=../string/substring[i]
   i = i + 1
 END WHILE
 
 !-- handle failure msg
 ICCAP_FUNC("../string/cut_string","execute",VAL$(failure_msg_list))
 failure_msg="ICCAP_ARRAY["&VAL$(sizeof(../string/substring))&"]"
 i=0
 WHILE i < sizeof(../string/substring)
   failure_msg[i]=../string/substring[i]
   i = i + 1
 END WHILE
 
 ErrorMsg = ""
 
 !=========do cmnds=================================================
 
 IF VAL$(OFFLINETest)=="0" THEN
   hpib_num=HPIB_open(VAL$(hpib_interface))
   dummy=HPIB_eoi(hpib_num, 1)
   !dummy=HPIB_clear(hpib_num, hpib_addr)
 
   !-- Start with flushing potential remaining status byte
   dummy=HPIB_spoll(hpib_num, hpib_addr)
   dummy=HPIB_spoll(hpib_num, hpib_addr)
 
   status=HPIB_write(hpib_num, hpib_addr, VAL$(hpib_command))
   IF status==-1 THEN
     ErrorMsg = "HPIB_write was not successful. Check GPIB bus/address."
     status=HPIB_close(hpib_num)
     RETURN_VALUE 0
   END IF
 END IF
 
 IF SIZE(success_id) == 0 AND SIZE(failure_id) == 0 THEN
   IF VAL$(OFFLINETest)=="0" THEN
     status=HPIB_close(hpib_num)
   END IF
   RETURN_VALUE 1
 ENDIF
 
 !-- check if commend is completely executed, waiting for response
 !answer=""
 !PRINT "waiting for response .."
 act_waiting_time=0
 
 UserStop = "FALSE"
 cnt = 0
 WHILE act_waiting_time<loop_timeout
 
   dummy = WPro_lookup_info("Run", "Stop", "UserStop")
   IF VAL$(UserStop) == "TRUE" THEN
     ErrorMsg = "User abort"
     RETURN_VALUE 0
   ENDIF
 
   IF VAL$(OFFLINETest)=="0" THEN
     RET=HPIB_spoll(hpib_num, hpib_addr)
   ELSE
     !-- Emulate
     IF cnt < 2 THEN
       RET = "0"
     ELSE
       RET = VAL$(success_id[0])
     END IF
   END IF
   PRINT "..="&VAL$(RET)
 
   !-- Success test
   i= 0
   WHILE i < SIZE(success_id)
     IF VAL$(RET)==VAL$(success_id[i]) THEN
       IF VAL$(OFFLINETest)=="0" THEN
         status=HPIB_close(hpib_num)
       END IF
       RETURN_VALUE 1
     END IF
     i = i + 1
   END WHILE
 
   !-- Failure test
   i=0
   WHILE i < SIZE(failure_id)
     IF VAL$(RET)==VAL$(failure_id[i]) THEN
       ErrorMsg = failure_msg[i]
       status=HPIB_close(hpib_num)
       RETURN_VALUE 0
     END IF
     i = i + 1
   END WHILE
 
   cnt = cnt+1
 
   dummy=WAIT(.1)
   act_waiting_time=act_waiting_time+.1
 
 END WHILE
 
 !-- Timeout
 ErrorMsg =  "Command has timed out"
 status = HPIB_close(hpib_num)
 
 RETURN_VALUE 0
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
list XFORM "Matrix/B2200A/Init"
list XFORM "Matrix/B2200A/disconnect_all"
list XFORM "Matrix/B2200A/connect_onepin"
list XFORM "Matrix/B2200A_01/connect"
list XFORM "Matrix/K70x/Init"
list XFORM "Matrix/K70x/connect"
list XFORM "Matrix/K70x/disconnect_all"
list XFORM "Matrix/K70x_01/Init"
list XFORM "Matrix/K70x_01/connect"
list XFORM "Matrix/K70x_01/disconnect_all"
list XFORM "Matrix/K70x_02/Init"
list XFORM "Matrix/K70x_02/connect"
list XFORM "Matrix/K70x_02/disconnect_all"
list XFORM "Matrix/K70xBridge/Init"
list XFORM "Matrix/K70xBridge/connect"
list XFORM "Matrix/K70xBridge/disconnect_all"
list XFORM "Matrix/K70xBridge/ground_all"
list XFORM "Matrix/K70xInvert/Init"
list XFORM "Matrix/K70xInvert/connect"
list XFORM "Matrix/K70xInvert/disconnect_all"
list XFORM "Matrix/K70xInvert/ground_all"
list XFORM "Chuck/Accretech/set_temperature"
list XFORM "Chuck/PS21/Init"
list XFORM "Chuck/PS21/set_temperature"
list XFORM "Chuck/SUMMIT/Init"
list XFORM "Chuck/TEL/set_temperature"
list XFORM "Chuck/TP032A/set_temperature"
}
LINK XFORM "receive_gpib" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 ! This Program sends a command, 
 ! waits for the response of the fulfilled command 
 ! and returns that response in Variable 'gpib_answer'.
 
 !---start of the program
 LINPUT "hpib_interface",  hpib_interface
 LINPUT "hpib_address",    hpib_addr
 LINPUT "hpib_suffix",     hpib_suffix
 
 LINPUT "enter gpib command", hpib_command
 LINPUT "Enter buffer size for receiving", nb_char
 
 hpib_addr = VAL(hpib_addr)
 
 
 !======prepare====================================================
 hpib_command=VAL$(hpib_command)&VAL$(hpib_suffix)&"\n"
 
 ErrorMsg = ""
 gpib_answer=""
 
 !=========do prober cmnds=================================================
 
 IF VAL$(OFFLINETest)=="0" THEN
 
   hpib_num=HPIB_open(VAL$(hpib_interface))
   dummy=HPIB_eoi(hpib_num, 1)
   dummy=HPIB_clear(hpib_num, hpib_addr)
 
   !-- Start with flushing potential remaining status byte
   dummy=HPIB_spoll(hpib_num, hpib_addr)
   dummy=HPIB_spoll(hpib_num, hpib_addr)
 
   status=HPIB_write(hpib_num,hpib_addr,VAL$(hpib_command))
   dummy=HPIB_timeout(hpib_num, 10)
   IF status==-1 THEN 
     ErrorMsg = "HPIB_write was not successful. Check GPIB bus/address."
     status=HPIB_close(hpib_num)
     RETURN_VALUE 0
   END IF
 
 END IF
 
 !-- check if commend is completely executed, waiting for prober response
 !answer=""
 !PRINT "waiting for prober response .."
 act_waiting_time=0
 gpib_answer=""
 
 IF VAL$(OFFLINETest)=="0" THEN
   status=HPIB_read(hpib_num, hpib_addr,VAL(nb_char),"A","gpib_answer")
   dummy=HPIB_close(hpib_num)
 ELSE
   !-- Emulate
   status = 0
   !gpib_answer = "1250.6089"
 END IF
 
 !-- Success test
 IF status<0 THEN 
   ErrorMsg="Cannot Read From gpib"
   RETURN_VALUE 0  !no success
 END IF
 
 IF Debug >= 1 THEN PRINT VAL$(gpib_answer)
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
list XFORM "Chuck/Accretech/get_temperature"
list XFORM "Chuck/PS21/get_temperature"
list XFORM "Chuck/PS21/set_temperature"
list XFORM "Chuck/SUMMIT/Init"
list XFORM "Chuck/SUMMIT/get_temperature"
list XFORM "Chuck/SUMMIT/set_temperature"
list XFORM "Chuck/TP032A/get_temperature"
}
LINK XFORM "receive_gpib_noClear" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 ! This Program sends a command, 
 ! waits for the response of the fulfilled command 
 ! and returns that response in Variable 'gpib_answer'.
 
 !---start of the program
 LINPUT "hpib_interface",  hpib_interface, hpib_interface
 LINPUT "hpib_address",    hpib_addr,      hpib_addr
 LINPUT "hpib_suffix",     hpib_suffix,    hpib_suffix
 
 LINPUT "enter gpib command", hpib_command, hpib_command
 LINPUT "Enter buffer size for receiving", nb_char, nb_char
 
 hpib_addr = VAL(hpib_addr)
 
 
 !======prepare====================================================
 hpib_command=VAL$(hpib_command)&VAL$(hpib_suffix)&"\n"
 
 ErrorMsg = ""
 gpib_answer=""
 
 !=========do prober cmnds=================================================
 
 IF VAL$(OFFLINETest)=="0" THEN
 
   hpib_num=HPIB_open(VAL$(hpib_interface))
   dummy=HPIB_eoi(hpib_num, 1)
   !dummy=HPIB_clear(hpib_num, hpib_addr)  !-- No Clear
 
   !-- Start with flushing potential remaining status byte
   dummy=HPIB_spoll(hpib_num, hpib_addr)
   dummy=HPIB_spoll(hpib_num, hpib_addr)
 
   status=HPIB_write(hpib_num,hpib_addr,VAL$(hpib_command))
   dummy=HPIB_timeout(hpib_num, 10)
   IF status==-1 THEN 
     ErrorMsg = "HPIB_write was not successful. Check GPIB bus/address."
     status=HPIB_close(hpib_num)
     RETURN_VALUE 0
   END IF
 
 END IF
 
 !-- check if commend is completely executed, waiting for prober response
 !answer=""
 !PRINT "waiting for prober response .."
 act_waiting_time=0
 gpib_answer=""
 
 IF VAL$(OFFLINETest)=="0" THEN
   status=HPIB_read(hpib_num, hpib_addr,VAL(nb_char),"A","gpib_answer")
   dummy=HPIB_close(hpib_num)
 ELSE
   !-- Emulate
   status = 0
   !gpib_answer = "1250.6089"
 END IF
 
 !-- Success test
 IF status<0 THEN 
   ErrorMsg="Cannot Read From gpib"
   RETURN_VALUE 0  !no success
 END IF
 
 IF Debug >= 1 THEN PRINT VAL$(gpib_answer)
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
list XFORM "Chuck/TEL/get_temperature"
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "send_spoll" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 LINPUT "Enter GPIB interface name", hpib_interface, hpib_interface
 LINPUT "Enter GPIB address",        hpib_addr, hpib_addr
 
 hpib_addr = VAL(hpib_addr)
 
 hpib_num = HPIB_open(VAL$(hpib_interface))
 
   dummy=HPIB_eoi(hpib_num, 1)
 
   !-- Flush following status byte
   RET   = HPIB_spoll(hpib_num, hpib_addr)
   PRINT "..="&VAL$(RET)
 
 status=HPIB_close(hpib_num)
 
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "send_string" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 LINPUT "Enter GPIB interface name", hpib_interface, hpib_interface
 LINPUT "Enter GPIB address",        hpib_addr, hpib_addr
 LINPUT "Enter GPIB command (w/ termination)", hpib_command, hpib_command
 
 hpib_addr = VAL(hpib_addr)
 
 hpib_num = HPIB_open(VAL$(hpib_interface))
 
 dummy=HPIB_eoi(hpib_num, 1)
 !dummy=HPIB_clear(hpib_num, hpib_addr)  !-- No Clear
 
 !-- Start with flushing potential remaining status byte
 dummy=HPIB_spoll(hpib_num, hpib_addr)
 dummy=HPIB_spoll(hpib_num, hpib_addr)
 
 !-- Write GPIB
 status=HPIB_write(hpib_num,hpib_addr,VAL$(hpib_command))
 dummy=HPIB_timeout(hpib_num, 10)
 IF status==-1 THEN 
   ErrorMsg = "HPIB_write was not successful. Check GPIB bus/address."
   status=HPIB_close(hpib_num)
   RETURN_VALUE 0
 END IF
 PRINT "Command sent: "&VAL$(hpib_command)
 
 status=HPIB_close(hpib_num)
 
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "receive_string" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 LINPUT "Enter GPIB interface name", hpib_interface, hpib_interface
 LINPUT "Enter GPIB address",        hpib_addr, hpib_addr
 LINPUT "Enter buffer size for receiving", nb_char, nb_char
 
 hpib_addr = VAL(hpib_addr)
 nb_char = VAL(nb_char)
 
 hpib_num = HPIB_open(VAL$(hpib_interface))
 
 gpib_answer=""
 
 !-- Read GPIB
 status=HPIB_read(hpib_num, VAL(hpib_addr),VAL(nb_char),"A","gpib_answer")
 PRINT "Characters read: "&VAL$(gpib_answer)
 
 status=HPIB_close(hpib_num)
 
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "send_receive_string" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !----------
 LINPUT "Enter GPIB interface name", hpib_interface, hpib_interface
 LINPUT "Enter GPIB address",        hpib_addr, hpib_addr
 LINPUT "Enter GPIB command (w/ termination)", hpib_command, hpib_command
 LINPUT "Enter buffer size for receiving", nb_char, nb_char
 
 hpib_addr = VAL(hpib_addr)
 nb_char = VAL(nb_char)
 
 hpib_num = HPIB_open(VAL$(hpib_interface))
 
 dummy=HPIB_eoi(hpib_num, 1)
 !dummy=HPIB_clear(hpib_num, hpib_addr)  !-- No Clear
 
 !-- Start with flushing potential remaining status byte
 dummy=HPIB_spoll(hpib_num, hpib_addr)
 dummy=HPIB_spoll(hpib_num, hpib_addr)
 
 !-- Write GPIB
 status=HPIB_write(hpib_num,hpib_addr,VAL$(hpib_command))
 dummy=HPIB_timeout(hpib_num, 10)
 IF status==-1 THEN 
   ErrorMsg = "HPIB_write was not successful. Check GPIB bus/address."
   status=HPIB_close(hpib_num)
   RETURN_VALUE 0
 END IF
 PRINT "Command sent: "&VAL$(hpib_command)
 
 !x = wait(0.5)
 iccap_func("/WaferPro","Wait Sec","0.5")
 
 gpib_answer=""
 
 !-- Read GPIB
 status=HPIB_read(hpib_num, VAL(hpib_addr),VAL(nb_char),"A","gpib_answer")
 PRINT "Characters read: "&VAL$(gpib_answer)
 
 status=HPIB_close(hpib_num)
 
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
data "742.004"
{
}
}
LINK DAT "string" "742.004"
{
View in_out 0 "0.811427528295 3556 2062"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P15 C15 C15 C10"
element 0 "Name" "substring[0]"
element 0 "Value" "#"
element 1 "Name" "substring[1]"
element 1 "Value" "Hz"
element 2 "Name" "substring[2]"
element 2 "Value" "S"
element 3 "Name" "substring[3]"
element 3 "Value" "RI"
element 4 "Name" "substring[4]"
element 4 "Value" "R"
element 5 "Name" "substring[5]"
element 5 "Value" "50"
element 6 "Name" "substring"
element 6 "Value" "ICCAP_ARRAY[6]"
element 7 "Name" "resstring"
element 7 "Value" "#,Hz,S,,RI,,,R,50"
element 8 "Name" ""
element 8 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "cut_string" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 !IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 ! separate strings in a string chain.
 ! Application: reading information from probers etc.
 
 ! NOTE: instead of this Program, you may rather apply the IC-CAP2008 PEL feature
 ! RetVal=CUTSTR(myStringChain, mySubstringArray [, myDelimiter])
 ! 
 !CUTSTR divides a string chain 'myStringChain' into substrings, 
 ! and saving the substrings in ICCAP_ARRAY 'mySubstringArray', 
 ! (to be specified in the ModelFile's Variable Hierarchy)
 ! using either (by default) whitespace delimiter (tabs, spaces, newlines) 
 ! or an explicitly passed 3rd argument 'myDelimiter' as a delimiter. 
 ! The leading space will be ignored when using the whitespace 
 ! as a delimiter. 
 ! Returns the size of ICCAP_ARRAY 'mySubstringArray'. 
 
 
 !required Setup Variables:
 !-------------------------
 ! substring   returns the chopped string chain elements as an ICCAP_ARRAY
 
 LINPUT "enter string chain",stringchain
 separator=";"      !specify here the separator character
 
 IF VAL$(stringchain)=="" THEN 
   substring="ICCAP_ARRAY[0]"
   RETURN
 END IF
 
 n=0
 substring="ICCAP_ARRAY[0]"   ! substring$ has to be defined as a Variable
 stringpos=1
 WHILE stringpos>0
   stringpos=STRPOS(VAL$(stringchain),VAL$(separator))
   IF stringpos>0 THEN 
     n=n+1 
     stringlen=STRLEN(VAL$(stringchain))
     substring="ICCAP_ARRAY["&VAL$(n)&"]"
     substring[n-1]=SUBSTR$(VAL$(stringchain),1,stringpos-1)
     stringchain=SUBSTR$(VAL$(stringchain),stringpos+1,stringlen)
   END IF
 END WHILE
 substring="ICCAP_ARRAY["&VAL$(n+1)&"]"
 substring[n]=stringchain
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "cut_string_sep" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 !IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 ! separate strings in a string chain.
 ! Application: reading information from probers etc.
 
 !required Setup Variables:
 !-------------------------
 ! substring   returns the chopped string chain elements as an ICCAP_ARRAY
 
 LINPUT "enter string chain",stringchain
 LINPUT "enter separator chain",separator
 
 IF VAL$(stringchain)=="" THEN 
   substring="ICCAP_ARRAY[0]"
   RETURN
 END IF
 
 n=0
 substring="ICCAP_ARRAY[0]"   ! substring$ has to be defined as a Variable
 stringpos=1
 WHILE stringpos>0
   stringpos=STRPOS(VAL$(stringchain),VAL$(separator))
   IF stringpos>0 THEN 
     if stringpos>=2 then
       n=n+1 
       stringlen=STRLEN(VAL$(stringchain))
       substring="ICCAP_ARRAY["&VAL$(n)&"]"
       substring[n-1]=SUBSTR$(VAL$(stringchain),1,stringpos-1)
     end if
     stringchain=SUBSTR$(VAL$(stringchain),stringpos+1,stringlen)
   END IF
 END WHILE
 
 IF stringchain <> "" THEN
   substring="ICCAP_ARRAY["&VAL$(n+1)&"]"
   substring[n]=stringchain
 ENDIF
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "replace_char_string" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 !IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 
 !required Setup Variables:
 !-------------------------
 ! resstring   returns the string of which the chars were replaced
 
 LINPUT "enter string chain",tgtString
 LINPUT "enter char org",charOrg
 LINPUT "enter char new",charNew
 
 tgtString$ = VAL$(tgtString)
 charOrg$ = VAL$(charOrg)
 charNew$ = VAL$(charNew)
 newString$ = ""
 
 ssize = strlen(tgtString$)
 i=0
 WHILE i < ssize
   ch$ = substr$(tgtString$,i+1,i+1)
   IF ch$==charOrg$ THEN
     newString$ = newString$ & charNew$
   ELSE
     newString$ = newString$ & ch$
   END IF
   i=i+1
 END WHILE
 
 resstring = newString$
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
data "742.004"
{
}
}
}
LINK DUT "______________" "742.004"
{
View tree_dut 1 "1"
TABLE "Variable Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "742.004"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
}
LINK DUT "Prober" "742.004"
{
View tree_dut 1 "1"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P23 C15 C15 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
View par_var_table 0 "V530 P23 P100 P100 P100 P100 P100 P100 P100"
}
}
}
LINK CONN "Connection" "742.004"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "ProberMgr" "742.004"
{
View in_out 0 "3.6354009789157 15666 11997"
View plot 0 "1.9621055172275 8715 6618"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P158 C15 C10"
element 0 "Name" "Prober"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "None"
element 5 "Name" "prober_addr"
element 5 "Value" "None"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "current_x"
element 8 "Value" "1000"
element 9 "Name" "current_y"
element 9 "Value" "2000"
element 10 "Name" "dil_factor"
element 10 "Value" "1000.04"
element 11 "Name" "_____________2"
element 11 "Value" ""
element 12 "Name" "Reticle"
element 12 "Value" "myReticle"
element 13 "Name" "ProberCoordinates"
element 13 "Value" "X-Right, Y-Up"
element 14 "Name" "WaferSize"
element 14 "Value" "300.0"
element 15 "Name" "DieSizeUnit"
element 15 "Value" "mm"
element 16 "Name" "DieSizeX"
element 16 "Value" "20.0"
element 17 "Name" "DieSizeY"
element 17 "Value" "30.0"
element 18 "Name" "OriMkPos"
element 18 "Value" ""
element 19 "Name" "OriMkType"
element 19 "Value" ""
element 20 "Name" "FlatLength"
element 20 "Value" ""
element 21 "Name" ""
element 21 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,1183,1656"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! ProberMgr is called by WaferPro for a prober action.
 ! It then requests from Wafer which prober to address,
 ! and redirects the requested action to the Setup of
 ! the requested prober.
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober[Name]", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   bRet = 1
   RETURN_VALUE bRet
 END IF
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   bRet = 1
   RETURN_VALUE bRet
 END IF
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "Init"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "start" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [start]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "start"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_reference" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_reference]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "set_reference"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_wafer_map" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_wafer_map]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 GLOBAL_VAR  Reticle           !SetupVariable
 GLOBAL_VAR  ProberCoordinates !SetupVariable
 GLOBAL_VAR  WaferSize         !SetupVariable
 GLOBAL_VAR  DieSizeUnit       !SetupVariable
 GLOBAL_VAR  DieSizeX          !SetupVariable
 GLOBAL_VAR  DieSizeY          !SetupVariable
 GLOBAL_VAR  OriMkPos          !SetupVariable
 GLOBAL_VAR  OriMkType         !SetupVariable
 GLOBAL_VAR  FlatLength        !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 ! Get Prober Wafer Map
 Reticle           = "myReticle"
 ProberCoordinates = "X-Right, Y-Up"
 WaferSize         = 300.0
 DieSizeUnit       = "mm"
 DieSizeX          = 20.0
 DieSizeY          = 30.0
 OriMkPos          = "Marker Bottom"
 OriMkType         = "Notch"
 FlatLength        = 0.0
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "get_wafer_map"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 x=check_error_log()
 IF x > 0 THEN
   bRet = 0
   RETURN_VALUE bRet
 END IF
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 Reticle           = lookup_var(ProberDriver & "Reticle")
 ProberCoordinates = lookup_var(ProberDriver & "ProberCoordinates")
 WaferSize         = lookup_var(ProberDriver & "WaferSize")
 DieSizeUnit       = lookup_var(ProberDriver & "DieSizeUnit")
 DieSizeX          = lookup_var(ProberDriver & "DieSizeX")
 DieSizeY          = lookup_var(ProberDriver & "DieSizeY")
 OriMkPos          = lookup_var(ProberDriver & "OriMkPos")
 OriMkType         = lookup_var(ProberDriver & "OriMkType")
 FlatLength        = lookup_var(ProberDriver & "FlatLength")
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_wafer_map" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_wafer_map]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 GLOBAL_VAR  Reticle           !SetupVariable
 GLOBAL_VAR  ProberCoordinates !SetupVariable
 GLOBAL_VAR  WaferSize         !SetupVariable
 GLOBAL_VAR  DieSizeUnit       !SetupVariable
 GLOBAL_VAR  DieSizeX          !SetupVariable
 GLOBAL_VAR  DieSizeY          !SetupVariable
 GLOBAL_VAR  OriMkPos          !SetupVariable
 GLOBAL_VAR  OriMkType         !SetupVariable
 GLOBAL_VAR  FlatLength        !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Enter Reticle Name", Reticle
 LINPUT "Enter Prober Coordinates", ProberCoordinates
 LINPUT "Enter Wafer Diameter (mm)", WaferSize
 LINPUT "Enter Die Size Unit (um/mm)", DieSizeUnit
 LINPUT "Enter Die Size X (mm)", DieSizeX
 LINPUT "Enter Die Size Y (mm)", DieSizeY
 LINPUT "Enter Orientation Marker Position", OriMkPos
 LINPUT "Enter Orientation Marker Type", OriMkType
 LINPUT "Enter Flat Length (mm)", FlatLength
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "set_wafer_map"
 
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "Reticle", Reticle)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "ProberCoordinates", ProberCoordinates)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "WaferSize", WaferSize)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "DieSizeUnit", DieSizeUnit)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "DieSizeX", DieSizeX)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "DieSizeY", DieSizeY)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "OriMkPos", OriMkPos)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "OriMkType", OriMkType)
 iccap_func(ProberDriver&"/.","SetVariableTableValue", "FlatLength", FlatLength)
 
 ICCAP_FUNC(ProberCmd, "Execute")
 x=check_error_log()
 IF x > 0 THEN
   bRet = 0
   RETURN_VALUE bRet
 END IF
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "load_next" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [load_next]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Enter Load Wafer Slot",    next_load_wafer_slot
 LINPUT "Enter Preload Wafer Slot (enter '0' or '' for no preloading)", next_preload_wafer_slot
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "load_next"
 
 ICCAP_FUNC(ProberCmd, "Execute", next_load_wafer_slot, next_preload_wafer_slot)
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "align" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [align]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "align"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "go_home" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [go_home]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "go_home"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "contact" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [contact]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "contact"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "no_contact" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [no_contact]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "no_contact"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "needle_cleaning" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [needle_cleaning]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "needle_cleaning"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_index" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [move_index]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Enter delta_index_x", delta_x
 LINPUT "Enter delta_index_y", delta_y
 
 IF Debug >= 1 THEN
  print "Move Delta Index X: ", delta_x
  print "Move Delta Index Y: ", delta_y
 END IF
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "move_index"
 
 ICCAP_FUNC(ProberCmd, "Execute", delta_x, delta_y)
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_delta" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [move_delta]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Enter delta_x(um)", delta_x
 LINPUT "Enter delta_y(um)", delta_y
 
 IF Debug >= 1 THEN
  print "Move Delta Pos x: ", delta_x
  print "Move Delta Pos y: ", delta_y
 END IF
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "move_delta"
 
 IF VAL(delta_x) == 0 AND VAL(delta_y) == 0 THEN RETURN_VALUE 1
 
 ICCAP_FUNC(ProberCmd, "Execute", delta_x, delta_y)
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_subs_pos" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [move_subs_pos]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Enter subs_x(um)", subs_x
 LINPUT "Enter subs_y(um)", subs_y
 
 IF Debug >= 1 THEN
  print "Move to Subsite xPos: ", subs_x
  print "Move to Subsite yPos: ", subs_y
 END IF
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "move_subs_pos" !!!*** Transform Name ***!!!
 
 ICCAP_FUNC(ProberCmd, "Execute", subs_x, subs_y)
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_position" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_position]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 ! Retreive current on wafer poistion. (retuned values in um)
 current_x = 0
 current_y = 0
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "get_position"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 current_x = lookup_var(ProberDriver & "current_x")
 current_y = lookup_var(ProberDriver & "current_y")
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "unload_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [unload_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Prober          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Prober", "Prober")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Prober)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Prober Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     !IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Prober is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ProberDriver = "../" & VAL$(Prober) & "/"
 ProberCmd    = ProberDriver & "unload_all"
 
 ICCAP_FUNC(ProberCmd, "Execute")
 
 bRet = lookup_var(ProberDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ProberDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "showMessage" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [showMessage]
 
 GLOBAL_VAR  TmpVar          !ModelVariable
 
 GET_STRING "Message?", msg$
 GET_STRING "Show in Status Window?", stw$
 
 dummy = WPro_lookup_info("Run", "SingleExeRun", "TmpVar")
 
 IF VAL$(TmpVar)=="TRUE" THEN
   GET_STRING msg$ & "   [OK]", dummy
 END IF
 
 c$ = upc$(substr$(trim$(stw$),1,1))
 IF c$=="Y" OR c$=="T" OR c$=="1" THEN
   PRINT msg$
 END IF
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Test_FET" "742.004"
{
View in_out 0 "1.7999169740827 15262 8330"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P23 C10 C10 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "freq" "742.004"
{
View draw_ds 0 "B,2986,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "F"
element "Sweep Type" "LIN"
}
HYPTABLE "Edit Sweep Mode Def"
{
}
HYPTABLE "Edit Sweep Def"
{
element "Sweep Order" "1"
element "Start" " 1.000G"
element "Stop" " 67.00G"
element "# of Points" "101"
element "Step Size" " 660.0MEG"
}
}
}
LINK OUT "spara" "742.004"
{
View draw_ds 0 "B,5306,166"
data
{
HYPTABLE "Edit Output Info"
{
element "Mode" "S"
element "Unit" "NWA"
element "Type" "B"
}
HYPTABLE "Edit Out Mode Def"
{
element "Port 1" "1"
element "Port 2" "2"
element "AC Ground" "GROUND"
}
dataset
{
datasize BOTH 101 2 2
type MEAS
point 0 1 1 0 0
point 0 1 2 0 0
point 0 2 1 0 0
point 0 2 2 0 0
point 1 1 1 0 0
point 1 1 2 0 0
point 1 2 1 0 0
point 1 2 2 0 0
point 2 1 1 0 0
point 2 1 2 0 0
point 2 2 1 0 0
point 2 2 2 0 0
point 3 1 1 0 0
point 3 1 2 0 0
point 3 2 1 0 0
point 3 2 2 0 0
point 4 1 1 0 0
point 4 1 2 0 0
point 4 2 1 0 0
point 4 2 2 0 0
point 5 1 1 0 0
point 5 1 2 0 0
point 5 2 1 0 0
point 5 2 2 0 0
point 6 1 1 0 0
point 6 1 2 0 0
point 6 2 1 0 0
point 6 2 2 0 0
point 7 1 1 0 0
point 7 1 2 0 0
point 7 2 1 0 0
point 7 2 2 0 0
point 8 1 1 0 0
point 8 1 2 0 0
point 8 2 1 0 0
point 8 2 2 0 0
point 9 1 1 0 0
point 9 1 2 0 0
point 9 2 1 0 0
point 9 2 2 0 0
point 10 1 1 0 0
point 10 1 2 0 0
point 10 2 1 0 0
point 10 2 2 0 0
point 11 1 1 0 0
point 11 1 2 0 0
point 11 2 1 0 0
point 11 2 2 0 0
point 12 1 1 0 0
point 12 1 2 0 0
point 12 2 1 0 0
point 12 2 2 0 0
point 13 1 1 0 0
point 13 1 2 0 0
point 13 2 1 0 0
point 13 2 2 0 0
point 14 1 1 0 0
point 14 1 2 0 0
point 14 2 1 0 0
point 14 2 2 0 0
point 15 1 1 0 0
point 15 1 2 0 0
point 15 2 1 0 0
point 15 2 2 0 0
point 16 1 1 0 0
point 16 1 2 0 0
point 16 2 1 0 0
point 16 2 2 0 0
point 17 1 1 0 0
point 17 1 2 0 0
point 17 2 1 0 0
point 17 2 2 0 0
point 18 1 1 0 0
point 18 1 2 0 0
point 18 2 1 0 0
point 18 2 2 0 0
point 19 1 1 0 0
point 19 1 2 0 0
point 19 2 1 0 0
point 19 2 2 0 0
point 20 1 1 0 0
point 20 1 2 0 0
point 20 2 1 0 0
point 20 2 2 0 0
point 21 1 1 0 0
point 21 1 2 0 0
point 21 2 1 0 0
point 21 2 2 0 0
point 22 1 1 0 0
point 22 1 2 0 0
point 22 2 1 0 0
point 22 2 2 0 0
point 23 1 1 0 0
point 23 1 2 0 0
point 23 2 1 0 0
point 23 2 2 0 0
point 24 1 1 0 0
point 24 1 2 0 0
point 24 2 1 0 0
point 24 2 2 0 0
point 25 1 1 0 0
point 25 1 2 0 0
point 25 2 1 0 0
point 25 2 2 0 0
point 26 1 1 0 0
point 26 1 2 0 0
point 26 2 1 0 0
point 26 2 2 0 0
point 27 1 1 0 0
point 27 1 2 0 0
point 27 2 1 0 0
point 27 2 2 0 0
point 28 1 1 0 0
point 28 1 2 0 0
point 28 2 1 0 0
point 28 2 2 0 0
point 29 1 1 0 0
point 29 1 2 0 0
point 29 2 1 0 0
point 29 2 2 0 0
point 30 1 1 0 0
point 30 1 2 0 0
point 30 2 1 0 0
point 30 2 2 0 0
point 31 1 1 0 0
point 31 1 2 0 0
point 31 2 1 0 0
point 31 2 2 0 0
point 32 1 1 0 0
point 32 1 2 0 0
point 32 2 1 0 0
point 32 2 2 0 0
point 33 1 1 0 0
point 33 1 2 0 0
point 33 2 1 0 0
point 33 2 2 0 0
point 34 1 1 0 0
point 34 1 2 0 0
point 34 2 1 0 0
point 34 2 2 0 0
point 35 1 1 0 0
point 35 1 2 0 0
point 35 2 1 0 0
point 35 2 2 0 0
point 36 1 1 0 0
point 36 1 2 0 0
point 36 2 1 0 0
point 36 2 2 0 0
point 37 1 1 0 0
point 37 1 2 0 0
point 37 2 1 0 0
point 37 2 2 0 0
point 38 1 1 0 0
point 38 1 2 0 0
point 38 2 1 0 0
point 38 2 2 0 0
point 39 1 1 0 0
point 39 1 2 0 0
point 39 2 1 0 0
point 39 2 2 0 0
point 40 1 1 0 0
point 40 1 2 0 0
point 40 2 1 0 0
point 40 2 2 0 0
point 41 1 1 0 0
point 41 1 2 0 0
point 41 2 1 0 0
point 41 2 2 0 0
point 42 1 1 0 0
point 42 1 2 0 0
point 42 2 1 0 0
point 42 2 2 0 0
point 43 1 1 0 0
point 43 1 2 0 0
point 43 2 1 0 0
point 43 2 2 0 0
point 44 1 1 0 0
point 44 1 2 0 0
point 44 2 1 0 0
point 44 2 2 0 0
point 45 1 1 0 0
point 45 1 2 0 0
point 45 2 1 0 0
point 45 2 2 0 0
point 46 1 1 0 0
point 46 1 2 0 0
point 46 2 1 0 0
point 46 2 2 0 0
point 47 1 1 0 0
point 47 1 2 0 0
point 47 2 1 0 0
point 47 2 2 0 0
point 48 1 1 0 0
point 48 1 2 0 0
point 48 2 1 0 0
point 48 2 2 0 0
point 49 1 1 0 0
point 49 1 2 0 0
point 49 2 1 0 0
point 49 2 2 0 0
point 50 1 1 0 0
point 50 1 2 0 0
point 50 2 1 0 0
point 50 2 2 0 0
point 51 1 1 0 0
point 51 1 2 0 0
point 51 2 1 0 0
point 51 2 2 0 0
point 52 1 1 0 0
point 52 1 2 0 0
point 52 2 1 0 0
point 52 2 2 0 0
point 53 1 1 0 0
point 53 1 2 0 0
point 53 2 1 0 0
point 53 2 2 0 0
point 54 1 1 0 0
point 54 1 2 0 0
point 54 2 1 0 0
point 54 2 2 0 0
point 55 1 1 0 0
point 55 1 2 0 0
point 55 2 1 0 0
point 55 2 2 0 0
point 56 1 1 0 0
point 56 1 2 0 0
point 56 2 1 0 0
point 56 2 2 0 0
point 57 1 1 0 0
point 57 1 2 0 0
point 57 2 1 0 0
point 57 2 2 0 0
point 58 1 1 0 0
point 58 1 2 0 0
point 58 2 1 0 0
point 58 2 2 0 0
point 59 1 1 0 0
point 59 1 2 0 0
point 59 2 1 0 0
point 59 2 2 0 0
point 60 1 1 0 0
point 60 1 2 0 0
point 60 2 1 0 0
point 60 2 2 0 0
point 61 1 1 0 0
point 61 1 2 0 0
point 61 2 1 0 0
point 61 2 2 0 0
point 62 1 1 0 0
point 62 1 2 0 0
point 62 2 1 0 0
point 62 2 2 0 0
point 63 1 1 0 0
point 63 1 2 0 0
point 63 2 1 0 0
point 63 2 2 0 0
point 64 1 1 0 0
point 64 1 2 0 0
point 64 2 1 0 0
point 64 2 2 0 0
point 65 1 1 0 0
point 65 1 2 0 0
point 65 2 1 0 0
point 65 2 2 0 0
point 66 1 1 0 0
point 66 1 2 0 0
point 66 2 1 0 0
point 66 2 2 0 0
point 67 1 1 0 0
point 67 1 2 0 0
point 67 2 1 0 0
point 67 2 2 0 0
point 68 1 1 0 0
point 68 1 2 0 0
point 68 2 1 0 0
point 68 2 2 0 0
point 69 1 1 0 0
point 69 1 2 0 0
point 69 2 1 0 0
point 69 2 2 0 0
point 70 1 1 0 0
point 70 1 2 0 0
point 70 2 1 0 0
point 70 2 2 0 0
point 71 1 1 0 0
point 71 1 2 0 0
point 71 2 1 0 0
point 71 2 2 0 0
point 72 1 1 0 0
point 72 1 2 0 0
point 72 2 1 0 0
point 72 2 2 0 0
point 73 1 1 0 0
point 73 1 2 0 0
point 73 2 1 0 0
point 73 2 2 0 0
point 74 1 1 0 0
point 74 1 2 0 0
point 74 2 1 0 0
point 74 2 2 0 0
point 75 1 1 0 0
point 75 1 2 0 0
point 75 2 1 0 0
point 75 2 2 0 0
point 76 1 1 0 0
point 76 1 2 0 0
point 76 2 1 0 0
point 76 2 2 0 0
point 77 1 1 0 0
point 77 1 2 0 0
point 77 2 1 0 0
point 77 2 2 0 0
point 78 1 1 0 0
point 78 1 2 0 0
point 78 2 1 0 0
point 78 2 2 0 0
point 79 1 1 0 0
point 79 1 2 0 0
point 79 2 1 0 0
point 79 2 2 0 0
point 80 1 1 0 0
point 80 1 2 0 0
point 80 2 1 0 0
point 80 2 2 0 0
point 81 1 1 0 0
point 81 1 2 0 0
point 81 2 1 0 0
point 81 2 2 0 0
point 82 1 1 0 0
point 82 1 2 0 0
point 82 2 1 0 0
point 82 2 2 0 0
point 83 1 1 0 0
point 83 1 2 0 0
point 83 2 1 0 0
point 83 2 2 0 0
point 84 1 1 0 0
point 84 1 2 0 0
point 84 2 1 0 0
point 84 2 2 0 0
point 85 1 1 0 0
point 85 1 2 0 0
point 85 2 1 0 0
point 85 2 2 0 0
point 86 1 1 0 0
point 86 1 2 0 0
point 86 2 1 0 0
point 86 2 2 0 0
point 87 1 1 0 0
point 87 1 2 0 0
point 87 2 1 0 0
point 87 2 2 0 0
point 88 1 1 0 0
point 88 1 2 0 0
point 88 2 1 0 0
point 88 2 2 0 0
point 89 1 1 0 0
point 89 1 2 0 0
point 89 2 1 0 0
point 89 2 2 0 0
point 90 1 1 0 0
point 90 1 2 0 0
point 90 2 1 0 0
point 90 2 2 0 0
point 91 1 1 0 0
point 91 1 2 0 0
point 91 2 1 0 0
point 91 2 2 0 0
point 92 1 1 0 0
point 92 1 2 0 0
point 92 2 1 0 0
point 92 2 2 0 0
point 93 1 1 0 0
point 93 1 2 0 0
point 93 2 1 0 0
point 93 2 2 0 0
point 94 1 1 0 0
point 94 1 2 0 0
point 94 2 1 0 0
point 94 2 2 0 0
point 95 1 1 0 0
point 95 1 2 0 0
point 95 2 1 0 0
point 95 2 2 0 0
point 96 1 1 0 0
point 96 1 2 0 0
point 96 2 1 0 0
point 96 2 2 0 0
point 97 1 1 0 0
point 97 1 2 0 0
point 97 2 1 0 0
point 97 2 2 0 0
point 98 1 1 0 0
point 98 1 2 0 0
point 98 2 1 0 0
point 98 2 2 0 0
point 99 1 1 0 0
point 99 1 2 0 0
point 99 2 1 0 0
point 99 2 2 0 0
point 100 1 1 0 0
point 100 1 2 0 0
point 100 2 1 0 0
point 100 2 2 0 0
type SIMU
point 0 1 1 0 0
point 0 1 2 0 0
point 0 2 1 0 0
point 0 2 2 0 0
point 1 1 1 0 0
point 1 1 2 0 0
point 1 2 1 0 0
point 1 2 2 0 0
point 2 1 1 0 0
point 2 1 2 0 0
point 2 2 1 0 0
point 2 2 2 0 0
point 3 1 1 0 0
point 3 1 2 0 0
point 3 2 1 0 0
point 3 2 2 0 0
point 4 1 1 0 0
point 4 1 2 0 0
point 4 2 1 0 0
point 4 2 2 0 0
point 5 1 1 0 0
point 5 1 2 0 0
point 5 2 1 0 0
point 5 2 2 0 0
point 6 1 1 0 0
point 6 1 2 0 0
point 6 2 1 0 0
point 6 2 2 0 0
point 7 1 1 0 0
point 7 1 2 0 0
point 7 2 1 0 0
point 7 2 2 0 0
point 8 1 1 0 0
point 8 1 2 0 0
point 8 2 1 0 0
point 8 2 2 0 0
point 9 1 1 0 0
point 9 1 2 0 0
point 9 2 1 0 0
point 9 2 2 0 0
point 10 1 1 0 0
point 10 1 2 0 0
point 10 2 1 0 0
point 10 2 2 0 0
point 11 1 1 0 0
point 11 1 2 0 0
point 11 2 1 0 0
point 11 2 2 0 0
point 12 1 1 0 0
point 12 1 2 0 0
point 12 2 1 0 0
point 12 2 2 0 0
point 13 1 1 0 0
point 13 1 2 0 0
point 13 2 1 0 0
point 13 2 2 0 0
point 14 1 1 0 0
point 14 1 2 0 0
point 14 2 1 0 0
point 14 2 2 0 0
point 15 1 1 0 0
point 15 1 2 0 0
point 15 2 1 0 0
point 15 2 2 0 0
point 16 1 1 0 0
point 16 1 2 0 0
point 16 2 1 0 0
point 16 2 2 0 0
point 17 1 1 0 0
point 17 1 2 0 0
point 17 2 1 0 0
point 17 2 2 0 0
point 18 1 1 0 0
point 18 1 2 0 0
point 18 2 1 0 0
point 18 2 2 0 0
point 19 1 1 0 0
point 19 1 2 0 0
point 19 2 1 0 0
point 19 2 2 0 0
point 20 1 1 0 0
point 20 1 2 0 0
point 20 2 1 0 0
point 20 2 2 0 0
point 21 1 1 0 0
point 21 1 2 0 0
point 21 2 1 0 0
point 21 2 2 0 0
point 22 1 1 0 0
point 22 1 2 0 0
point 22 2 1 0 0
point 22 2 2 0 0
point 23 1 1 0 0
point 23 1 2 0 0
point 23 2 1 0 0
point 23 2 2 0 0
point 24 1 1 0 0
point 24 1 2 0 0
point 24 2 1 0 0
point 24 2 2 0 0
point 25 1 1 0 0
point 25 1 2 0 0
point 25 2 1 0 0
point 25 2 2 0 0
point 26 1 1 0 0
point 26 1 2 0 0
point 26 2 1 0 0
point 26 2 2 0 0
point 27 1 1 0 0
point 27 1 2 0 0
point 27 2 1 0 0
point 27 2 2 0 0
point 28 1 1 0 0
point 28 1 2 0 0
point 28 2 1 0 0
point 28 2 2 0 0
point 29 1 1 0 0
point 29 1 2 0 0
point 29 2 1 0 0
point 29 2 2 0 0
point 30 1 1 0 0
point 30 1 2 0 0
point 30 2 1 0 0
point 30 2 2 0 0
point 31 1 1 0 0
point 31 1 2 0 0
point 31 2 1 0 0
point 31 2 2 0 0
point 32 1 1 0 0
point 32 1 2 0 0
point 32 2 1 0 0
point 32 2 2 0 0
point 33 1 1 0 0
point 33 1 2 0 0
point 33 2 1 0 0
point 33 2 2 0 0
point 34 1 1 0 0
point 34 1 2 0 0
point 34 2 1 0 0
point 34 2 2 0 0
point 35 1 1 0 0
point 35 1 2 0 0
point 35 2 1 0 0
point 35 2 2 0 0
point 36 1 1 0 0
point 36 1 2 0 0
point 36 2 1 0 0
point 36 2 2 0 0
point 37 1 1 0 0
point 37 1 2 0 0
point 37 2 1 0 0
point 37 2 2 0 0
point 38 1 1 0 0
point 38 1 2 0 0
point 38 2 1 0 0
point 38 2 2 0 0
point 39 1 1 0 0
point 39 1 2 0 0
point 39 2 1 0 0
point 39 2 2 0 0
point 40 1 1 0 0
point 40 1 2 0 0
point 40 2 1 0 0
point 40 2 2 0 0
point 41 1 1 0 0
point 41 1 2 0 0
point 41 2 1 0 0
point 41 2 2 0 0
point 42 1 1 0 0
point 42 1 2 0 0
point 42 2 1 0 0
point 42 2 2 0 0
point 43 1 1 0 0
point 43 1 2 0 0
point 43 2 1 0 0
point 43 2 2 0 0
point 44 1 1 0 0
point 44 1 2 0 0
point 44 2 1 0 0
point 44 2 2 0 0
point 45 1 1 0 0
point 45 1 2 0 0
point 45 2 1 0 0
point 45 2 2 0 0
point 46 1 1 0 0
point 46 1 2 0 0
point 46 2 1 0 0
point 46 2 2 0 0
point 47 1 1 0 0
point 47 1 2 0 0
point 47 2 1 0 0
point 47 2 2 0 0
point 48 1 1 0 0
point 48 1 2 0 0
point 48 2 1 0 0
point 48 2 2 0 0
point 49 1 1 0 0
point 49 1 2 0 0
point 49 2 1 0 0
point 49 2 2 0 0
point 50 1 1 0 0
point 50 1 2 0 0
point 50 2 1 0 0
point 50 2 2 0 0
point 51 1 1 0 0
point 51 1 2 0 0
point 51 2 1 0 0
point 51 2 2 0 0
point 52 1 1 0 0
point 52 1 2 0 0
point 52 2 1 0 0
point 52 2 2 0 0
point 53 1 1 0 0
point 53 1 2 0 0
point 53 2 1 0 0
point 53 2 2 0 0
point 54 1 1 0 0
point 54 1 2 0 0
point 54 2 1 0 0
point 54 2 2 0 0
point 55 1 1 0 0
point 55 1 2 0 0
point 55 2 1 0 0
point 55 2 2 0 0
point 56 1 1 0 0
point 56 1 2 0 0
point 56 2 1 0 0
point 56 2 2 0 0
point 57 1 1 0 0
point 57 1 2 0 0
point 57 2 1 0 0
point 57 2 2 0 0
point 58 1 1 0 0
point 58 1 2 0 0
point 58 2 1 0 0
point 58 2 2 0 0
point 59 1 1 0 0
point 59 1 2 0 0
point 59 2 1 0 0
point 59 2 2 0 0
point 60 1 1 0 0
point 60 1 2 0 0
point 60 2 1 0 0
point 60 2 2 0 0
point 61 1 1 0 0
point 61 1 2 0 0
point 61 2 1 0 0
point 61 2 2 0 0
point 62 1 1 0 0
point 62 1 2 0 0
point 62 2 1 0 0
point 62 2 2 0 0
point 63 1 1 0 0
point 63 1 2 0 0
point 63 2 1 0 0
point 63 2 2 0 0
point 64 1 1 0 0
point 64 1 2 0 0
point 64 2 1 0 0
point 64 2 2 0 0
point 65 1 1 0 0
point 65 1 2 0 0
point 65 2 1 0 0
point 65 2 2 0 0
point 66 1 1 0 0
point 66 1 2 0 0
point 66 2 1 0 0
point 66 2 2 0 0
point 67 1 1 0 0
point 67 1 2 0 0
point 67 2 1 0 0
point 67 2 2 0 0
point 68 1 1 0 0
point 68 1 2 0 0
point 68 2 1 0 0
point 68 2 2 0 0
point 69 1 1 0 0
point 69 1 2 0 0
point 69 2 1 0 0
point 69 2 2 0 0
point 70 1 1 0 0
point 70 1 2 0 0
point 70 2 1 0 0
point 70 2 2 0 0
point 71 1 1 0 0
point 71 1 2 0 0
point 71 2 1 0 0
point 71 2 2 0 0
point 72 1 1 0 0
point 72 1 2 0 0
point 72 2 1 0 0
point 72 2 2 0 0
point 73 1 1 0 0
point 73 1 2 0 0
point 73 2 1 0 0
point 73 2 2 0 0
point 74 1 1 0 0
point 74 1 2 0 0
point 74 2 1 0 0
point 74 2 2 0 0
point 75 1 1 0 0
point 75 1 2 0 0
point 75 2 1 0 0
point 75 2 2 0 0
point 76 1 1 0 0
point 76 1 2 0 0
point 76 2 1 0 0
point 76 2 2 0 0
point 77 1 1 0 0
point 77 1 2 0 0
point 77 2 1 0 0
point 77 2 2 0 0
point 78 1 1 0 0
point 78 1 2 0 0
point 78 2 1 0 0
point 78 2 2 0 0
point 79 1 1 0 0
point 79 1 2 0 0
point 79 2 1 0 0
point 79 2 2 0 0
point 80 1 1 0 0
point 80 1 2 0 0
point 80 2 1 0 0
point 80 2 2 0 0
point 81 1 1 0 0
point 81 1 2 0 0
point 81 2 1 0 0
point 81 2 2 0 0
point 82 1 1 0 0
point 82 1 2 0 0
point 82 2 1 0 0
point 82 2 2 0 0
point 83 1 1 0 0
point 83 1 2 0 0
point 83 2 1 0 0
point 83 2 2 0 0
point 84 1 1 0 0
point 84 1 2 0 0
point 84 2 1 0 0
point 84 2 2 0 0
point 85 1 1 0 0
point 85 1 2 0 0
point 85 2 1 0 0
point 85 2 2 0 0
point 86 1 1 0 0
point 86 1 2 0 0
point 86 2 1 0 0
point 86 2 2 0 0
point 87 1 1 0 0
point 87 1 2 0 0
point 87 2 1 0 0
point 87 2 2 0 0
point 88 1 1 0 0
point 88 1 2 0 0
point 88 2 1 0 0
point 88 2 2 0 0
point 89 1 1 0 0
point 89 1 2 0 0
point 89 2 1 0 0
point 89 2 2 0 0
point 90 1 1 0 0
point 90 1 2 0 0
point 90 2 1 0 0
point 90 2 2 0 0
point 91 1 1 0 0
point 91 1 2 0 0
point 91 2 1 0 0
point 91 2 2 0 0
point 92 1 1 0 0
point 92 1 2 0 0
point 92 2 1 0 0
point 92 2 2 0 0
point 93 1 1 0 0
point 93 1 2 0 0
point 93 2 1 0 0
point 93 2 2 0 0
point 94 1 1 0 0
point 94 1 2 0 0
point 94 2 1 0 0
point 94 2 2 0 0
point 95 1 1 0 0
point 95 1 2 0 0
point 95 2 1 0 0
point 95 2 2 0 0
point 96 1 1 0 0
point 96 1 2 0 0
point 96 2 1 0 0
point 96 2 2 0 0
point 97 1 1 0 0
point 97 1 2 0 0
point 97 2 1 0 0
point 97 2 2 0 0
point 98 1 1 0 0
point 98 1 2 0 0
point 98 2 1 0 0
point 98 2 2 0 0
point 99 1 1 0 0
point 99 1 2 0 0
point 99 2 1 0 0
point 99 2 2 0 0
point 100 1 1 0 0
point 100 1 2 0 0
point 100 2 1 0 0
point 100 2 2 0 0
}
}
}
LINK XFORM "test_auto" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 no_wafers = 1
 WHILE no_wafers < 10
 print "no_wafer:", no_wafers
 ICCAP_FUNC("EUMW/Prober/SENTIO/light_on", "Execute")
 ICCAP_FUNC("EUMW/Prober/SENTIO/go_home", "Execute")
 ICCAP_FUNC("EUMW/Prober/SENTIO/first_die", "Execute")
 no_dies = 1
 
     WHILE no_dies < 20
     print "no_dies:", no_dies
     ICCAP_FUNC("EUMW/Prober/SENTIO/light_on", "Execute")
     ICCAP_FUNC("EUMW/Prober/SENTIO/next_die", "Execute")
     ICCAP_FUNC("EUMW/Prober/SENTIO/light_off", "Execute")
     !iccap_func(".","Measure")
     REtVal=WAIT(2)
     no_dies = no_dies+1
     END WHILE
 
 ICCAP_FUNC("EUMW/Prober/SENTIO/light_on", "Execute")
 no_wafers = no_wafers+1
 END WHILE
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 101 1 1
type COMMON
point 0 1 1 0 0
point 1 1 1 0 0
point 2 1 1 0 0
point 3 1 1 0 0
point 4 1 1 0 0
point 5 1 1 0 0
point 6 1 1 0 0
point 7 1 1 0 0
point 8 1 1 0 0
point 9 1 1 0 0
point 10 1 1 0 0
point 11 1 1 0 0
point 12 1 1 0 0
point 13 1 1 0 0
point 14 1 1 0 0
point 15 1 1 0 0
point 16 1 1 0 0
point 17 1 1 0 0
point 18 1 1 0 0
point 19 1 1 0 0
point 20 1 1 0 0
point 21 1 1 0 0
point 22 1 1 0 0
point 23 1 1 0 0
point 24 1 1 0 0
point 25 1 1 0 0
point 26 1 1 0 0
point 27 1 1 0 0
point 28 1 1 0 0
point 29 1 1 0 0
point 30 1 1 0 0
point 31 1 1 0 0
point 32 1 1 0 0
point 33 1 1 0 0
point 34 1 1 0 0
point 35 1 1 0 0
point 36 1 1 0 0
point 37 1 1 0 0
point 38 1 1 0 0
point 39 1 1 0 0
point 40 1 1 0 0
point 41 1 1 0 0
point 42 1 1 0 0
point 43 1 1 0 0
point 44 1 1 0 0
point 45 1 1 0 0
point 46 1 1 0 0
point 47 1 1 0 0
point 48 1 1 0 0
point 49 1 1 0 0
point 50 1 1 0 0
point 51 1 1 0 0
point 52 1 1 0 0
point 53 1 1 0 0
point 54 1 1 0 0
point 55 1 1 0 0
point 56 1 1 0 0
point 57 1 1 0 0
point 58 1 1 0 0
point 59 1 1 0 0
point 60 1 1 0 0
point 61 1 1 0 0
point 62 1 1 0 0
point 63 1 1 0 0
point 64 1 1 0 0
point 65 1 1 0 0
point 66 1 1 0 0
point 67 1 1 0 0
point 68 1 1 0 0
point 69 1 1 0 0
point 70 1 1 0 0
point 71 1 1 0 0
point 72 1 1 0 0
point 73 1 1 0 0
point 74 1 1 0 0
point 75 1 1 0 0
point 76 1 1 0 0
point 77 1 1 0 0
point 78 1 1 0 0
point 79 1 1 0 0
point 80 1 1 0 0
point 81 1 1 0 0
point 82 1 1 0 0
point 83 1 1 0 0
point 84 1 1 0 0
point 85 1 1 0 0
point 86 1 1 0 0
point 87 1 1 0 0
point 88 1 1 0 0
point 89 1 1 0 0
point 90 1 1 0 0
point 91 1 1 0 0
point 92 1 1 0 0
point 93 1 1 0 0
point 94 1 1 0 0
point 95 1 1 0 0
point 96 1 1 0 0
point 97 1 1 0 0
point 98 1 1 0 0
point 99 1 1 0 0
point 100 1 1 0 0
}
}
}
data "742.004"
{
TABLE "VectorStar.4000.0" "742.004"
{
element 0 "Use User Sweep" "No"
element 0 "Hold Time (sec)" " 0.000 "
element 0 "Delay Time (sec)" " 0.000 "
element 0 "Sweep Time (sec) [0=auto]" " 0.000 "
element 0 "Port Power Coupled [Y/N]" "No"
element 0 "Port 1 Power (dBm)" "-20.00 "
element 0 "Port 1 High Band Power (dBm)" "-30.00 "
element 0 "Port(s) 1 (1,2) Source Atten (dB)" " 0.000 "
element 0 "Port(s) 1 (1,2) Test Atten (dB)" " 0.000 "
element 0 "Port 1 Power Slope (dB/GHz)" " 0.000 "
element 0 "Port 2 Power (dBm)" "-10.00 "
element 0 "Port 2 High Band Power (dBm)" "-20.00 "
element 0 "Port(s) 2 (3,4) Source Atten (dB)" " 0.000 "
element 0 "Port(s) 2 (3,4) Test Atten (dB)" " 0.000 "
element 0 "Port 2 Power Slope (dB/GHz)" " 0.000 "
element 0 "Port 3 Power (dBm)" "-20.00 "
element 0 "Port 3 High Band Power (dBm)" "-30.00 "
element 0 "Port 3 Power Slope (dB/GHz)" " 0.000 "
element 0 "Port 4 Power (dBm)" "-10.00 "
element 0 "Port 4 High Band Power (dBm)" "-20.00 "
element 0 "Port 4 Power Slope (dB/GHz)" " 0.000 "
element 0 "IF Bandwidth (Hz)" " 1.000K"
element 0 "Avg Factor[1-1024]" "1"
element 0 "Avg Mode[per (P)oint/per (S)weep]" "P"
element 0 "Use VNA Calibration Settings" "No"
element 0 "Port(s) of Interest" ""
element 0 "Cal Type[(H)ardware/(N)one]" "H"
element 0 "Cal File Name" ""
element 0 "Delay For Timeouts (sec)" " 0.000 "
element 0 "Init Command" ""
}
TABLE "KeysightB1505.4000.21" "742.004"
{
View par_var_table 0 "V530 C58 C10"
element 0 "Use User Sweep" "No"
element 0 "Hold Time" " 0.000 "
element 0 "Delay Time" " 0.000 "
element 0 "Integ Time" "S"
element 0 "Power Compliance" " 0.000 "
element 0 "SMU Filters ON" "No"
element 0 "CMU Meas Freq" " 1.000MEG"
element 0 "CMU Osc Level" " 10.00m"
element 0 "CMU Avr. Factor (Integ Time = L)" "16"
element 0 "Correction ON" "Yes"
element 0 "Sampling Mode" "No"
element 0 "Sampling Output Mode" "Sim"
element 0 "Sequential Sampling Unit" ""
element 0 "Sampling Base Hold Time" " 0.000 "
element 0 "Sampling Bias Hold Time" " 0.000 "
element 0 "Binary Search Measurement" "No"
element 0 "Binary Search Source Control Mode" "0,1,1"
element 0 "Binary Search Condition" "0,0.001"
element 0 "Range Manager Mode" "1"
element 0 "Range Manager Setting" "90"
element 0 "Using Module Selector" "No"
element 0 "Module Selector Inputs" ""
element 0 "Module Selector Output" ""
element 0 "Enable Series Resistor for HVSMU" "No"
element 0 "Pulse Unit" ""
element 0 "Pulse Base" " 0.000 "
element 0 "Pulse Width" " 1.000m"
element 0 "Pulse Delay" " 0.000 "
element 0 "Pulse Period (common)" " 10.00m"
element 0 "Pulse 2 Unit" ""
element 0 "Pulse 2 Base" " 0.000 "
element 0 "Pulse 2 Width" " 1.000m"
element 0 "Pulse 2 Delay" " 0.000 "
element 0 "Enable Dual HCSMU" "No"
element 0 "DHCSMU Master Unit" ""
element 0 "DHCSMU Slave Unit" ""
element 0 "Enable UHC Expander" "No"
element 0 "UHC Expander Enable UHC Unit" "No"
element 0 "UHC Expander V-Control Unit" ""
element 0 "UHC Expander I-Control Unit" ""
element 0 "UHC Expander Output Voltage Compliance for UHC Unit" " 60.00 "
element 0 "UHC Expander Enable Selector" "No"
element 0 "UHC Expander SMU Input" ""
element 0 "UHC Expander HVSMU Input" ""
element 0 "UHC Expander Output" ""
element 0 "UHC Expander Enable Series Resistor for HVSMU" "No"
element 0 "UHC Expander Enable Gate Control" "No"
element 0 "UHC Expander Gate Control Unit" ""
element 0 "UHC Expander Gate Control Resistance" "0"
element 0 "Enable HVSMU Current Expander" "No"
element 0 "HVSMU Current Expander HVSMU Input" ""
element 0 "HVSMU Current Expander V-Control Unit" ""
element 0 "HVSMU Current Expander I-Control Unit" ""
element 0 "HVSMU Current Expander Output Voltage Compliance for HVMCU" " 2.200K"
element 0 "HVSMU Current Expander Output" ""
element 0 "HVSMU Current Expander Enable Series Resistor for HVSMU" "No"
element 0 "Enable UHV Expander" "No"
element 0 "UHV Expander V-Control Unit" ""
element 0 "UHV Expander I-Control Unit" ""
element 0 "UHV Expander Output Voltage Compliance for UHV Unit" " 10.00K"
element 0 "Disable Self-cal" "No"
element 0 "Output I/O Port (ERC Command)" ""
element 0 "Output I/O Port (ERM Command)" ""
element 0 "Format Parameter (FMT Command)" "4"
element 0 "Delay for timeouts" " 0.000 "
element 0 "Init Command" ""
}
}
}
LINK DAT "SENTIO" "742.004"
{
View in_out 1 "0.83678463855422 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 1 "V530 P28 C10 C10 C10"
element 0 "Name" "Prober"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "GPIB0::INTFC"
element 5 "Name" "hpib_addr"
element 5 "Value" "28"
element 6 "Name" "current_x"
element 6 "Value" "12250.0"
element 7 "Name" "current_y"
element 7 "Value" "0,0,12250.0"
element 8 "Name" "___for_alignment"
element 8 "Value" ""
element 9 "Name" "last_temperature"
element 9 "Value" "-1000"
element 10 "Name" "curr_temperature"
element 10 "Value" "-1000"
element 11 "Name" "_____________1"
element 11 "Value" ""
element 12 "Name" "Reticle"
element 12 "Value" ""
element 13 "Name" "ProberCoordinates"
element 13 "Value" "X-Right, Y-Up"
element 14 "Name" "WaferSize"
element 14 "Value" "200"
element 15 "Name" "DieSizeUnit"
element 15 "Value" "um"
element 16 "Name" "DieSizeX"
element 16 "Value" "10000"
element 17 "Name" "DieSizeY"
element 17 "Value" "10000"
element 18 "Name" "DieX"
element 18 "Value" ""
element 19 "Name" "DieY"
element 19 "Value" ""
element 20 "Name" "GridShiftX"
element 20 "Value" "-0"
element 21 "Name" "GridShiftY"
element 21 "Value" "-0"
element 22 "Name" "OriginDieX"
element 22 "Value" ""
element 23 "Name" "OriginDieY"
element 23 "Value" ""
element 24 "Name" "IncludePartialDies"
element 24 "Value" ""
element 25 "Name" "WaferEdgeArea"
element 25 "Value" "2"
element 26 "Name" "StreetSizeX"
element 26 "Value" ""
element 27 "Name" "StreetSizeY"
element 27 "Value" ""
element 28 "Name" "HomeDie"
element 28 "Value" ""
element 29 "Name" "DieMapRef"
element 29 "Value" ""
element 30 "Name" "OriMkPos"
element 30 "Value" "Marker Bottom"
element 31 "Name" "OriMkType"
element 31 "Value" "Notch"
element 32 "Name" "FlatLength"
element 32 "Value" "50"
element 33 "Name" "FirstDieLoc"
element 33 "Value" ""
element 34 "Name" "DieIDNumDirection"
element 34 "Value" ""
element 35 "Name" "AlternateDieIDNum"
element 35 "Value" ""
element 36 "Name" "_____________2"
element 36 "Value" ""
element 37 "Name" "PBresult"
element 37 "Value" "0,0,OK"
element 38 "Name" "SubString"
element 38 "Value" ","
element 39 "Name" "_____________3"
element 39 "Value" ""
element 40 "Name" "SENTIOResult"
element 40 "Value" "0,0,-1,1,1"
element 41 "Name" "SENTIOReture1"
element 41 "Value" "0"
element 42 "Name" "SENTIOReture2"
element 42 "Value" "0"
element 43 "Name" "SENTIOReture3"
element 43 "Value" "-1"
element 44 "Name" "SENTIOReture4"
element 44 "Value" "1"
element 45 "Name" "SENTIOReture5"
element 45 "Value" "1"
element 46 "Name" "SENTIOReture6"
element 46 "Value" "0,0,-1,1,1"
element 47 "Name" "current_z"
element 47 "Value" "12250.0"
element 48 "Name" "SENTIOReture7"
element 48 "Value" "0,0,-1,1,1"
element 49 "Name" "Subsite_index"
element 49 "Value" "0"
element 50 "Name" "next_load_wafer_slot"
element 50 "Value" "2"
element 51 "Name" "pre_aligner_angle"
element 51 "Value" "0"
element 52 "Name" "Debug"
element 52 "Value" "1"
element 53 "Name" "hpib_timeout"
element 53 "Value" "180"
element 54 "Name" "next_load_wafer_station"
element 54 "Value" "cas2"
element 55 "Name" "next_preload_wafer_slot"
element 55 "Value" "2"
element 56 "Name" "curRow"
element 56 "Value" "2"
element 57 "Name" "curColumn"
element 57 "Value" "0"
element 58 "Name" "targetRow"
element 58 "Value" "1"
element 59 "Name" "targetColumn"
element 59 "Value" "-1"
element 60 "Name" ""
element 60 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" "LINPUT_TABLE"
element 0 "Value" "TL|FV=T:OR=VE:TO=FW&FH&TT&TL|<none>|#211UPPER_TABLE:#211LOWER_TABLE:#19Separator:#12ok|0|0"
element 1 "Name" "LINPUT_TABLE.UPPER_TABLE"
element 1 "Value" "TL|OR=HO|<none>|#14TEXT|1"
element 2 "Name" "LINPUT_TABLE.LOWER_TABLE"
element 2 "Value" "TL|NC=3:OR=HO|<none>|#16LABEL1:#19VARIABLE1:#16LABEL2:#19VARIABLE2:#16LABEL3:#19VARIABLE3|1"
element 3 "Name" "LINPUT_TABLE.UPPER_TABLE.TEXT"
element 3 "Value" "LA|CA=#3161Enter the die position\134\060\061\062relative to Home,\134\060\061\062then hit 'Move Prober'\134\060\061\062\134\060\061\062NOTE\072 Home is 0, 0\134\060\061\062\134\060\061\062NOTE\072 for no subsites, \134\060\061\062enter 0 to SUBSITE NUMBER:FG=C6|<none>|<none>|0"
element 4 "Name" "LINPUT_TABLE.LOWER_TABLE.LABEL1"
element 4 "Value" "LA|CA=#217COLUMN NUMBER\072|<none>|<none>|0"
element 5 "Name" "LINPUT_TABLE.LOWER_TABLE.VARIABLE1"
element 5 "Value" "ED|BG=C9:CO=8:VA=%#213column_number|<none>|<none>|0"
element 6 "Name" "LINPUT_TABLE.LOWER_TABLE.LABEL2"
element 6 "Value" "LA|CA=#214ROW NUMBER\072|<none>|<none>|0"
element 7 "Name" "LINPUT_TABLE.LOWER_TABLE.LABEL3"
element 7 "Value" "LA|CA=#218SUBSITE NUMBER\072|<none>|<none>|0"
element 8 "Name" "LINPUT_TABLE.LOWER_TABLE.VARIABLE2"
element 8 "Value" "ED|BG=C9:CO=8:VA=%#210row_number|<none>|<none>|0"
element 9 "Name" "LINPUT_TABLE.LOWER_TABLE.VARIABLE3"
element 9 "Value" "ED|BG=C9:CO=8:VA=%#214subsite_number|<none>|<none>|0"
element 10 "Name" "LINPUT_TABLE.Separator"
element 10 "Value" "SE|<none>|<none>|<none>|0"
element 11 "Name" "LINPUT_TABLE.ok"
element 11 "Value" "PB|CA=#211Move Prober|AC=#223step2die_by_user_action&#17Execute|<none>|0"
element 12 "Name" ""
element 12 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 1 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 ! Nomber 4, 2020  
 ! www.mpi.com.tw/ast
 
 ! Driver for TS2000/TS2000-SE/TS2500/TS3000/TS3000-SE/TS3500/TS3500-SE serial probes
 
 !Transform 'test_Conn2Prober' should be used first 
 !to check the connection to the prober.
 !The 'test_Conn2Prober' function will turn ON/OFF the Scope light
 
 !Please select the command set "SENTIO" in Setup page of SENTIO software
 
 !Prober Properites Options
 !Prober Machine Coordnates          : X-Right, Y-Up
 !Go Home Before Die Move            : No
 !Go to Reference When Die Change    : No
 !Wafer Map Coordates in Sync        : Yes
 !Subsite Move Mode                  : Relative
 
 ! IMPORTANT:
 ! ===================
 ! On the MPI-SENTIO-PC, the SENTIO GPIB interface program must be selected and enable. 
 ! Please open the "C:\ProgramData\MPI Corporation\Sentio\config.xml" in PC of SENTIO executing
 ! CHECK the setting is correct 
 !
 ! <RemoteServer Type="GPIB" Config="GPIB0:13:NI" />
 ! The default setting of GPIB Address of Prober is "13"
 ! After SENTIO version 3.3.0, SENTIO support setting the communication interface in Setup page.
 ! Please also checking the setting of "Variable" in Setup Variables tab.
 ! the "hpib_interface" is "gpib0" (if there have one gpib communication with IC-CAP/WaferProE) and "hpib_addr" is "13"
 
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface     ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr          ! Prober Address, e.g. 13
 GLOBAL_VAR  last_temperature   ! when 'align' is possible, we need to know the delta(temp) to decide between full alignment or alignment-lite
 GLOBAL_VAR  curr_temperature
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !---IMPORTANT NOTE:
 !---FOR THE WPro_lookup_info() LINE, REFERRED TO IN THE PEL CODE BELOW, THE FOLLOWING ENTRY TO $WAFERPRO_HOME\config\wproBenchList.cfg WAS MADE:
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !<SECTION Title="Bench7">
 !        <VAR Name = "myDemo_4142_4275"></VAR>
 !        <VAR SlotCount = "1000"></VAR>
 !        <VAR SMUCount = "4"></VAR>
 !        <VAR CVTisSupport = "FALSE"></VAR>
 !        <VAR ProberCoordinates = "X-Right, Y-Up"></VAR>
 !        <VAR GoHomeBeforeDieMove = "TRUE"></VAR>
 !        <TABLE Title="InstrumentPilot" Format="csv">
 !"Type",  "Name",  "Controller","Address","CmdSuffix","GROUND",      "SMU1","SMU2","SMU3","SMU4","CMHigh","CMLow","PinsCount"
 !"Matrix","E5250A","gpib0",     "18",     "\r",       "GNDUndefined","1",   "2",   "3",   "4",   "9",     "10",   "48"
 !"Prober","PA200", "gpib0",     "27",     "\r",       "",            "",    "",    "",    "",    "",      "",     ""
 !"Chuck", "Manual","None",      "None",   "\r",       "",            "",    "",    "",    "",    "",      "",     ""
 !        </TABLE>
 !</SECTION>
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF Debug >= 2 THEN GET_STRING "Performing SENTIO/Init   [OK]", dummy
 
 dummy = WPro_lookup_info("Hardware", "Prober[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Prober[Address]",    "hpib_addr")
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "start" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 IF Debug >= 2 THEN GET_STRING "Performing SENTIO/start   [OK]", dummy
 
 GET_STRING "Manually,
 -> load wafer,
 -> align wafer,
 -> position a die,
 -> set Home/Reference position
 -> verify the contact (Z-positioning),
 -> and switch off the light [OK]", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_reference" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_reference]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 bRet = 0
 ! Set current as Home position
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "set_chuck_site_pos")
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_wafer_map" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_wafer_map]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr       ! Prober Address, e.g. 27
 
 !Instrument Variables
 GLOBAL_VAR PBresult           ! used to save returned strings
 GLOBAL_VAR SubString          ! aux variable when prober answer is cut into sub-strings
 
 GLOBAL_VAR Reticle            ! "myReticle",
 GLOBAL_VAR ProberCoordinates  ! "X-Right, Y-Up", // Prober Wafer space coordinates, "X-Right, Y-Up"/"X-Right, Y-Down"/"X-Left, Y-Up"/"X-Left, Y-Down"
 GLOBAL_VAR WaferSize          ! 300.0,           // in (mm)
 GLOBAL_VAR DieSizeUnit        ! "um",            // "um"/"mm"
 GLOBAL_VAR DieSizeX           ! 20000.0,         //
 GLOBAL_VAR DieSizeY           ! 30000.0,         //
 GLOBAL_VAR GridShiftX         ! 0.0,             // shift (um) from the wafer-center crossing line (X-Right (on screen coordinates))
 GLOBAL_VAR GridShiftY         ! 0.0,             // shift (um) from the wafer-center crossing line (X-Down  (on screen coordinates))
 GLOBAL_VAR OriginDieX         ! 0,               // values in the 'universal' coordinates, which determine X0-Y0 location.
 GLOBAL_VAR OriginDieY         ! 0,               //     the initial 0/0 location is Top-Left (! screen coordinates)
 GLOBAL_VAR IncludePartialDies ! "No",            // "No" in Velox.
 GLOBAL_VAR WaferEdgeArea      ! 0.0,             // need to be set to determine partial/full dies in UnvWaferMap
 GLOBAL_VAR StreetSizeX        ! 0.0,             // not used in Velox, (no effect on prober control)
 GLOBAL_VAR StreetSizeY        ! 0.0,             // not used in Velox, (no effect on prober control)
 GLOBAL_VAR HomeDie            ! "X-1-Y2",        // in 'ProberCoordinates'
 GLOBAL_VAR DieMapRef          ! "TopLeft",       // "TopLeft"/"TopRight"/"BottomLeft"/"BottomRight"/"Center"/"Manual"
 GLOBAL_VAR OriMkPos           ! "Marker Bottom", // "Marker Bottom"/"Marker Right"/"Marker Top"/"Marker Left"
 GLOBAL_VAR OriMkType          ! "Notch",         // "Notch"/"Flat"
 GLOBAL_VAR FlatLength         ! 120.0,
 GLOBAL_VAR FirstDieLoc        ! "Upper Left",    // corresponds to Router setting in Velox, "Upper Left"/"Upper Right"/"Lower Left"/"Lower Right"
 GLOBAL_VAR DieIDNumDirection  ! "Horizontal",    // corresponds to Router setting in Velox, "Horizontal"/"Vertical"
 GLOBAL_VAR AlternateDieIDNum  ! "Yes",           // corresponds to Router setting in Velox
 !GLOBAL_VAR IsRectangle       ! false            // true if rectangle, false if circular wafer
 GLOBAL_VAR GridShiftX         ! "GridShiftX",    // WaferMap Offect X
 GLOBAL_VAR GridShiftY         ! "GridShiftY",    // WaferMap Offect Y
 
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !---start of the program
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_diameter")   
 WaferSize = VAL$(SENTIOReture3) !the unit is mm
 print "WaferSize:"; WaferSize
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_index_size")  
 DieSizeUnit = "um"
 DieSizeX = VAL$(SENTIOReture3)
 DieSizeY = VAL$(SENTIOReture4)
 print "DieSizeX:"; DieSizeX
 print "DieSizeY:"; DieSizeY
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_flat_params")
 flatAngle_ = VAL(SENTIOReture3)  
 FlatLength = VAL$(SENTIOReture4/1000) ! unit: mm
 print "FlatLength:"; FlatLength
 
    OriMkPos = "Marker Bottom"
    IF flatAngle_ == 0 THEN
      OriMkPos = "Marker Bottom"
    ELSE IF flatAngle_ == 90 THEN
      OriMkPos = "Marker Left"
    ELSE IF flatAngle_ == 180 THEN
      OriMkPos = "Marker Top"
    ELSE IF flatAngle_ == 270 THEN
      OriMkPos = "Marker Right"
    END IF
 
    GridShiftX = 0.0
    GridShiftY = 0.0
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_grid_params")
 WaferEdgeArea   = VAL$(VAL(SENTIOReture7) // 1000)
 GridShiftX      = VAL$(-1 * VAL(SENTIOReture5))
 GridShiftY      = VAL$(-1 * VAL(SENTIOReture6))
 print "WaferEdgeArea:"; WaferEdgeArea
 print "GridShiftX:"; GridShiftX
 print "GridShiftY:"; GridShiftY
 !-----Get the ProberCoordinates ----
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_axis_orient")
 AxisOrient = VAL$(SENTIOReture3)
 print "AxisOrient:"; AxisOrient
 
    ProberCoordinates = "X-Right, Y-Up"
    IF VAL$(SENTIOReture3) == "DR" THEN
      ProberCoordinates = "X-Right, Y-Down"
    ELSE IF VAL$(SENTIOReture3) == "DL" THEN
      ProberCoordinates = "X-Left, Y-Down"
    ELSE IF VAL$(SENTIOReture3) == "UR" THEN
      ProberCoordinates = "X-Right, Y-Up"
    ELSE IF VAL$(SENTIOReture3) == "UL" THEN
      ProberCoordinates = "X-Left, Y-Up"
    END IF
 
 print ProberCoordinates
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_wafer_map" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_wafer_map]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr       ! Prober Address, e.g. 13
 
 !Instrument Variables
 GLOBAL_VAR PBresult           ! used to save returned strings
 GLOBAL_VAR SubString          ! aux variable when prober answer is cut into sub-strings
 
 GLOBAL_VAR Reticle            ! "myReticle",
 GLOBAL_VAR ProberCoordinates  ! "X-Right, Y-Up", // Prober Wafer space coordinates, "X-Right, Y-Up"/"X-Right, Y-Down"/"X-Left, Y-Up"/"X-Left, Y-Down"
 GLOBAL_VAR WaferSize          ! 300.0,           // in (mm)
 GLOBAL_VAR DieSizeUnit        ! "um",            // "um"/"mm"
 GLOBAL_VAR DieSizeX           ! 20000.0,         //
 GLOBAL_VAR DieSizeY           ! 30000.0,         //
 GLOBAL_VAR GridShiftX         ! 0.0,             // shift (um) from the wafer-center crossing line (X-Right (on screen coordinates))
 GLOBAL_VAR GridShiftY         ! 0.0,             // shift (um) from the wafer-center crossing line (X-Down  (on screen coordinates))
 GLOBAL_VAR OriginDieX         ! 0,               // values in the 'universal' coordinates, which determine X0-Y0 location.
 GLOBAL_VAR OriginDieY         ! 0,               //     the initial 0/0 location is Top-Left (! screen coordinates)
 GLOBAL_VAR IncludePartialDies ! "No",            // "No" in Velox.
 GLOBAL_VAR WaferEdgeArea      ! 0.0,             // need to be set to determine partial/full dies in UnvWaferMap
 GLOBAL_VAR StreetSizeX        ! 0.0,             // not used in Velox, (no effect on prober control)
 GLOBAL_VAR StreetSizeY        ! 0.0,             // not used in Velox, (no effect on prober control)
 GLOBAL_VAR HomeDie            ! "X-1-Y2",        // in 'ProberCoordinates'
 GLOBAL_VAR DieMapRef          ! "TopLeft",       // "TopLeft"/"TopRight"/"BottomLeft"/"BottomRight"/"Center"/"Manual"
 GLOBAL_VAR OriMkPos           ! "Marker Bottom", // "Marker Bottom"/"Marker Right"/"Marker Top"/"Marker Left"
 GLOBAL_VAR OriMkType          ! "Notch",         // "Notch"/"Flat"
 GLOBAL_VAR FlatLength         ! 120.0,
 GLOBAL_VAR FirstDieLoc        ! "Upper Left",    // corresponds to Router setting in Velox, "Upper Left"/"Upper Right"/"Lower Left"/"Lower Right"
 GLOBAL_VAR DieIDNumDirection  ! "Horizontal",    // corresponds to Router setting in Velox, "Horizontal"/"Vertical"
 GLOBAL_VAR AlternateDieIDNum  ! "Yes",           // corresponds to Router setting in Velox
 !GLOBAL_VAR IsRectangle        ! false            // true if rectangle, false if circular wafer
 
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !---start of the program
 
 ! DieSizeUnit == "um"
 dieSizeX_ = val(DieSizeX)  ! [um]
 dieSizeY_ = val(DieSizeY)  ! [um]
 IF VAL$(DieSizeUnit) == "mm" THEN
   dieSizeX_ = val(DieSizeX)*1000  ! [um]
   dieSizeY_ = val(DieSizeY)*1000  ! [um]
 END IF
 offsetX_ = 0.0
 offsetY_ = 0.0
 
 flatAngle_ = 0
 IF VAL$(OriMkPos) == "Marker Bottom" THEN
   flatAngle_ = 0
 ELSE IF VAL$(OriMkPos) == "Marker Right" THEN
   flatAngle_ = 90
 ELSE IF VAL$(OriMkPos) == "Marker Top" THEN
   flatAngle_ = 180
 ELSE IF VAL$(OriMkPos) == "Marker Left" THEN
   flatAngle_ = 270
 END IF
 
 ! SENTIO Wafer setting
 ! "map:set_diameter "& VAL$(WaferSize)
 ! "map:set_index_size "& VAL$(dieSizeX_) & "," & VAL$(dieSizeY_)
 ! "map:set_orient_marker Flat" & "," & VAL$(flatAngle_) & "," &  VAL$(FlatLength)
 ! "map:set_grid_params" & VAL$(dieSizeX_) & "," & VAL$(dieSizeY_) & "," & VAL$(offsetX_) & "," & VAL$(offsetY_)& "," & VAL$(WaferEdgeArea)
 
 !--------Wafer Size----------
 !Set the wafer map parameters.
 !set_wafer_params_cmd = "SetWaferMapParams " & VAL$(WaferSize) & " " & VAL$(dieSizeX_) & " " & VAL$(dieSizeY_) & " " & VAL$(FlatLength) & " " & VAL$(flatAngle_) & " " & VAL$(offsetX_) & " " & VAL$(offsetY_) & " " & VAL$(WaferEdgeArea)
 wafer=CUTSTR(VAL$(WaferSize), SubString, ".")
 print SubString[0]
 set_wafer_params_cmd = "map:set_diameter "& VAL$(SubString[0])
 ! format : int
 
 !---communicate with the prober
 hpib_num = HPIB_open(VAL$(hpib_interface))
 IF VAL$(hpib_num) == VAL$("-1") THEN
   ! Error failed to open a GPIB interface connection. Return with ready state error. 
   bRet = 0
   ErrorMsg = "Failed to open a connection to the GPIB interface: " & VAL$(hpib_interface)
   RETURN_VALUE bRet
 ENDIF
 
 !Set the wafer map parameters.
 PRINT "-------------------------"
 PRINT "<<<" & set_wafer_params_cmd
 status = HPIB_write(hpib_num, hpib_addr, VAL$(set_wafer_params_cmd))
 status = HPIB_timeout(hpib_num, 100)
 status = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")
 
 !-------Index Size---------
 set_wafer_params_cmd = "map:set_index_size "& VAL$(dieSizeX_) & "," & VAL$(dieSizeY_)
 PRINT "-------------------------"
 PRINT "<<<" & set_wafer_params_cmd
 
 !Set the wafer map parameters.
 PRINT "<<<" & set_wafer_params_cmd
 status = HPIB_write(hpib_num, hpib_addr, VAL$(set_wafer_params_cmd))
 status = HPIB_timeout(hpib_num, 100)
 status = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")
 
 !------------Flat / Notch---------
 wafer=CUTSTR(VAL$(FlatLength), SubString, ".")
 print "FlatAngle:"; flatAngle_
 print "FlatValue:"; SubString[0]
 
 IF (SubString[0] >= 10) THEN
     ErrorMsg = "The number of Flat must be < 10 mm."
     x = system$("echo 'Error: "&VAL$(ErrorMsg)&"' >&2")
     SubString[0] = 10
 END IF
 
 set_wafer_params_cmd = "map:set_orient_marker Flat" & "," & VAL$(flatAngle_) & "," &  VAL$(VAL(SubString[0])*1000)
 
 !Set the wafer map parameters.
 PRINT "<<<" & set_wafer_params_cmd
 status = HPIB_write(hpib_num, hpib_addr, VAL$(set_wafer_params_cmd))
 status = HPIB_timeout(hpib_num, 100)
 status = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")
 
 !-------Grid Size------------------
 
 set_wafer_params_cmd = "map:set_grid_params " & VAL$(dieSizeX_) & "," & VAL$(dieSizeY_) & "," & VAL$(offsetX_) & "," & VAL$(offsetY_)
 
 !Set the wafer map parameters.
 PRINT "<<<" & set_wafer_params_cmd
 status = HPIB_write(hpib_num, hpib_addr, VAL$(set_wafer_params_cmd))
 status = HPIB_timeout(hpib_num, 100)
 status = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 orientation_ = "UR"
 IF VAL$(ProberCoordinates) == "X-Right, Y-Down" THEN
 !  orientation_ = 1
     orientation_ = "DR"
 ELSE IF VAL$(ProberCoordinates) == "X-Left, Y-Down" THEN
 !  orientation_ = 2
     orientation_ = "DL"
 ELSE IF VAL$(ProberCoordinates) == "X-Right, Y-Up" THEN
 !  orientation_ = 3
     orientation_ = "UR"
 ELSE IF VAL$(ProberCoordinates) == "X-Left, Y-Up" THEN
 !  orientation_ = 4
     orientation_ = "UL"
 END IF
 
 
 set_wafer_orientation_cmd = "map:set_axis_orient " & orientation_
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---communicate with the prober
 PRINT "<<<" & set_wafer_orientation_cmd
 
 !Set the wafer map orientation.
 status = HPIB_write(hpib_num, hpib_addr, VAL$(set_wafer_orientation_cmd))
 status = HPIB_timeout(hpib_num, 100)
 status = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 dummy  = HPIB_close(hpib_num)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "load_next" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 !-----------------------------------------------------------
 ! Condition with 'Load next command'
 ! 1. System has 'Wafer align pattern'
 ! 2. System has 'Home pattern'
 !-----------------------------------------------------------
 
 UPDATE_EXPLICIT
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 IF Debug >= 1 THEN PRINT ">>> Testing with Load Next Wafer "
 
 bRet = 1
 ErrorMsg = ""
 !------------
 LINPUT "Enter Load Wafer Slot", next_load_wafer_slot, next_load_wafer_slot
 LINPUT "Enter Preload Wafer Slot (enter '0' or '' for no preloading)", next_preload_wafer_slot, next_preload_wafer_slot
 
 next_load_wafer_slot   =VAL(VAL$(next_load_wafer_slot))
 next_preload_wafer_slot=VAL(VAL$(next_preload_wafer_slot))
 
 !--Checking the wafer existing on Chuck--
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "loader:scan_station chuck")
 
 IF VAL$(SENTIOReture3) == "0" THEN ! No Wafer on Chuck
     IF Debug >= 1 THEN PRINT ">>> No wafer on Chuck "
 ELSE
     ICCAP_FUNC("do_SENTIO_cmd", "Execute", "loader:unload_wafer")
 ENDIF
 
 !--PreAligner angle = 0--!
 preload_wafer_slot = 0
 next_preAligner_wafer_angle = 0
 
 
 ! -Load next
 !---TS3500/SE--
 hpib_cmd     = "loader:load_wafer ww,"&VAL$(next_load_wafer_slot)&","&VAL$(next_preAligner_wafer_angle)
 
 !---TS2500--
 !--Casette1
 !hpib_cmd     = "loader:load_wafer cas1"&","&VAL$(next_load_wafer_slot)&","&VAL$(next_preAligner_wafer_angle)
 !--Casette2
 !hpib_cmd     = "loader:load_wafer cas2"&","&VAL$(next_load_wafer_slot)&","&VAL$(next_preAligner_wafer_angle)
 
 ICCAP_FUNC("do_SENTIO_cmd","Execute",hpib_cmd)
 
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 ! After loading new wafer, execute wafer align
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:align_wafer")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 ! After wafer align finish, start execute "Find_Home"
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:find_home")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "align" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 bRet = 0
 !---do wafer align with current align pattern
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:align_wafer")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 !--- After wafer align, execute "find_home" function--!
 !--- System may not have "Home Pattern", it can be skip the error message--!
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:find_home")
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "go_home" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 !---no contact
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "move_chuck_separation")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 !---move to 0 0 (Home) position
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "move_chuck_home")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "contact" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- contact
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "move_chuck_contact")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "no_contact" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- separate
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "move_chuck_separation")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "needle_cleaning" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "aux:cleaning:start")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_index" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  curColumn
 GLOBAL_VAR  curRow
 GLOBAL_VAR  targetRow
 GLOBAL_VAR  targetColumn
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 Debug = 1
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---this is answered by the calling ProberMgr/move_index
 GET_STRING "Enter delta_index_x", delta_x
 GET_STRING "Enter delta_index_y", delta_y
 
 
 ICCAP_FUNC("no_contact", "Execute")
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:die:get_current_index")   !call macro and anticipate its GET_STRING
 
 curColumn = VAL$(SENTIOReture4)
 curRow = VAL$(SENTIOReture5)
 
 IF Debug >= 1 THEN 
     print "Current Column:"; val(curColumn)
     print "Current Row:"; val(curRow)
 END IF
 
 
 ICCAP_FUNC("get_axis_orient", "Execute")
 
 IF Debug >= 1 THEN 
     print "Probing Wafer MoveX:"; delta_x
     print "Probing Wafer MoveY:"; delta_y
 END IF
 
 l_delta_x =  delta_x
 l_delta_y =  delta_y
 
 !---Conver back to 'UR' coordinate---!
 IF VAL$(SENTIOReture3) == "DL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "DR" THEN
     l_delta_x =      val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y =      val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UR" THEN
     l_delta_x =  delta_x
     l_delta_y =  delta_y
 END IF
 
 
 IF Debug >= 1 THEN
     print "Orient:"; SENTIOReture3
     print "Chuck MoveX:" & VAL$(-1*VAL(l_delta_x))
     print "Chuck MoveY:" & VAL$(-1*VAL(l_delta_y))
 END IF
 
 targetColumn = 0
 targetRow = 0
 
 targetColumn = val(delta_x) + val(curColumn)
 targetRow = val(delta_y) + val(curRow)
 
 IF Debug >= 1 THEN 
     print "Target Column:"; val(targetColumn)
     print "Target Row:"; val(targetRow)
 END IF
 
 hpib_cmd="map:step_die " &VAL$(targetColumn) & "," &VAL$(targetRow)
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", VAL$(hpib_cmd))   !call macro and anticipate its GET_STRING
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_delta" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---this is answered by the calling ProberMgr/move_delta
 GET_STRING "Enter delta_x [um]", delta_x
 GET_STRING "Enter delta_y [um]", delta_y
 
 
 ICCAP_FUNC("no_contact", "Execute")
 
 
 ICCAP_FUNC("get_axis_orient", "Execute")
 
 IF Debug >= 1 THEN
     print "Probing Wafer MoveX:"; delta_x
     print "Probing Wafer MoveY:"; delta_y
 END IF
 
 l_delta_x =  delta_x
 l_delta_y =  delta_y
 
 IF VAL$(SENTIOReture3) == "DL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "DR" THEN
     l_delta_x =      val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y =      val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UR" THEN
     l_delta_x =  delta_x
     l_delta_y =  delta_y
 END IF
 
 IF Debug >= 1 THEN
     print "Orient:"; SENTIOReture3
     print "Chuck MoveX:" & VAL$(-1*VAL(l_delta_x))
     print "Chuck MoveY:" & VAL$(-1*VAL(l_delta_y))
 END IF
 
 ! convert a number into the format +xxx or -xxx
 ! cut-off digits after the comma and fill up with '0' between sign and resulting number
 delta_x = -1*VAL(l_delta_x)
 delta_y = -1*VAL(l_delta_y)
 
 delta_x = VAL$(delta_x, "%.0f")
 delta_y = VAL$(delta_y, "%.0f")
 
 IF Debug >= 1 THEN PRINT "  >delta_x="; delta_x, "delta_y="; delta_y
 
 !----- move relative
 
 hpib_cmd="move_chuck_xy " & " Relative" & "," &VAL$(delta_x) & "," &VAL$(delta_y)
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", VAL$(hpib_cmd))   !call macro and anticipate its GET_STRING
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "move_subs_pos" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~!
 GET_STRING "Enter delta_x [um]", delta_x
 GET_STRING "Enter delta_y [um]", delta_y
 
 ICCAP_FUNC("no_contact", "Execute")
 
 !---Get Current Die info--!
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:die:get_current_index")   !call macro and anticipate its GET_STRING
 
 curColumn = VAL$(SENTIOReture4)
 curRow = VAL$(SENTIOReture5)
 
 IF Debug >= 1 THEN
     print "Current Row:"; curRow
     print "Current Column:"; curColumn
 END IF
 
 !---Get orient --!
 ICCAP_FUNC("get_axis_orient", "Execute")
 
 IF Debug >= 1 THEN
     print "Probing Wafer MoveX:"; delta_x
     print "Probing Wafer MoveY:"; delta_y
 END IF
 
 l_delta_x =  delta_x
 l_delta_y =  delta_y
 
 IF VAL$(SENTIOReture3) == "DL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "DR" THEN
     l_delta_x =      val(delta_x)
     l_delta_y = -1 * val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UL" THEN
     l_delta_x = -1 * val(delta_x)
     l_delta_y =      val(delta_y)
 ELSE IF  VAL$(SENTIOReture3) == "UR" THEN
     l_delta_x =  delta_x
     l_delta_y =  delta_y
 END IF
 
 delta_x = -1*VAL(l_delta_x)
 delta_y = -1*VAL(l_delta_y)
 
 delta_x = VAL$(delta_x, "%.0f")
 delta_y = VAL$(delta_y, "%.0f")
 IF Debug >= 1 THEN
     print "Orient:"; SENTIOReture3
     print "Chuck MoveX:" & VAL$(-1*VAL(l_delta_x))
     print "Chuck MoveY:" & VAL$(-1*VAL(l_delta_y))
     print "Chuck MoveX_Machine:" & VAL$(delta_x)
     print "Chuck MoveY_Machine:" & VAL$(delta_y)
 END IF
 
 !----Step Die to current Pos Ref------!
 hpib_cmd="map:step_die " &VAL$(curColumn) & "," &VAL$(curRow)
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", VAL$(hpib_cmd))   !call macro and anticipate its GET_STRING
 
 !----Step Offset--!
 hpib_cmd="move_chuck_xy " & " Relative" & "," &VAL$(delta_x) & "," &VAL$(delta_y)
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", VAL$(hpib_cmd))   !call macro and anticipate its GET_STRING
 
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_position" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  SubString       ! aux variable when prober answer is cut into sub-strings
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  current_z
 
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "get_chuck_xy 0,zero")   !call macro and anticipate its GET_STRING
 
 current_x = VAL$(SENTIOReture3)
 current_y = VAL$(SENTIOReture4)
 
 IF Debug >= 1 THEN
     print "Probing current x:"; current_x
     print "Probing current y:"; current_y
 END IF
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "get_chuck_z")   !call macro and anticipate its GET_STRING
 !Reference height of Z Position is : Zero
 
 current_z = VAL$(SENTIOReture3)
 
 print "Probing current z:"; current_z
 
 ! reset the temp. array
 !DIMENSION_ARRAY("SubString", 0)
 
 
 IF Debug >= 1 THEN PRINT "act die position (rel.to home) is 
        x = ";current_x;" | y = ";current_y;" | z = ";current_z
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "unload_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [unload_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  SENTIOReture1   !SetupVariable
 GLOBAL_VAR  SENTIOReture2   !SetupVariable
 GLOBAL_VAR  SENTIOReture3   !SetupVariable
 GLOBAL_VAR  SENTIOReture4   !SetupVariable
 GLOBAL_VAR  SENTIOReture5   !SetupVariable
 
 bRet = 1
 ErrorMsg = ""
 !------------
 !--Unload wafer to original slot
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "loader:unload_wafer")
 IF VAL$(SENTIOReture1) > "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "do_SENTIO_cmd" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  PBresult         ! returned PBresult from the prober
 GLOBAL_VAR  hpib_interface   ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr        ! Prober Address, e.g. 27
 
 GLOBAL_VAR  SENTIOResult     ! SENTIO Response
 GLOBAL_VAR  SubString           ! SENTIO Response
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 !--------------------------------------------------
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 SENTIOResult = ""
 SubString = ""
 !---start of the program
 GET_STRING "Enter SENTIO command", "map:get_axis_orient", SENTIO_command
 IF Debug >= 1 THEN PRINT "  >sending prober command: ";SENTIO_command;" ..."
 
 
 !---communicate with the prober
 hpib_num = HPIB_open(VAL$(hpib_interface))
 IF VAL$(hpib_num) == VAL$("-1") THEN
   ! Error failed to open a GPIB interface connection. Return with ready state error. 
   bRet = 0
   ErrorMsg = "Failed to open a connection to the GPIB interface: " & VAL$(hpib_interface)
   RETURN_VALUE bRet
 ENDIF
 
 IF Debug >= 1 THEN
     print hpib_interface
     print "command:", SENTIO_command
     print hpib_num
     print hpib_addr
 END IF
 
 
 status   = HPIB_write(hpib_num, hpib_addr, VAL$(SENTIO_command))
 status   = HPIB_timeout(hpib_num, 180)  ! Wait max. 180 sec for reply (we set 100 for proper handshake).
                                         ! Important Note: the long time-out is also required for long executing prober commands such as 'align', large 'move_index' etc.)
 
 status   = HPIB_read(hpib_num, hpib_addr, 200, "A", "SENTIOResult")   ! read the big string into Setup Variable 'PBresult'
                      ! read all ('A')-ASCII bytes, max. 200 bytes (chars)
 dummy    = HPIB_close(hpib_num)
 
 result_len = 0
 
 result_len = STRLEN(VAL$(SENTIOResult))
 
 i = 1
 a = 0
 COMPLEX index[7]
 
 SENTIOResult = trim$(VAL$(SENTIOResult))
 
 while (i < val(result_len))
     SubString = substr$(VAL$(SENTIOResult), i, i)
 
     IF STRPOS(VAL$(SubString), ",")==1 THEN 
         index[a] = i
         a = a + 1
     END IF
 
     i = i+1
 endwhile
 
 IF Debug >= 1 THEN print "Response:", SENTIOResult
 
 if index[0] <> 0 THEN
     SENTIOReture1 = substr$(VAL$(SENTIOResult),1, val(index[0])-1)
 !    print "SENTIOReture1:",SENTIOReture1
 END IF
 
 if index[1] <> 0 THEN
     SENTIOReture2 = substr$(VAL$(SENTIOResult),val(index[0])+1, val(index[1])-1)
 !    print "SENTIOReture2:",SENTIOReture2
 END IF
 
 if index[2] <> 0 THEN
     SENTIOReture3 = substr$(VAL$(SENTIOResult),val(index[1])+1, val(index[2])-1)
 !    print "SENTIOReture3:",SENTIOReture3
 END IF
 
 if index[2] == 0 THEN
     SENTIOReture3 = substr$(VAL$(SENTIOResult),val(index[1])+1, result_len)
 !    print "SENTIOReture3-1:",SENTIOReture3
 END IF
 
 if index[3] <> 0 THEN
     SENTIOReture4 = substr$(VAL$(SENTIOResult),val(index[2])+1, val(index[3])-1)
 !    print "SENTIOReture4:",SENTIOReture4
 END IF
 
 if index[3] == 0 THEN
     SENTIOReture4 = substr$(VAL$(SENTIOResult),val(index[2])+1, result_len)
 !    print "SENTIOReture4-1:",SENTIOReture4
 END IF
 
 if index[4] <> 0 THEN
     SENTIOReture5 = substr$(VAL$(SENTIOResult),val(index[3])+1, val(index[4])-1)
 !    print "SENTIOReture5:",SENTIOReture5
 END IF
 
 if index[4] == 0 THEN
     SENTIOReture5 = substr$(VAL$(SENTIOResult),val(index[3])+1, result_len)
 !    print "SENTIOReture6-1:",SENTIOReture5
 END IF
 
 if index[5] <> 0 THEN
     SENTIOReture6 = substr$(VAL$(SENTIOResult),val(index[4])+1, val(index[5])-1)
 !    print "SENTIOReture6:",SENTIOReture6
 END IF
 
 if index[5] == 0 THEN
     SENTIOReture6 = substr$(VAL$(SENTIOResult),val(index[4])+1, result_len)
 !    print "SENTIOReture6-1:",SENTIOReture6
 END IF
 
 if index[6] == 0 THEN
     SENTIOReture7 = substr$(VAL$(SENTIOResult),val(index[5])+1, result_len)
 !    print "SENTIOReture7:",SENTIOReture7
 END IF
 !--------------------------------------------
 
 IF SENTIOReture1 == 0 THEN
     RETURN_VALUE 1   !command performed without errors
 END IF
 
 IF SENTIOReture1 == 1024 THEN
 !Last die
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 !    print SENTIOReture3
     RETURN_VALUE 1   !command performed without errors
 END IF
 
 IF SENTIOReture1 == 2048 THEN
 !Last subsite
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 !    print SENTIOReture3
     RETURN_VALUE 1   !command performed without errors
 END IF
 
 IF SENTIOReture1 == 1 THEN
 !Internal Error
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 2 THEN
 !Execution Error
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 3 THEN
 !CommandHandlerNotFound
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 4 THEN
 !InvalidCommand
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 5 THEN
 !InvalidCommandFormat
     bRet = 0
 !   print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 6 THEN
 !InvalidParameter
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 7 THEN
 !InvalidNumberofParameter
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 8 THEN
 !ArgumentOutofBounds
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 9 THEN
 !FileNotFound
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 10 THEN
 !InvalidFileFormat
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 11 THEN
 !EndofRoute
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 IF SENTIOReture1 == 12 THEN
 !InvalidOperation
     bRet = 0
 !    print SENTIOReture3
     ErrorMsg = "ERROR AT PROBER: "&VAL$(SENTIOReture3)
 END IF
 
 
 RETURN_VALUE bRet
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_axis_orient" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_axis_orient")   !call macro and anticipate its GET_STRING
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "light_on" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !--- Light ON
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:switch_light Scope,1")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) >= "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "light_off" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !--- Light OFF
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "vis:switch_light Scope,0")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) >= "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "next_die" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !--- next_die
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:step_next_die")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) >= "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 current_x = VAL$(SENTIOReture3)
 current_y = VAL$(SENTIOReture4)
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "next_subsite" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  Subsite_index
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !--- next_die
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:subsite:step_next")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) >= "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 current_x = VAL$(SENTIOReture3)
 current_y = VAL$(SENTIOReture4)
 Subsite_index = VAL$(SENTIOReture5)
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "first_die" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 GLOBAL_VAR  current_x
 GLOBAL_VAR  current_y
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !--- First die
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:step_first_die")   !call macro and anticipate its GET_STRING
 IF VAL$(SENTIOReture1) >= "0" THEN
   bRet = 0
   ErrorMsg = VAL$(SENTIOReture3)
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "____Testing____" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "INIT_PROBER" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 PRINT "> running macro INIT_PROBER..."
 
 GET_STRING "manually,
 	load wafer,
 	load probe plan,
 	define home position,
 	align wafer,
 	verify the contact,
 	switch off the light","ok",dummy
 
 
 ICCAP_FUNC("light_on", "Execute")
 ICCAP_FUNC("go_home", "Execute")
 ICCAP_FUNC("first_die", "Execute")
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "STEP_PROBER" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 PRINT "> running macro STEPPING_PROBER..."
 
     ICCAP_FUNC("light_on", "Execute")
     ICCAP_FUNC("next_die", "Execute")
     ICCAP_FUNC("contact", "Execute")
     ICCAP_FUNC("light_off", "Execute")
     !iccap_func(".","Measure")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "FINISH_PROBER" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 ICCAP_FUNC("no_contact", "Execute")
 ICCAP_FUNC("light_on", "Execute")
 ICCAP_FUNC("go_home", "Execute")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Test_Connect2Prober" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface   ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr        ! Prober Address, e.g. 13
 GLOBAL_VAR  SENTIOResult     ! SENTIO Response
 !--------------------------------------------------
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "hpib interface is actually","gpib0",hpib_interface
 
 GET_STRING "prober address is actually","13",hpib_addr
 
 !---communicate with the prober
 hpib_num = HPIB_open(VAL$(hpib_interface))
 IF VAL$(hpib_num) == VAL$("-1") THEN
   ! Error failed to open a GPIB interface connection. Return with ready state error. 
   bRet = 0
   ErrorMsg = "Failed to open a connection to the GPIB interface: " & VAL$(hpib_interface)
   RETURN_VALUE bRet
 ENDIF
 
 print hpib_num
 print hpib_addr
 
 command$=""
 
 WHILE command$<>"exit" 
   GET_STRING " enter 
         ON    for Scope Light ON
         OFF   for Scope Light OFF
         exit   for exiting this loop",command$
 
   IF command$=="ON" OR command$=="on" THEN 
     status   = HPIB_write(hpib_num,hpib_addr,"vis:switch_light Scope,1")
     status   = HPIB_read(hpib_num, hpib_addr, 200, "A", "SENTIOResult")
     IF VAL$(SENTIOResult)<>"0,0,OK" THEN GET_STRING "ERROR AT PROBER",SENTIOResult,dummy
   ENDIF
 
   IF command$=="OFF" OR command$=="off" THEN 
     status   = HPIB_write(hpib_num,hpib_addr,"vis:switch_light Scope,0")
     status   = HPIB_read(hpib_num, hpib_addr, 200, "A", "SENTIOResult")
     IF VAL$(SENTIOResult)<>"0,0,OK" THEN GET_STRING "ERROR AT PROBER",SENTIOResult,dummy
 
   ENDIF
 
 END WHILE
 
 
 dummy=HPIB_close(hpib_num)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "LoopTest" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 PRINT "> running macro STEPPING_PROBER..."
 
 GLOBAL_VAR  SENTIOReture1
 GLOBAL_VAR  SENTIOReture2
 GLOBAL_VAR  SENTIOReture3
 GLOBAL_VAR  SENTIOReture4
 GLOBAL_VAR  SENTIOReture5
 GLOBAL_VAR  SENTIOReture6
 GLOBAL_VAR  SENTIOReture7
 
 !! Test 5 dies
 !ICCAP_FUNC("go_home", "Execute")
 !ICCAP_FUNC("first_die", "Execute")
 
 !test_die =1
 !WHILE test_die < 50
 !    print "test_die:", test_die
 !    ICCAP_FUNC("light_on", "Execute")
 !    ICCAP_FUNC("next_die", "Execute")
 !    ICCAP_FUNC("light_off", "Execute")
     !iccap_func(".","Measure")
 !    REtVal=WAIT(2)
 !    test_die = test_die+1
 !END WHILE
 !ICCAP_FUNC("light_on", "Execute")
 
 ICCAP_FUNC("do_SENTIO_cmd", "Execute", "map:get_grid_params")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
}
LINK DUT "Matrix" "742.004"
{
View tree_dut 1 "0"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P15 C15 C15 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "742.004"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "MatrixMgr" "742.004"
{
View in_out 0 "0.45231602084012 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P13 C15 C15 C10"
element 0 "Name" "Matrix"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "None"
element 5 "Name" "scanner_addr"
element 5 "Value" "None"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" ""
element 8 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! MatrixMgr is called by WaferPro for a matrix action.
 ! It then requests from Wafer which matrix to address,
 ! and redirects the requested action to the Setup of
 ! the requested matrix.
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Matrix          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Name]", "Matrix")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 IF VAL$(Matrix)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Matrix Defined for this Bench","Y")
   bRet = 1
   RETURN_VALUE bRet
 END IF
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Matrix is accessed","Y")
   END IF
   bRet = 1
   RETURN_VALUE bRet
 END IF
 !========================================
 
 MatrixDriver = "../" & VAL$(Matrix) & "/"
 MatrixCmd    = MatrixDriver & "Init"
 
 ICCAP_FUNC(MatrixCmd, "Execute")
 
 bRet = lookup_var(MatrixDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(MatrixDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Matrix          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Unit <SMU1>, <CM:HighPin>, <CM:LowPin>", "SMU1", Unit
 GET_STRING "Pin",                                    "1",    Pin
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Name]", "Matrix")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Matrix)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Matrix Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Matrix is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 MatrixDriver = "../" & VAL$(Matrix) & "/"
 MatrixCmd    = VAL$(MatrixDriver) & "connect"
 
 ICCAP_FUNC(VAL$(MatrixCmd), "Execute", VAL$(Unit), VAL$(Pin))
 
 bRet = lookup_var(MatrixDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(VAL$(MatrixDriver) & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Matrix          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Name]", "Matrix")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Matrix)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Matrix Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Matrix is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 MatrixDriver = "../" & VAL$(Matrix) & "/"
 MatrixCmd    = MatrixDriver & "disconnect_all"
 
 ICCAP_FUNC(MatrixCmd, "Execute")
 
 bRet = lookup_var(MatrixDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(MatrixDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Matrix          !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Name]", "Matrix")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Matrix)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Matrix Defined for this Bench","Y")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Matrix is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 MatrixDriver = "../" & VAL$(Matrix) & "/"
 MatrixCmd    = MatrixDriver & "ground_all"
 
 ICCAP_FUNC(MatrixCmd, "Execute")
 
 bRet = lookup_var(MatrixDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(MatrixDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "showMessage" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [showMessage]
 
 GLOBAL_VAR  TmpVar          !ModelVariable
 
 GET_STRING "Message?", msg$
 GET_STRING "Show in Status Window?", stw$
 
 dummy = WPro_lookup_info("Run", "SingleExeRun", "TmpVar")
 
 IF VAL$(TmpVar)=="TRUE" THEN
   GET_STRING msg$ & "   [OK]", dummy
 END IF
 
 c$ = upc$(substr$(trim$(stw$),1,1))
 IF c$=="Y" OR c$=="T" OR c$=="1" THEN
   PRINT msg$
 END IF
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Manual" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P265 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "hpib_interface"
element 3 "Value" "None"
element 4 "Name" "hpib_addr"
element 4 "Value" "0"
element 5 "Name" "hpib_suffix"
element 5 "Value" "\r"
element 6 "Name" "_____________1"
element 6 "Value" ""
element 7 "Name" "Unit"
element 7 "Value" "SMU1:Pins"
element 8 "Name" "Pin"
element 8 "Value" "21"
element 9 "Name" "Path2Setup"
element 9 "Value" "/Routine/MOS_DC/TransferLinear"
element 10 "Name" "_____________2"
element 10 "Value" ""
element 11 "Name" "OutputNames"
element 11 "Value" "ICCAP_ARRAY[0]"
element 12 "Name" "_____________3"
element 12 "Value" ""
element 13 "Name" ""
element 13 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! Manual is called by MatrixMgr
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]",  "hpib_suffix")
 
 Msg = "exec. Init Matrix"
 GET_STRING Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Unit            !SetupVariable
 GLOBAL_VAR  Pin             !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Unit", "SMU1", Unit
 GET_STRING "Pin",  "1",    Pin
 
 ICCAP_FUNC("../../Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = VAL$(../../Utilities/string/resstring)
 
 Msg = "Connect Matrix Pin: '" & VAL$(Pin) & "' to '" & VAL$(Unit) & "'"
 GET_STRING Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 Msg = "Disconnect All Pins"
 GET_STRING Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 Msg = "Ground All Pins"
 GET_STRING Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Virtual" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P265 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "hpib_interface"
element 3 "Value" "None"
element 4 "Name" "hpib_addr"
element 4 "Value" "0"
element 5 "Name" "hpib_suffix"
element 5 "Value" "\r"
element 6 "Name" "_____________1"
element 6 "Value" ""
element 7 "Name" "Unit"
element 7 "Value" "SMU1:Pins"
element 8 "Name" "Pin"
element 8 "Value" "21"
element 9 "Name" "Path2Setup"
element 9 "Value" "/Routine/MOS_DC/TransferLinear"
element 10 "Name" "_____________2"
element 10 "Value" ""
element 11 "Name" "OutputNames"
element 11 "Value" "ICCAP_ARRAY[0]"
element 12 "Name" "_____________3"
element 12 "Value" ""
element 13 "Name" ""
element 13 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! Virtual is called by MatrixMgr
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]",  "hpib_suffix")
 
 Msg = "exec. Init Matrix"
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Unit            !SetupVariable
 GLOBAL_VAR  Pin             !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Unit", "SMU1", Unit
 GET_STRING "Pin",  "1",    Pin
 
 ICCAP_FUNC("../../Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = VAL$(../../Utilities/string/resstring)
 
 Msg = "Connect Matrix Pin: '" & VAL$(Pin) & "' to '" & VAL$(Unit) & "'"
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 Msg = "Disconnect All Pins"
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 Msg = "Ground All Pins"
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "HP4070" "742.004"
{
View in_out 0 "0.811427528295 3556 2062"
View plot 0 "1.7998487056957 7804 6226"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P236 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "Unit"
element 3 "Value" "SMU2:Pins"
element 4 "Name" "Pin"
element 4 "Value" "12,"
element 5 "Name" "Routine"
element 5 "Value" "CONTACT"
element 6 "Name" "Setup"
element 6 "Value" "Resistance"
element 7 "Name" "Path2Setup"
element 7 "Value" "/Routine/CONTACT/Resistance"
element 8 "Name" "_____________1"
element 8 "Value" ""
element 9 "Name" "HP4070Units[0]"
element 9 "Value" "SMU1:Pins"
element 10 "Name" "HP4070Units[1]"
element 10 "Value" "SMU2:Pins"
element 11 "Name" "HP4070Units[2]"
element 11 "Value" "SMU3:Pins"
element 12 "Name" "HP4070Units[3]"
element 12 "Value" "SMU4:Pins"
element 13 "Name" "HP4070Units[4]"
element 13 "Value" "SMU5:Pins"
element 14 "Name" "HP4070Units[5]"
element 14 "Value" "SMU6:Pins"
element 15 "Name" "HP4070Units[6]"
element 15 "Value" "SMU7:Pins"
element 16 "Name" "HP4070Units[7]"
element 16 "Value" "SMU8:Pins"
element 17 "Name" "HP4070Units[8]"
element 17 "Value" "CMH:High Pin"
element 18 "Name" "HP4070Units[9]"
element 18 "Value" "CMH:Low Pin"
element 19 "Name" "HP4070Units[10]"
element 19 "Value" "DVMH:High Pins"
element 20 "Name" "HP4070Units[11]"
element 20 "Value" "DVMH:Low Pins"
element 21 "Name" "HP4070Units[12]"
element 21 "Value" "CMH:Guard Pins"
element 22 "Name" "HP4070Units[13]"
element 22 "Value" "GNDU:Pins"
element 23 "Name" "HP4070Units"
element 23 "Value" "ICCAP_ARRAY[14]"
element 24 "Name" "InputList"
element 24 "Value" ""
element 25 "Name" "_____________2"
element 25 "Value" ""
element 26 "Name" ""
element 26 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! HP4070 is called by MatrixMgr
 
 ! NOTE: when a pin number is 0
 ! -----------------------------
 ! In the case of using a 407x, set the corresponding Input Units to "GND",
 ! because, for the 407x testers, the matrix is switched by the
 ! IC-CAP button 'Measure' and the SMU->Pin connection info is specified
 ! in the Instrument Options table.
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 ! Nothing to do for scanner HP4070 initialization
 
 !dummy = TIS_register_error_callback("../../Matrix/HP4070/errHandler")
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  RoutineMdl      !ModelVariable
 GLOBAL_VAR  Unit            !SetupVariable
 GLOBAL_VAR  Pin             !SetupVariable
 
 GLOBAL_VAR  Routine         !SetupVariable
 GLOBAL_VAR  Setup           !SetupVariable
 GLOBAL_VAR  Path2Setup      !SetupVariable
 GLOBAL_VAR  InputList       !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Row Name", "SMU1:Pins", Unit
 GET_STRING "PinList",  "1",         Pin
 
 ICCAP_FUNC("../../Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = VAL$(../../Utilities/string/resstring)
 
 dummy = WPro_lookup_info("Context", "Routine", Routine)
 dummy = WPro_lookup_info("Context", "Setup", Setup)
 dummy = WPro_lookup_info("WaferPro","RoutineMdl", RoutineMdl)
 
 Path2Setup = "/"& VAL$(RoutineMdl) &"/"&VAL$(Routine)&"/"&VAL$(Setup)
 
 ! ---- is there a TIS input in the used setup
 ICCAP_FIND_CHILDREN VAL$(Path2Setup), "Input", InputList
 
 ErrorMsg = ""
 i = 0
 WHILE i < sizeof(InputList)
   path$ = VAL$(Path2Setup)&"/"&VAL$(InputList[i])
   dummy = lookup_instr_table_val(path$, VAL$(Unit), ErrorMsg)
   IF VAL$(ErrorMsg) == "" THEN
     ICCAP_FUNC("FillInstrOption", "Execute", path$, VAL$(Unit), VAL$(Pin))
     bRet = 1
     RETURN_VALUE bRet
   ENDIF
   ErrorMsg = ""
   i = i+1
 END WHILE
 
 ! ---- there is no TIS input. So use tis functions.
 unitID = 0
 IF VAL$(Unit) == "CMH:High Pin" THEN unitID = 20107
 IF VAL$(Unit) == "CMH:Low Pin"  THEN unitID = 20108
 IF VAL$(Unit) == "SM1:Pins"     THEN unitID = 20001
 IF VAL$(Unit) == "SM2:Pins"     THEN unitID = 20002
 IF VAL$(Unit) == "SM3:Pins"     THEN unitID = 20003
 IF VAL$(Unit) == "SM4:Pins"     THEN unitID = 20004
 IF VAL$(Unit) == "SM5:Pins"     THEN unitID = 20005
 IF VAL$(Unit) == "SM6:Pins"     THEN unitID = 20006
 IF VAL$(Unit) == "SM7:Pins"     THEN unitID = 20007
 IF VAL$(Unit) == "SM8:Pins"     THEN unitID = 20008
 
 ICCAP_FUNC("../../Utilities/string/cut_string_sep","Execute", VAL$(Pin), ",")
 i = 0
 WHILE i < SIZE(../../Utilities/string/substring)
   IF unitID > 0 THEN dummy = TIS_connect_pin(unitID, ../../Utilities/string/substring[i])
   i = i+1
 END WHILE
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  RoutineMdl      !ModelVariable
 
 GLOBAL_VAR  Routine         !SetupVariable
 GLOBAL_VAR  Setup           !SetupVariable
 GLOBAL_VAR  Path2Setup      !SetupVariable
 GLOBAL_VAR  HP4070Units     !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Context", "Routine", Routine)
 dummy = WPro_lookup_info("Context", "Setup", Setup)
 dummy = WPro_lookup_info("WaferPro","RoutineMdl", RoutineMdl)
 
 Path2Setup = "/"& VAL$(RoutineMdl) &"/"&VAL$(Routine)&"/"&VAL$(Setup)
 
 dummy = TIS_disable_port_all()
 dummy = TIS_disconnect_all()
 
 
 !---Create a fake 4070 output for instrument options access
 path$ = "/"& VAL$(RoutineMdl) &"/"&VAL$(Routine)&"/"&VAL$(Setup)
 ICCAP_FUNC(path$, "New Output", "HP4070_Access_InstrOpt") 
 ValidInputName = path$&"/HP4070_Access_InstrOpt"
 ICCAP_FUNC(VAL$(ValidInputName),"SetTableFieldValue","Unit","SMU1")
 
 i = 0
 WHILE i < sizeof(HP4070Units)
   ErrorMsg = ""  
   dummy = lookup_instr_table_val(VAL$(ValidInputName),VAL$(HP4070Units[i]), ErrorMsg)
   IF VAL$(ErrorMsg) == "" THEN 
     ICCAP_FUNC(VAL$(ValidInputName), "SetInstrumentOptionValue", VAL$(HP4070Units[i]), "")
   ELSE
     ErrorMsg = val$(ErrorMsg) & "    Check and update HP4070Units variable array in the Setup Variable table."
     x = system$("echo 'Error: "&val$(ErrorMsg)&"' >&2")
   ENDIF   
   i = i+1
 ENDWHILE
 
 !---Delete the fake 4070 output for instrument options access
 ICCAP_FUNC(VAL$(ValidInputName), "Delete")   
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  RoutineMdl      !ModelVariable
 
 GLOBAL_VAR  Routine         !SetupVariable
 GLOBAL_VAR  Setup           !SetupVariable
 GLOBAL_VAR  Path2Setup      !SetupVariable
 GLOBAL_VAR  HP4070Units     !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = TIS_disable_port_all()
 dummy = TIS_disconnect_all()
 dummy = TIS_connect_th(TIS_GNDU(),1,49)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "FillInstrOption" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [FillInstrOption]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  RoutineMdl      !ModelVariable
 
 GLOBAL_VAR  Routine         !SetupVariable
 GLOBAL_VAR  Setup           !SetupVariable
 GLOBAL_VAR  Path2Setup      !SetupVariable
 GLOBAL_VAR  HP4070Units     !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Input", "id",           Input
 GET_STRING "Row Name", "SMU1:Pins", Unit
 GET_STRING "PinList", "1",          Pin
 
 ExistingPinList = lookup_instr_table_val(VAL$(Input), VAL$(Unit), ErrorMsg)
 
 IF STRLEN(VAL$(ExistingPinList)) > 0 AND VAL$(ExistingPinList) <> "0" THEN
   Pin = VAL$(Pin) & "," & VAL$(ExistingPinList)
 ENDIF
 
 ICCAP_FUNC(VAL$(Input), "SetInstrumentOptionValue", VAL$(Unit), VAL$(Pin))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "errHandler" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [errHandler]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "--------- Error TIS !!!",test
 
 dummy = TIS_error_info("ErrorMsg")
 dummy = WPro_set_info("Device", "Comment", "ErrorMsg")
 dummy = WPro_set_info("Device", "Result", "NOK")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "B2200A" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "2.9746968797288 13214 10034"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P169 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "hpib_interface"
element 3 "Value" "hpib"
element 4 "Name" "hpib_addr"
element 4 "Value" "22"
element 5 "Name" "hpib_suffix"
element 5 "Value" "\r"
element 6 "Name" "hpib_cmd"
element 6 "Value" ":ROUT:CLOS (@20807)"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "ground_col"
element 8 "Value" "7"
element 9 "Name" "pins_count"
element 9 "Value" ""
element 10 "Name" "Unit"
element 10 "Value" "8"
element 11 "Name" "Pin"
element 11 "Value" "19"
element 12 "Name" "_____________2"
element 12 "Value" ""
element 13 "Name" "PinTab[0]"
element 13 "Value" "1"
element 14 "Name" "PinTab[1]"
element 14 "Value" "3"
element 15 "Name" "PinTab[2]"
element 15 "Value" "5"
element 16 "Name" "PinTab[3]"
element 16 "Value" "7"
element 17 "Name" "PinTab[4]"
element 17 "Value" "9"
element 18 "Name" "PinTab[5]"
element 18 "Value" "11"
element 19 "Name" "PinTab[6]"
element 19 "Value" "13"
element 20 "Name" "PinTab[7]"
element 20 "Value" "15"
element 21 "Name" "PinTab[8]"
element 21 "Value" "17"
element 22 "Name" "PinTab[9]"
element 22 "Value" "19"
element 23 "Name" "PinTab"
element 23 "Value" "ICCAP_ARRAY[10]"
element 24 "Name" "_____________3"
element 24 "Value" ""
element 25 "Name" ""
element 25 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 print "
 Driver: B2200A_01
 This driver is for the Agilent B2200A/B2201A
 It simply connect one input port with one or more output pins
 Use this driver when you do not use Kelvin connections.
 
 For example: 
  - input ports 1 is connected to SMU1 force (sense is not used)
  - input ports 2 is connected to SMU2 force (sense is not used)
  etc...
 
 Typically, when the connect function is called to connect port 1 (A) to pin 22
 the driver will make a single connection, port 1 to pin 22.
 
 Although this is not common, the device table may assign 2 pads to a terminal, 
 for example D=22,23 (pads).The probe card mapping table will convert pad 22 and 23
 to corresponding pin numbers (pins are the output of the matrix).
 The pins will be passed to the connect() function of this driver.
 For example, if terminal D is connected to SMU1 (port 1), both pin 22 and 23 
 will be connected to port 1.  
 
 NOTE: The Matrix definition table in WaferPro-XP is as follows. 
 This configuration can be changed by changing the B2200A.matrix file
 in your local waferpro/instr directory
 
 Unit / Port
 SMU1   1      -> connects port 1 
 SMU2   2      -> connects port 2 
 SMU3   3      -> connects port 3 
 SMU4   4      -> connects port 4
 SMU5   5      -> connects port 5 
 SMU6   6      -> connects port 6 
 SMU7   7      -> connects port 7 
 SMU8   8      -> connects port 8
 GROUND (if use GNDU connect it to port 1 to 8) 
 PinsCount 48
 CMHigh 13     -> connects aux port 13 
 CMLow  14     -> connects aux port 14
 
 NOTE: if you wish to make Kelvin connection please look at the B2200A_01, 
 K70x_02 and drivers
 
 NOTE: ground all connects all the ports to 
 "  
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable
 GLOBAL_VAR  PinTab          !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]",  "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]",     "ground_col")
 dummy = WPro_lookup_info("Hardware", "Matrix[PinsCount]",  "pins_count")
 
 
 ! ---- reset all lines
 hpib_cmd   = "*RST"
 
 ! ---- Send GPIB Command
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 ErrorMsg = VAL$(../../Utilities/gpib/ErrorMsg)
 IF bRet == 0 THEN RETURN_VALUE bRet
 
 
 dummy = WAIT(0.2)
 
 ! ---- reset all lines
 hpib_cmd   = ":ROUT:FUNC NCON"
 
 ! ---- Send GPIB Command
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 ErrorMsg = VAL$(../../Utilities/gpib/ErrorMsg)
 IF bRet == 0 THEN RETURN_VALUE bRet
 
 
 dummy = WAIT(0.2)
 
 PinTab = ""
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Unit            !SetupVariable
 GLOBAL_VAR  Pin             !SetupVariable
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable
 GLOBAL_VAR  PinTab          !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Unit Col", "8",                        Unit
 GET_STRING "PinList",  "1,3,5,7,9,11,13,15,17,19", Pin
 
 ICCAP_FUNC("../../Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = VAL$(../../Utilities/string/resstring)
 
 
 ! ---- Plug all pins to row iRow
 ICCAP_FUNC("../../Utilities/string/cut_string_sep","execute", VAL$(Pin), ",")
 i = 0
 PinTab = VAL$(../../Utilities/string/substring)
 WHILE i < sizeof(../../Utilities/string/substring)
   PinTab[i] = VAL$(../../Utilities/string/substring[i])
   i =i+1
 END WHILE 
 
 i = 0
 WHILE i < sizeof(PinTab)
   pin_val = VAL(VAL$(PinTab[i]))
   ICCAP_FUNC("connect_onepin", "Execute", Unit, VAL$(pin_val))
   i = i+1
 END WHILE
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 hpib_cmd   = ":ROUT:OPEN:CARD ALL"
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")   
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 ErrorMsg = VAL$(../../Utilities/gpib/ErrorMsg)
 IF bRet == 0 THEN RETURN_VALUE bRet
 
 
 bRet = 1
 ErrorMsg = ""
 
 dummy = WAIT(0.2)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable
 GLOBAL_VAR  PinTab          !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 ! ---- connect all line to col GROUND if GROUND is not 0
 PinList = "1"
 Pin = 2
 WHILE Pin <= pins_count
   PinList = PinList &","& VAL$(Pin)
   Pin = Pin+1
 END WHILE
 
 IF (val$(ground_col) <> "0") THEN
    ICCAP_FUNC("disconnect_all", "Execute", ground_col, PinList)
    ICCAP_FUNC("connect", "Execute", ground_col, PinList)
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "connect_onepin" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect_onepin]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Unit            !SetupVariable
 GLOBAL_VAR  Pin             !SetupVariable
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable
 GLOBAL_VAR  PinTab          !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Unit Col", "6",  Unit
 GET_STRING "Pin",      "27", Pin
 
 
 ! ---- Format unit
 UnitCol = VAL$(VAL(Unit),"%02.0f")
 
 ! ---- Format pin
 Pin  = VAL(Pin)
 
 IF Pin < 13 THEN
   Card =1 
   PinInCard = Pin
 ENDIF
 
 IF Pin > 12 AND Pin < 25 THEN
   Card =2 
   PinInCard = Pin-12
 ENDIF
 
 IF Pin > 24 AND Pin < 37 THEN
   Card =3 
   PinInCard = Pin-24
 ENDIF
 
 IF Pin > 36 AND Pin < 49 THEN
   Card =4 
   PinInCard = Pin-36
 ENDIF
 
 
 PinLine = VAL$(PinInCard,"%02.0f")
 
 hpib_cmd = ":ROUT:CLOS (@" & VAL$(Card) & UnitCol &  VAL$(PinInCard,"%02.0f") &")"
 
 
 ! ---- Send GPIB Command
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 dummy = WAIT(0.2)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "B2200A_01" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "2.9746968797288 13214 10034"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P327 C10"
element 0 "Name" "hpib_interface"
element 0 "Value" "GPIB0"
element 1 "Name" "hpib_addr"
element 1 "Value" "22"
element 2 "Name" "hpib_suffix"
element 2 "Value" "\r"
element 3 "Name" "bRet"
element 3 "Value" "1"
element 4 "Name" "ErrorMsg"
element 4 "Value" ""
element 5 "Name" "ground_col"
element 5 "Value" "9"
element 6 "Name" "pins_count"
element 6 "Value" "6"
element 7 "Name" "hpib_cmd"
element 7 "Value" ":ROUT:CLOS (@00803);:ROUT:CLOS (@00925)"
element 8 "Name" "PinTab[0]"
element 8 "Value" "48"
element 9 "Name" "PinTab"
element 9 "Value" "ICCAP_ARRAY[1]"
element 10 "Name" "Offset"
element 10 "Value" "24"
element 11 "Name" ""
element 11 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 print "
 Driver: B2200A_01
 This driver is for the Agilent B2200A/B2201A
 It supports Kelvin connections where ports are connected 
 to SMU's force and sense cables. Coupled ports are connected 
 to different output pins (no kelvin connection is done in the matrix)
 
 IMPORTANT: this driver assumes the following:
 - force and sense cables must be connected to adjacent ports,e.g. 
   SMU1 force must connected to port 1
   SMU1 sense must connected to port 2
 - only one pin number is necessary, which will be connected to 
   force input port. The sense pin number is calculated as 
   follows: pin(sense) = pin(force) + Offset
 
 The Setup Variable 'Offset' default value is 24 and can be
 changed in the Setup Variables table
 
 The Matrix definition table in WaferPro-XP is as follows.
 This configuration can be changed by changing the B2200A_01.matrix file
 in your local waferpro/instr directory, however, this driver only 
 supports DC measurements (not CV) since ports are always coupled.
 
 Unit / Port
 SMU1 1      -> connects SMU1(force) to port 1 and SMU1(sense) to 2
 SMU2 3      -> connects SMU2(force) to port 3 and SMU2(sense) to 4
 SMU3 5      -> connects SMU3(force) to port 5 and SMU3(sense) to 6
 SMU4 7      -> connects SMU4(force) to port 7 and SMU4(sense) to 8
 ...
 
 NOTE: This driver must be used with one pad number connected to each terminal
 in the device table. For example, terminal D=22 (pad). The 
 probe card mapping table will convert pad 22 to corresponding pin number, 
 which is passed to the connect(port, pin) function of this driver.
 
 NOTE: if you do not want to make Kelvin connection please use the B2200A driver
 "  
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]", "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]", "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[PinsCount]", "pins_count")
 
 bRet = 1
 ErrorMsg=""
 
 CumulConnectCmd = ""
 
 dummy = B2200_open_interface((val$(hpib_interface)))
 dummy = B2200_init(hpib_addr, 0, "AUTO", "FREE", "BBM")
 dummy = B2200_close_interface()
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 LINPUT "Unit Col", "8", Unit
 LINPUT "PinList",   "3",    Pin
 
 bRet = 1
 ErrorMsg = ""
 
 ! ---- Plug all pins to row iRow
 
 UnitCol = VAL$(VAL(Unit),"%02.0f")
 Pin  = VAL(Pin)
 PinInCard = Pin
 Card = 0
 
 PinLine = VAL$(PinInCard,"%02.0f")
 
 hpib_cmd = ":ROUT:CLOS (@" & VAL$(Card) & UnitCol &  VAL$(PinInCard,"%02.0f") &")"
 
 Unit = val$(val(Unit)+1)
 UnitCol = VAL$(VAL(Unit),"%02.0f")
 Pin = val$(val(Pin)+val(Offset))
 PinInCard = Pin
 PinLine = VAL$(PinInCard,"%02.0f")
 
 hpib_cmd = val$(hpib_cmd) & ";:ROUT:CLOS (@" & VAL$(Card) & UnitCol &  VAL$(PinInCard,"%02.0f") &")"
 
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 dummy = WAIT(0.2)
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 
 
 bRet = 1
 ErrorMsg=""
 
 
 
 dummy = B2200_open_interface(val$(hpib_interface))
 dummy = B2200_disconnect_card(hpib_addr, 0)
 dummy = B2200_close_interface()
 dummy = WAIT(0.1)
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg=""
 
 ! ---- connect all line to col GROUND
 ! we do not support this since there is no input ground to the B2200
 ! so we simply disconnect all pins
 ICCAP_FUNC("disconnect_all", "Execute")
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
data "742.004"
{
}
}
LINK DAT "E5250A" "742.004"
{
View in_out 0 "0.5970369773408 3556 2110"
View plot 0 "4.0636684669713 18051 13707"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P196 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "hpib_interface"
element 3 "Value" "gpib0"
element 4 "Name" "hpib_addr"
element 4 "Value" "18"
element 5 "Name" "hpib_suffix"
element 5 "Value" "\r"
element 6 "Name" "hpib_cmd"
element 6 "Value" ":ROUT:CLOS (@10701)"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "pins_count"
element 8 "Value" "48"
element 9 "Name" "PinTab[0]"
element 9 "Value" "1"
element 10 "Name" "PinTab[1]"
element 10 "Value" "2"
element 11 "Name" "PinTab[2]"
element 11 "Value" "3"
element 12 "Name" "PinTab[3]"
element 12 "Value" "4"
element 13 "Name" "PinTab[4]"
element 13 "Value" "5"
element 14 "Name" "PinTab"
element 14 "Value" "ICCAP_ARRAY[5]"
element 15 "Name" "PluginPortPinNr"
element 15 "Value" "10105"
element 16 "Name" "_____________2"
element 16 "Value" ""
element 17 "Name" ""
element 17 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! E5250A is called by MatrixMgr
 
 
 ! Aug. 2011, franz.sischka@agilent.com
 
 
 ! E5250A driver (Force only, no Force-Sense Kelvin connections)
 ! for WaferPro, derived from the example in
 ! $ICCAP_ROOT\examples\demo_features\2_LINKING_TO_MEAS_INSTRUMENTS\
 !      3_PROBER_MATRIX_THERMOCHUCK\1_Matrix\Agilent_5250\
 !          1_matrix_5250A_direct_GPIB_cmds_single.mdl
 
 
 
 ! You need to specify the SMU <> port connections in your WaferPro configuration file 'wproBenchList.cfg'.
 !
 ! E.g. for:
 !  SMU1 Force only -> Port1
 !  SMU2 Force only -> Port2
 !  SMU3 Force only -> Port3
 !  SMU4 Force only -> Port4
 !  SMU5 Force only -> Port5
 
 ! we define:
 
 !<SECTION Title="Bench8">
 !        <VAR Name = "myDemo_4142_4275"></VAR>
 !        <VAR SlotCount = "5"></VAR>
 !        <VAR CVTisSupport = "FALSE"></VAR>
 !        <VAR ProberCoordinates = "X-Right, Y-Up"></VAR>
 !        <VAR GoHomeBeforeDieMove = "FALSE"></VAR>
 !        <VAR SMUCount = "5"></VAR>
 !        <TABLE Title="InstrumentPilot" Format="csv">
 !"Type",   "Name",                               "Controller",                              "Address", "CmdSuffix", "GROUND", "SMU1", "SMU2", "SMU3", "SMU4", "SMU5", "CMHigh", "CMLow", "PinsCount"
 !"Matrix", "E5250A",                             "gpib0",                                   "18",      "\r",        "8",      "1",    "2",    "3",    "4",    "5",    "9",      "10",    "48"
 !"Prober", "PAxxx_ProberBench_ICCAP_Translator", "C:/tmp/ProberBench_ICCAP_Translator.exe", "",        "\r",        "",       "",     "",     "",     "",     "",       "",      "",     ""
 !"Chuck",  "Manual",                             "None",                                    "None",    "\r",        "",       "",     "",     "",     "",     "",       "",      "",     ""
 !        </TABLE>
 !</SECTION>
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable, gpib interface
 GLOBAL_VAR  hpib_addr       !SetupVariable, matrix gpib address
 GLOBAL_VAR  hpib_suffix     !SetupVariable, gpib command suffix
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable, nr. of avail. matrix pins
 GLOBAL_VAR  PinTab          !SetupVariable, ICCAP_ARRAY of pins to be connected to a port
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 IF Debug >= 2 THEN GET_STRING "Initializing Matrix E5250A  [OK]", dummy
 
 
 !--- get info from WaferPro
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]",  "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[PinsCount]",  "pins_count")
 
 
 !---initialize 5250A Matrix
 gpib_Number=HPIB_open(VAL$(hpib_interface))
 
 status=HPIB_write(gpib_Number, hpib_addr, "*RST")                      !reset matrix
 status=HPIB_write(gpib_Number, hpib_addr, ":ROUT:FUNC NCON")           !set matrix to Normal Configuration Mode
 status=HPIB_write(gpib_Number, hpib_addr, ":ROUT:CONN:RULE ALL, FREE") !sets all cards to free connection (any combination of port/pins)
 status=HPIB_write(gpib_Number, hpib_addr, ":ROUT:CONN:SEQ ALL, BBM")   !sets break-before-make-connection sequence
 
 status=HPIB_write(gpib_Number, hpib_addr, ":ROUT:OPEN:CARD ALL")       !opens all relays
 status=HPIB_close(gpib_Number)
 
 
 
 !---reset SetupVariables
 PinTab = ""
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable, gpib interface
 GLOBAL_VAR  hpib_addr       !SetupVariable, matrix gpib address
 GLOBAL_VAR  hpib_suffix     !SetupVariable, gpib command suffix
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable, nr. of avail. matrix pins
 GLOBAL_VAR  PinTab          !SetupVariable, ICCAP_ARRAY of pins to be connected to a port
 GLOBAL_VAR  PluginPortPinNr !SetupVariable, result of Xfm 'gpib_cmnd_onepin'
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 !---connects a matrix port to (many) pins
 !   (leaves possible already existing connections as they are)
 
 
 !----------this is answered by the calling MatrixMgr
 GET_STRING "Port",   "1",             Port
 GET_STRING "Pin(s)", "1, 2, 3, 4, 5", Pin   ! supported seperators are either ',' or ';', but no combination !!
 
 
 IF Debug >= 2 THEN GET_STRING "Matrix/E5250A: Connecting Port "&VAL$(Port)&" to Pin(s) "&VAL$(Pin)&"  [OK]", dummy
 
 
 !---open GPIB communication
 gpib_Number=HPIB_open(VAL$(hpib_interface))
 
 
 !---- convert PinList to array PinTab
 IF STRPOS(VAL$(Pin), ",") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")   !multiple pins with separator ','
 ELSEIF STRPOS(VAL$(Pin), ";") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ";")   !multiple pins with separator ';'
 ELSE
   PinTab = Pin            !single Pin
 END IF
 
 
 !---verify if PinTab is established correctly
 FOR i=0 TO SIZEOF(PinTab)-1
   IF (STRPOS(VAL$(PinTab[i]), ",")>0) OR (STRPOS(VAL$(PinTab[i]), ";")>0) THEN
     ErrorMsg="could not correctly resolve pin connections"
     status=HPIB_close(gpib_Number)
     bRet=0
     RETURN_VALUE bRet
   END IF
 NEXT i
 
 
 !--- prepare GPIB command
 GPIB_Cmnd = ":ROUT:CLOS (@"
 
 IF SIZEOF(PinTab)==0 THEN
   ICCAP_FUNC("gpib_cmnd_onepin", "Execute", VAL(Port), VAL(PinTab))
   GPIB_Cmnd = VAL$(GPIB_Cmnd)&VAL$(PluginPortPinNr)
 ELSE
   FOR i = 0 TO SIZEOF(PinTab)-1
     pin_val = VAL(PinTab[i])
     ICCAP_FUNC("gpib_cmnd_onepin", "Execute", VAL(Port), VAL(pin_val))
 
     IF VAL$(ErrorMsg)<>"" THEN
       status=HPIB_close(gpib_Number)
       bRet=0
       RETURN_VALUE bRet
     END IF
 
     GPIB_Cmnd = VAL$(GPIB_Cmnd)&VAL$(PluginPortPinNr)&","
   NEXT i
 
   GPIB_Cmnd = SUBSTR$(GPIB_Cmnd, 1, VAL(STRLEN(GPIB_Cmnd)-1))      !cut-off last comma
 END IF
 
 GPIB_Cmnd = VAL$(GPIB_Cmnd)&")"   !close command brackets
 
 
 !---send gpib command
 PRINT GPIB_Cmnd
 
 IF Debug >= 2 THEN GET_STRING "Sending E5250 GPIB cmnd "&VAL$(GPIB_Cmnd)&"  [OK]", dummy
 status=HPIB_write(gpib_Number, hpib_addr, VAL$(GPIB_Cmnd))
 
 status=HPIB_close(gpib_Number)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable, gpib interface
 GLOBAL_VAR  hpib_addr       !SetupVariable, matrix gpib address
 GLOBAL_VAR  hpib_suffix     !SetupVariable, gpib command suffix
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 IF Debug >= 2 THEN GET_STRING "Matrix/E5250A: Disconnecting all  [OK]", dummy
 
 
 gpib_Number=HPIB_open(VAL$(hpib_interface))
 status=HPIB_write(gpib_Number, hpib_addr, ":ROUT:OPEN:CARD ALL")      !opens all relays
 status=HPIB_close(gpib_Number)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 ErrorMsg = "Ground-all-Pins is currently not implemented  in '"&VAL$(WHOIS(".", "Parent Setup"))
 bRet = 1
 
 PRINT  ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "gpib_cmnd_onepin" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [gpib_cmnd_onepin]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable, gpib interface
 GLOBAL_VAR  hpib_addr       !SetupVariable, matrix gpib address
 GLOBAL_VAR  hpib_suffix     !SetupVariable, gpib command suffix
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  pins_count      !SetupVariable, nr. of avail. matrix pins
 GLOBAL_VAR  PinTab          !SetupVariable, ICCAP_ARRAY of pins to be connected to a port
 GLOBAL_VAR  PluginPortPinNr !SetupVariable, result of Xfm 'gpib_cmnd_onepin'
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 ! This Program composes the GPIB command for the E5250A Matrix
 
 ! the following is answered by the calling Xfm
 GET_INT "Enter Port Nr.", 1, PortNr
 GET_INT "Enter Pin Nr.", 13, PinNr
 
 !--------------------------------------------------
 
 IF PinNr<1 OR PinNr>pins_count THEN 
   bRet=0
   ErrorMsg = "ERROR: 5250A Matrix: Pin Number Error"
   RETURN_VALUE bRet
 END IF
 
 !---calculate (out of the pin number) the required Matrix Plugin number
 ! and then the Plugin-Port-Pin number
 Plugin = FLOOR((PinNr-1)//12)+1
 PluginPinNr = PinNr - (Plugin-1)*12
 IF STRLEN(VAL$(PluginPinNr)) == 1 THEN PluginPinNr = "0"&VAL$(PluginPinNr)
 IF STRLEN(VAL$(PortNr)) == 1 THEN PortNr="0"&VAL$(PortNr)
 PluginPortPinNr=VAL$(Plugin)&VAL$(PortNr)&VAL$(PluginPinNr)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "K70x" "742.004"
{
View in_out 0 "0.811427528295 3556 2110"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 C34 C10"
element 0 "Name" "bRet"
element 0 "Value" "1"
element 1 "Name" "ErrorMsg"
element 1 "Value" ""
element 2 "Name" "_____________0"
element 2 "Value" ""
element 3 "Name" "hpib_interface"
element 3 "Value" "/dev/gpib0"
element 4 "Name" "hpib_suffix"
element 4 "Value" "\r"
element 5 "Name" "hpib_addr"
element 5 "Value" "22"
element 6 "Name" "hpib_cmd"
element 6 "Value" ""
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "ground_col"
element 8 "Value" "GNDUndefined"
element 9 "Name" "Unit"
element 9 "Value" "A"
element 10 "Name" "Pin"
element 10 "Value" "11"
element 11 "Name" "Path2Setup"
element 11 "Value" "/Routine/MOS_DC/TransferLinear"
element 12 "Name" "_____________2"
element 12 "Value" ""
element 13 "Name" "PortName[0]"
element 13 "Value" "A"
element 14 "Name" "PortName[1]"
element 14 "Value" "B"
element 15 "Name" "PortName[2]"
element 15 "Value" "C"
element 16 "Name" "PortName[3]"
element 16 "Value" "D"
element 17 "Name" "PortName[4]"
element 17 "Value" "E"
element 18 "Name" "PortName[5]"
element 18 "Value" "F"
element 19 "Name" "PortName[6]"
element 19 "Value" "G"
element 20 "Name" "PortName[7]"
element 20 "Value" "H"
element 21 "Name" "PortName"
element 21 "Value" "ICCAP_ARRAY[8]"
element 22 "Name" "PinTab[0]"
element 22 "Value" "31"
element 23 "Name" "PinTab"
element 23 "Value" "ICCAP_ARRAY[1]"
element 24 "Name" "_____________3"
element 24 "Value" ""
element 25 "Name" ""
element 25 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 print "
 Driver: K70x_01
 This driver is for the K707/8 Keithley Switch Matrix
 It simply connect one input port with one or more output pins
 Use this driver when you do not use Kelvin connections.
 
 For example: 
  - input ports A is connected to SMU1 force (sense is not used)
  - input ports B is connected to SMU2 force (sense is not used)
  etc...
  
 when the connect function is called to connect port 1 (A) to pin 22
 the driver will make a single connection, port 1 to pin 22.
 
 Although this is not common, the device table may assign 2 pads to a terminal, 
 for example D=22,23 (pads).The probe card mapping table will convert pad 22 and 23
 to corresponding pin numbers (pins are the output of the matrix).
 The pins will be passed to the connect() function of this driver.
 For example, if terminal D is connected to SMU1 (port A), both pin 22 and 23 
 will be connected to port A.  
 
 NOTE: The Matrix definition table in WaferPro-XP is as follows. 
 This configuration can be changed by changing the K70x.matrix file
 in your local waferpro/instr directory
 
 Unit / Port
 SMU1   1      -> connects port A 
 SMU2   2      -> connects port B 
 SMU3   3      -> connects port C 
 SMU4   4      -> connects port D
 SMU5   5      -> connects port E 
 SMU6   6      -> connects port F 
 CMHigh 7      -> connects port G 
 CMLow  8      -> connects port H
 
 NOTE: if you wish to make Kelvin connection please look at the K70x_01, 
 K70x_02 and drivers
 "  
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  PortName        !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]",  "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]",     "ground_col")
 
 
 PortName = "ICCAP_ARRAY[8]"
 PortName[0] = "A"
 PortName[1] = "B"
 PortName[2] = "C"
 PortName[3] = "D"
 PortName[4] = "E"
 PortName[5] = "F"
 PortName[6] = "G"
 PortName[7] = "H"
 
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [connect]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 GLOBAL_VAR  ground_col      !SetupVariable
 GLOBAL_VAR  PortName        !SetupVariable
 GLOBAL_VAR  PinTab          !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 GET_STRING "Port Number", "1",             Unit
 GET_STRING "Pin(s)",      "1, 2, 3, 4, 5", Pin  ! supported seperators are either ',' or ';', but no combination !!
 
 ICCAP_FUNC("../../Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = VAL$(../../Utilities/string/resstring)
 
 
 !---- Plug all pins to row iRow ------------------------
 
 !---- convert PinList to array PinTab (SetupVariable)
 IF STRPOS(VAL$(Pin), ",") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")   !multiple pins with separator ','
 ELSEIF STRPOS(VAL$(Pin), ";") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ";")   !multiple pins with separator ';'
 ELSE
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")   !single Pin
 END IF
 
 
 !---verify if PinTab is established correctly
 FOR i=0 TO SIZEOF(PinTab)-1
   IF (STRPOS(VAL$(PinTab[i]), ",")>0) OR (STRPOS(VAL$(PinTab[i]), ";")>0) THEN
     ErrorMsg="could not correctly resolve pin connections"
     status=HPIB_close(gpib_Number)
     bRet=0
     RETURN_VALUE bRet
   END IF
 NEXT i
 
 
 !---compose HPIB command  e.g. CA1X    connects Port3 (C) to Pin 1
 !                              CA1,A2X connects Port3 (C) to Pins 1 and 2
 hpib_cmd = "C"
 FOR i=0 TO SIZEOF(PinTab)-1
   ActPortPin = VAL$(PortName[VAL(Unit)-1])&VAL$(VAL(PinTab[i]))&","
   hpib_cmd=VAL$(hpib_cmd)&VAL$(ActPortPin)
 NEXT i
 
 hpib_cmd=SUBSTR$(VAL$(hpib_cmd), 1, STRLEN(val$(hpib_cmd))-1)
 hpib_cmd=VAL$(hpib_cmd)&"X"
 
 IF Debug >= 2 THEN GET_STRING "GPIB command for Keithley 70x Matrix: "&VAL$(hpib_cmd), dummy
 
 !---send command to matrix
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = VAL$(../../Utilities/gpib/ErrorMsg)
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [disconnect_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  hpib_cmd        !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = VAL$(../../Utilities/gpib/ErrorMsg)
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [ground_all]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 
 ErrorMsg = "Ground-all-Pins is currently not implemented  in '"&VAL$(WHOIS(".", "Parent Setup"))
 bRet = 1
 
 PRINT  ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "K70x_01" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "2.319851744019 10305 7825"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P303 C10"
element 0 "Name" "Path2Setup"
element 0 "Value" "/Routine/MOS_DC/TransferLinear"
element 1 "Name" "Unit"
element 1 "Value" "A"
element 2 "Name" "Pin"
element 2 "Value" "11"
element 3 "Name" "________________0"
element 3 "Value" ""
element 4 "Name" "bRet"
element 4 "Value" "1"
element 5 "Name" "ErrorMsg"
element 5 "Value" ""
element 6 "Name" "hpib_interface"
element 6 "Value" "gpib1"
element 7 "Name" "hpib_cmd_suffix"
element 7 "Value" "\r"
element 8 "Name" "hpib_addr"
element 8 "Value" "18"
element 9 "Name" "_______________________2"
element 9 "Value" ""
element 10 "Name" "PortName[0]"
element 10 "Value" "A"
element 11 "Name" "PortName[1]"
element 11 "Value" "B"
element 12 "Name" "PortName[2]"
element 12 "Value" "C"
element 13 "Name" "PortName[3]"
element 13 "Value" "D"
element 14 "Name" "PortName[4]"
element 14 "Value" "E"
element 15 "Name" "PortName[5]"
element 15 "Value" "F"
element 16 "Name" "PortName[6]"
element 16 "Value" "G"
element 17 "Name" "PortName[7]"
element 17 "Value" "H"
element 18 "Name" "PortName"
element 18 "Value" "ICCAP_ARRAY[8]"
element 19 "Name" "ground_col"
element 19 "Value" "GNDUndefined"
element 20 "Name" "PinTab[0]"
element 20 "Value" "13"
element 21 "Name" "PinTab[1]"
element 21 "Value" "22"
element 22 "Name" "PinTab"
element 22 "Value" "ICCAP_ARRAY[2]"
element 23 "Name" "pCoupled[0][0]"
element 23 "Value" "A"
element 24 "Name" "pCoupled[0][1]"
element 24 "Value" "E"
element 25 "Name" "pCoupled[0]"
element 25 "Value" "ICCAP_ARRAY[2]"
element 26 "Name" "pCoupled[1][0]"
element 26 "Value" "B"
element 27 "Name" "pCoupled[1][1]"
element 27 "Value" "F"
element 28 "Name" "pCoupled[1]"
element 28 "Value" "ICCAP_ARRAY[2]"
element 29 "Name" "pCoupled[2][0]"
element 29 "Value" "C"
element 30 "Name" "pCoupled[2][1]"
element 30 "Value" "G"
element 31 "Name" "pCoupled[2]"
element 31 "Value" "ICCAP_ARRAY[2]"
element 32 "Name" "pCoupled[3][0]"
element 32 "Value" "D"
element 33 "Name" "pCoupled[3][1]"
element 33 "Value" "H"
element 34 "Name" "pCoupled[3]"
element 34 "Value" "ICCAP_ARRAY[2]"
element 35 "Name" "pCoupled"
element 35 "Value" "ICCAP_ARRAY[4]"
element 36 "Name" ""
element 36 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" "coupledSheet.coupledSheet"
element 0 "Value" "ST|XM=%#18pCoupled:HT=200:TO=FW&dummy:VR=0|<none>|<none>|0|1"
element 1 "Name" "coupledSheet"
element 1 "Value" "TL|<none>|<none>|#17label_1:#212coupledSheet|0|0"
element 2 "Name" "coupledSheet.label_1"
element 2 "Value" "LA|CA=#240Specify coupled ports in the table below|<none>|<none>|0"
element 3 "Name" ""
element 3 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 print "
 Driver: K70x_01
 This driver is for the K707/8 Keithley Switch Matrix
 It supports Kelvin connections where ports are connected 
 to SMU's force and sense cables. Coupled ports are connected 
 to the same output pin.
 IMPORTANT: User must run the function 'setCoupleMapping; to set
 coupled ports and then save the driver. You can copy and paste
 this driver and change the input port map on the new copy if you
 need to have available multiple configurations.
 
 For example: 
  - input ports A and B are connected to SMU1 force and sense
  - input ports C and D are connected to SMU1 force and sense
  etc...
  Fill the table as follows:
  A B
  C D
  ...
 
 when the connect function is called to connect port 1 (A) to pin 22
 the drive will connect both ports A and B to pin 22
 
 NOTE: This driver must be used with one pad number connected to each terminal
 in the device table. For example, terminal D=25 (pad). The 
 probe card mapping table will convert pad 25 to a corresponding pin number, 
 this pin number will be passed to the connect(port, pin) function of this driver.
 
 NOTE: The Matrix definition table in WaferPro-XP is as follows. 
 This configuration can be changed by changing the K70x.matrix file
 in your local waferpro/instr directory, however, this driver only 
 supports DC measurements (not CV) since ports are always coupled.
 
 Unit / Port
 SMU1 1      -> connects SMU1(force) to port A and SMU1(sense) to E
 SMU2 2      -> connects SMU2(force) to port B and SMU2(sense) to D
 SMU3 3      -> connects SMU3(force) to port C and SMU3(sense) to G
 SMU4 4      -> connects SMU4(force) to port D and SMU4(sense) to H
 
 As mentioned, use setCoupleMapping to change the default coupling ports
 
 NOTE: if you do not want to make the Kelvin connection in the matrix
 but have both sense and force connection to be passed on to the probe card
 then you need to use the K70x_02 driver
 "  
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug     	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 GLOBAL_VAR  PortName	!SetupVariable
 GLOBAL_VAR  ground_col	!SetupVariable
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]", "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]", "hpib_cmd_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]", "ground_col")
 
 bRet = 1
 ErrorMsg=""
 
 
 PortName = "ICCAP_ARRAY[8]"
 PortName[0] = "A"
 PortName[1] = "B"
 PortName[2] = "C"
 PortName[3] = "D"
 PortName[4] = "E"
 PortName[5] = "F"
 PortName[6] = "G"
 PortName[7] = "H"
 
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 GLOBAL_VAR  PortName	!SetupVariable
 GLOBAL_VAR  PinTab		!SetupVariable
 GLOBAL_VAR  pCoupled          
 
 
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 !----------
 GET_STRING "Port Number", "1", Unit
 GET_STRING "Pin(s)", "1, 2, 3, 4, 5", Pin	! supported seperators are either ',' or ';', but no combination !!
 
 ICCAP_FUNC("/Driver/Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = val$(/Driver/Utilities/string/resstring)
 
 bRet = 1
 ErrorMsg = ""
 
 !print "Unit Passed: ";Unit
 !print "Pin after processing: ";Pin
 
 
 !---- Plug all pins to row iRow ------------------------
 
 !---- convert PinList to array PinTab (SetupVariable)
 IF STRPOS(VAL$(Pin), ",") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")	!multiple pins with separator ','
 ELSEIF STRPOS(VAL$(Pin), ";") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ";")	!multiple pins with separator ';'
 ELSE
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")	!single Pin
 END IF
 
 
 
 !---verify if PinTab is established correctly
 FOR i=0 TO SIZEOF(PinTab)-1
   IF (STRPOS(VAL$(PinTab[i]), ",")>0) OR (STRPOS(VAL$(PinTab[i]), ";")>0) THEN
     ErrorMsg="could not correctly resolve pin connections"
     status=HPIB_close(gpib_Number)
     bRet=0
     RETURN_VALUE bRet
   END IF
 NEXT i
 
 ! Find the coupled port 
 portName = VAL$(PortName[VAL(Unit)-1])
 coupledPort = ""
 FOR i=0 TO SIZEOF(pCoupled)-1
     IF portName == VAL$(pCoupled[VAL(i)][0]) THEN
        coupledPort = VAL$(pCoupled[VAL(i)][1])
        BREAK
     ENDIF
 NEXT i
 
 
 !---compose HPIB command  e.g. CA1X    connects Port3 (C) to Pin 1
 !                              CA1,A2X connects Port3 (C) to Pins 1 and 2
 hpib_cmd = "C"
 FOR i=0 TO SIZEOF(PinTab)-1
   ActPortPin = VAL$(PortName[VAL(Unit)-1])&VAL$(VAL(PinTab[i]))&"," 
   hpib_cmd=VAL$(hpib_cmd)&VAL$(ActPortPin)
 NEXT i
 
 if (coupledPort<>"") then 
    FOR i=0 TO SIZEOF(PinTab)-1 
       ActPortPin = coupledPort&VAL$(VAL(PinTab[i]))&"," 
       hpib_cmd=VAL$(hpib_cmd)&VAL$(ActPortPin)
    NEXT i
 endif
 
 
 hpib_cmd=SUBSTR$(VAL$(hpib_cmd), 1, STRLEN(hpib_cmd)-1)
 hpib_cmd=VAL$(hpib_cmd)&"X"
 
 
 IF Debug>1 THEN GET_STRING "GPIB command for Keithley 70x Matrix: "&VAL$(hpib_cmd), dummy
 
 
 !---send command to matrix
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 
 
 
 ErrorMsg="Ground-all-Pins is currently not implemented  in '"&VAL$(WHOIS(".", "Parent Setup"))
 bRet = 1
 
 
 
 PRINT  ErrorMsg
 
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "setCoupleMapping" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 iccap_func("./coupledSheet", "Display Modal GUI", "Mapping Spreadsheet")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
data "742.004"
{
}
}
LINK DAT "K70x_02" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "2.319851744019 10305 7825"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P301 C10"
element 0 "Name" "Path2Setup"
element 0 "Value" "/Routine/MOS_DC/TransferLinear"
element 1 "Name" "Unit"
element 1 "Value" "A"
element 2 "Name" "Pin"
element 2 "Value" "11"
element 3 "Name" "________________0"
element 3 "Value" ""
element 4 "Name" "bRet"
element 4 "Value" "1"
element 5 "Name" "ErrorMsg"
element 5 "Value" ""
element 6 "Name" "hpib_interface"
element 6 "Value" "gpib1"
element 7 "Name" "hpib_cmd_suffix"
element 7 "Value" "\r"
element 8 "Name" "hpib_addr"
element 8 "Value" "18"
element 9 "Name" "_______________________2"
element 9 "Value" ""
element 10 "Name" "PortName[0]"
element 10 "Value" "A"
element 11 "Name" "PortName[1]"
element 11 "Value" "B"
element 12 "Name" "PortName[2]"
element 12 "Value" "C"
element 13 "Name" "PortName[3]"
element 13 "Value" "D"
element 14 "Name" "PortName[4]"
element 14 "Value" "E"
element 15 "Name" "PortName[5]"
element 15 "Value" "F"
element 16 "Name" "PortName[6]"
element 16 "Value" "G"
element 17 "Name" "PortName[7]"
element 17 "Value" "H"
element 18 "Name" "PortName"
element 18 "Value" "ICCAP_ARRAY[8]"
element 19 "Name" "ground_col"
element 19 "Value" "GNDUndefined"
element 20 "Name" "PinTab[0]"
element 20 "Value" "8"
element 21 "Name" "PinTab[1]"
element 21 "Value" "12"
element 22 "Name" "PinTab"
element 22 "Value" "ICCAP_ARRAY[2]"
element 23 "Name" "pCoupled[0][0]"
element 23 "Value" "A"
element 24 "Name" "pCoupled[0][1]"
element 24 "Value" "E"
element 25 "Name" "pCoupled[0]"
element 25 "Value" "ICCAP_ARRAY[2]"
element 26 "Name" "pCoupled[1][0]"
element 26 "Value" "B"
element 27 "Name" "pCoupled[1][1]"
element 27 "Value" "F"
element 28 "Name" "pCoupled[1]"
element 28 "Value" "ICCAP_ARRAY[2]"
element 29 "Name" "pCoupled[2][0]"
element 29 "Value" "C"
element 30 "Name" "pCoupled[2][1]"
element 30 "Value" "G"
element 31 "Name" "pCoupled[2]"
element 31 "Value" "ICCAP_ARRAY[2]"
element 32 "Name" "pCoupled[3][0]"
element 32 "Value" "D"
element 33 "Name" "pCoupled[3][1]"
element 33 "Value" "H"
element 34 "Name" "pCoupled[3]"
element 34 "Value" "ICCAP_ARRAY[2]"
element 35 "Name" "pCoupled"
element 35 "Value" "ICCAP_ARRAY[4]"
element 36 "Name" ""
element 36 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" "coupledSheet.coupledSheet"
element 0 "Value" "ST|XM=%#18pCoupled:HT=200:TO=FW&dummy:VR=0|<none>|<none>|0|1"
element 1 "Name" "coupledSheet"
element 1 "Value" "TL|<none>|<none>|#17label_1:#212coupledSheet|0|0"
element 2 "Name" "coupledSheet.label_1"
element 2 "Value" "LA|CA=#240Specify coupled ports in the table below|<none>|<none>|0"
element 3 "Name" ""
element 3 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 print "
 Driver: K70x_01
 This driver is for the K707/8 Keithley Switch Matrix
 It supports Kelvin connections where ports are connected 
 to SMU's force and sense cables. Coupled ports are connected 
 to different output pins which are passed in, e.g.
 connect(1,"23,24") connects port A to pin 23 and coupled
 port E to pin 24 (assuming A and B are coupled)
 
 IMPORTANT: User must run the function 'setCoupleMapping; to set
 coupled ports and then save the driver. You can copy and paste
 this driver and change the input port map on the new copy if you
 need to have available multiple configurations. The default factory 
 cofiguration is:
 A E (A and E are coupled)
 D F
 C G
 D H
 
 For example, to obtain the following behavior: 
  - input ports A and B are connected to SMU1 force and sense
  - input ports C and D are connected to SMU1 force and sense
  etc...
  Fill the table as follows:
  A B
  C D
  ...
 
 NOTE: This driver must be used with two pad numbers connected to each terminal
 in the device table, separated by comma. For example, terminal D=22,23 (pad). The 
 probe card mapping table will convert pads 22,23 to corresponding pin numbers, 
 which are passed to the connect(port, pin) function of this driver.
 
 NOTE: The Matrix definition table in WaferPro-XP is as follows. 
 This configuration can be changed by changing the K70x.matrix file
 in your local waferpro/instr directory, however, this driver only 
 supports DC measurements (not CV) since ports are always coupled.
 
 Unit / Port
 SMU1 1      -> connects SMU1(force) to port A and SMU1(sense) to E
 SMU2 2      -> connects SMU2(force) to port B and SMU2(sense) to D
 SMU3 3      -> connects SMU3(force) to port C and SMU3(sense) to G
 SMU4 4      -> connects SMU4(force) to port D and SMU4(sense) to H
 
 As mentioned, use setCoupleMapping to change the default coupling ports
 
 NOTE: if you  want to make the Kelvin connection in the matrix
 please use the K70x_01 driver
 "  
 
 RETURN_VALUE 1
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug     	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 GLOBAL_VAR  PortName	!SetupVariable
 GLOBAL_VAR  ground_col	!SetupVariable
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]", "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]", "hpib_cmd_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]", "ground_col")
 
 bRet = 1
 ErrorMsg=""
 
 
 PortName = "ICCAP_ARRAY[8]"
 PortName[0] = "A"
 PortName[1] = "B"
 PortName[2] = "C"
 PortName[3] = "D"
 PortName[4] = "E"
 PortName[5] = "F"
 PortName[6] = "G"
 PortName[7] = "H"
 
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 GLOBAL_VAR  PortName	!SetupVariable
 GLOBAL_VAR  PinTab		!SetupVariable
 GLOBAL_VAR  pCoupled          
 
 
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 !----------
 GET_STRING "Port Number", "1", Unit
 GET_STRING "Pin(s)", "8,12", Pin	! supported seperators are either ',' or ';', but no combination !!
 
 ICCAP_FUNC("/Driver/Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = val$(/Driver/Utilities/string/resstring)
 
 bRet = 1
 ErrorMsg = ""
 
 !print "Unit Passed: ";Unit
 !print "Pin after processing: ";Pin
 
 
 !---- Plug all pins to row iRow ------------------------
 
 !---- convert PinList to array PinTab (SetupVariable)
 IF STRPOS(VAL$(Pin), ",") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")	!multiple pins with separator ','
 ELSEIF STRPOS(VAL$(Pin), ";") > 0 THEN
   RetVal = CUTSTR(VAL$(Pin), PinTab, ";")	!multiple pins with separator ';'
 ELSE
   RetVal = CUTSTR(VAL$(Pin), PinTab, ",")	!single Pin
 END IF
 
 
 
 !---verify if PinTab is established correctly
 IF SIZEOF(PinTab) <> 2 THEN
   ErrorMsg="Exactly two pins must be provided"
   bRet=0
   RETURN_VALUE bRet
 ENDIF
 
 FOR i=0 TO SIZEOF(PinTab)-1
   IF (STRPOS(VAL$(PinTab[i]), ",")>0) OR (STRPOS(VAL$(PinTab[i]), ";")>0) THEN
     ErrorMsg="could not correctly resolve pin connections"
     bRet=0
     RETURN_VALUE bRet
   END IF
 NEXT i
 
 ! Find the coupled port 
 portName = VAL$(PortName[VAL(Unit)-1])
 coupledPort = ""
 
 FOR i=0 TO SIZEOF(pCoupled)-1
     IF portName == VAL$(pCoupled[VAL(i)][0]) THEN
        coupledPort = VAL$(pCoupled[VAL(i)][1])
        BREAK
     ENDIF
 NEXT i
 
 !---compose HPIB command  e.g. CA1X    connects Port3 (C) to Pin 1
 !                              CA1,A2X connects Port3 (C) to Pins 1 and 2
 hpib_cmd = "C"
 
 ActPortPin = portName&VAL$(VAL(PinTab[0]))&"," 
 hpib_cmd=VAL$(hpib_cmd)&VAL$(ActPortPin)
 
 if (coupledPort<>"") then 
    ActPortPin = coupledPort&VAL$(VAL(PinTab[1]))&"," 
    hpib_cmd=VAL$(hpib_cmd)&VAL$(ActPortPin)
 endif
 
 
 hpib_cmd=SUBSTR$(VAL$(hpib_cmd), 1, STRLEN(hpib_cmd)-1)
 hpib_cmd=VAL$(hpib_cmd)&"X"
 
 
 IF Debug>1 THEN GET_STRING "GPIB command for Keithley 70x Matrix: "&VAL$(hpib_cmd), dummy
 
 
 !---send command to matrix
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 GLOBAL_VAR hpib_interface   	!SetupVariable
 GLOBAL_VAR hpib_addr        	!SetupVariable
 GLOBAL_VAR hpib_cmd_suffix  	!SetupVariable
 
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 ! ---- clear Matrix
 hpib_cmd   = "R0X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd", "Execute", VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_cmd_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR Debug      	!ModelVariable
 GLOBAL_VAR ErrorMsg   	!SetupVariable
 GLOBAL_VAR bRet       	!SetupVariable
 
 IF Debug>0 THEN PRINT ">>> exec. Xfm " & WHOAMI() & " ..."
 
 
 
 
 ErrorMsg="Ground-all-Pins is currently not implemented  in '"&VAL$(WHOIS(".", "Parent Setup"))
 bRet = 1
 
 
 
 PRINT  ErrorMsg
 
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "setCoupleMapping" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 iccap_func("./coupledSheet", "Display Modal GUI", "Mapping Spreadsheet")
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
data "742.004"
{
}
}
LINK DAT "K70xBridge" "742.004"
{
View in_out 0 "0.811427528295 3556 2126"
View plot 0 "2.7968555255505 12424 9434"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 C15 C10"
element 0 "Name" "hpib_interface"
element 0 "Value" "hpib25"
element 1 "Name" "hpib_addr"
element 1 "Value" "22"
element 2 "Name" "hpib_suffix"
element 2 "Value" "\r"
element 3 "Name" "bRet"
element 3 "Value" "1"
element 4 "Name" "ErrorMsg"
element 4 "Value" ""
element 5 "Name" "ground_col"
element 5 "Value" "34"
element 6 "Name" "pins_count"
element 6 "Value" "24"
element 7 "Name" "RowTab[0]"
element 7 "Value" "GROUND"
element 8 "Name" "RowTab[1]"
element 8 "Value" "SMU2"
element 9 "Name" "RowTab[2]"
element 9 "Value" "SMU1"
element 10 "Name" "RowTab[3]"
element 10 "Value" ""
element 11 "Name" "RowTab[4]"
element 11 "Value" ""
element 12 "Name" "RowTab[5]"
element 12 "Value" ""
element 13 "Name" "RowTab[6]"
element 13 "Value" ""
element 14 "Name" "RowTab[7]"
element 14 "Value" ""
element 15 "Name" "RowTab"
element 15 "Value" "ICCAP_ARRAY[8]"
element 16 "Name" "LineTab[0]"
element 16 "Value" "A"
element 17 "Name" "LineTab[1]"
element 17 "Value" "B"
element 18 "Name" "LineTab[2]"
element 18 "Value" "C"
element 19 "Name" "LineTab[3]"
element 19 "Value" "D"
element 20 "Name" "LineTab[4]"
element 20 "Value" "E"
element 21 "Name" "LineTab[5]"
element 21 "Value" "F"
element 22 "Name" "LineTab[6]"
element 22 "Value" "G"
element 23 "Name" "LineTab[7]"
element 23 "Value" "H"
element 24 "Name" "LineTab"
element 24 "Value" "ICCAP_ARRAY[8]"
element 25 "Name" "hpib_cmd"
element 25 "Value" "CC26,C01X"
element 26 "Name" "CumulConnectCmd"
element 26 "Value" ""
element 27 "Name" ""
element 27 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]", "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]", "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]", "ground_col")
 dummy = WPro_lookup_info("Hardware", "Matrix[PinsCount]", "pins_count")
 
 bRet = 1
 ErrorMsg=""
 
 CumulConnectCmd = ""
 
 RowTab = "ICCAP_ARRAY[8]"
 i = 0
 WHILE i < SIZE(RowTab)
   RowTab[i] = ""
   i = i+1
 END WHILE
 
 LineTab = "ICCAP_ARRAY[8]"
 LineTab[0] = "A"
 LineTab[1] = "B"
 LineTab[2] = "C"
 LineTab[3] = "D"
 LineTab[4] = "E"
 LineTab[5] = "F"
 LineTab[6] = "G"
 LineTab[7] = "H"
 
 
 ! ---- reset all lines
 hpib_cmd   = "R0X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 IF bRet == 0 THEN RETURN bRet
 
 ! ------------------------
 hpib_cmd   = "V00000000X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 IF bRet == 0 THEN RETURN bRet
 
 ! ------------------------
 hpib_cmd   = "W11111111X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 LINPUT "Unit Col", "27", Unit
 LINPUT "PinList",   "1",    Pin
 
 ICCAP_FUNC("/Driver/Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = /Driver/Utilities/string/resstring
 
 bRet = 1
 ErrorMsg = ""
 
 hpib_cmd   = "C"
 
 ! ---- is there already a line plugged to this unit ? ----- 
 i = 0
 iRow = -1 
 iFreeRow = -1
 WHILE (i < SIZE(RowTab))
   IF (VAL$(Unit) ==  VAL$(RowTab[i]))            THEN iRow = i
   IF (VAL$(RowTab[i]) ==  "" AND iFreeRow == -1) THEN iFreeRow = i
   IF (iFreeRow <> -1 AND iRow <> -1)             THEN i = SIZE(RowTab)
   i = i+1
 END WHILE 
 
 IF (iFreeRow == -1 AND iRow == -1) THEN 
   ErrorMsg = "Cannot connect units " &VAL$(Unit) &" . Not enough k707 lines."
   bRet = 0
   RETURN bRet
 ENDIF
 
 ! ---- Unit has no line ? => plug one.
 IF (iRow == -1) THEN
   iRow = iFreeRow
   RowTab[iRow] = VAL$(Unit)
   IF VAL$(CumulConnectCmd) == "" THEN 
     CumulConnectCmd = VAL$(LineTab[iRow]) & VAL$(Unit,"%02.0f")
   ELSE
     CumulConnectCmd = VAL$(CumulConnectCmd) & "," & VAL$(LineTab[iRow]) & VAL$(Unit,"%02.0f") 
   ENDIF
 ENDIF
 
 ! ---- Plug all pins to row iRow
 ICCAP_FUNC("../../Utilities/string/cut_string_sep","execute",VAL$(Pin), ",")
 i = 0
 WHILE (i < SIZE(../../Utilities/string/substring))
   pin_val = ../../Utilities/string/substring[i]
   IF VAL$(CumulConnectCmd) == "" THEN 
     CumulConnectCmd = VAL$(LineTab[iRow]) & VAL$(pin_val,"%02.0f")
   ELSE 
     CumulConnectCmd = VAL$(CumulConnectCmd) & "," & VAL$(LineTab[iRow]) & VAL$(pin_val,"%02.0f")
   ENDIF
   i = i+1
 END WHILE
 
 hpib_cmd = "C" & VAL$(CumulConnectCmd) & "X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")	
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg=""
 
 hpib_cmd   = "P0X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 CumulConnectCmd = ""
 i = 0
 WHILE i < SIZE(RowTab)
   RowTab[i] = ""
   i = i+1
 END WHILE
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg=""
 
 CumulConnectCmd = ""
 
 ! ---- connect all pins to the ground.
 hpib_cmd   = "C"
 i = 0
 ! ---- connect all pin to line A
 WHILE i < pins_count
   i = i+1
   hpib_cmd = VAL$(hpib_cmd) & VAL$(LineTab[0]) & VAL$(i,"%02.0f") & ","
 END WHILE
 ! ---- connect ground to line A
 hpib_cmd = VAL$(hpib_cmd) & VAL$(LineTab[0]) & VAL$(ground_col,"%02.0f")
 RowTab[0] = "GROUND"
 
 ! ----- add the X for execution
 hpib_cmd = VAL$(hpib_cmd) & "X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")	
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
data "742.004"
{
}
}
LINK DAT "K70xInvert" "742.004"
{
View in_out 0 "0.811427528295 3556 2126"
View plot 0 "2.7968555255505 12424 9434"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 C15 P157 C10"
element 0 "Name" "hpib_interface"
element 0 "Value" "hpib"
element 1 "Name" "hpib_addr"
element 1 "Value" "22"
element 2 "Name" "hpib_suffix"
element 2 "Value" "\r"
element 3 "Name" "bRet"
element 3 "Value" "1"
element 4 "Name" "ErrorMsg"
element 4 "Value" ""
element 5 "Name" "ground_col"
element 5 "Value" "9"
element 6 "Name" "pins_count"
element 6 "Value" "6"
element 7 "Name" "RowTab[0]"
element 7 "Value" ""
element 8 "Name" "RowTab[1]"
element 8 "Value" ""
element 9 "Name" "RowTab[2]"
element 9 "Value" ""
element 10 "Name" "RowTab[3]"
element 10 "Value" ""
element 11 "Name" "RowTab[4]"
element 11 "Value" ""
element 12 "Name" "RowTab[5]"
element 12 "Value" ""
element 13 "Name" "RowTab[6]"
element 13 "Value" ""
element 14 "Name" "RowTab[7]"
element 14 "Value" ""
element 15 "Name" "RowTab"
element 15 "Value" "ICCAP_ARRAY[8]"
element 16 "Name" "LineTab[0]"
element 16 "Value" "A"
element 17 "Name" "LineTab[1]"
element 17 "Value" "B"
element 18 "Name" "LineTab[2]"
element 18 "Value" "C"
element 19 "Name" "LineTab[3]"
element 19 "Value" "D"
element 20 "Name" "LineTab[4]"
element 20 "Value" "E"
element 21 "Name" "LineTab[5]"
element 21 "Value" "F"
element 22 "Name" "LineTab[6]"
element 22 "Value" "G"
element 23 "Name" "LineTab[7]"
element 23 "Value" "H"
element 24 "Name" "LineTab"
element 24 "Value" "ICCAP_ARRAY[8]"
element 25 "Name" "hpib_cmd"
element 25 "Value" "CB01,D02,E03,F04X"
element 26 "Name" "CumulConnectCmd"
element 26 "Value" "B01,D02,E03,F04"
element 27 "Name" ""
element 27 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Matrix[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Matrix[Address]", "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Matrix[CmdSuffix]", "hpib_suffix")
 dummy = WPro_lookup_info("Hardware", "Matrix[GROUND]", "ground_col")
 dummy = WPro_lookup_info("Hardware", "Matrix[PinsCount]", "pins_count")
 
 bRet = 1
 ErrorMsg=""
 
 CumulConnectCmd = ""
 
 RowTab = "ICCAP_ARRAY[8]"
 i = 0
 WHILE i < SIZE(RowTab)
   RowTab[i] = ""
   i = i+1
 END WHILE
 
 LineTab = "ICCAP_ARRAY[8]"
 LineTab[0] = "A"
 LineTab[1] = "B"
 LineTab[2] = "C"
 LineTab[3] = "D"
 LineTab[4] = "E"
 LineTab[5] = "F"
 LineTab[6] = "G"
 LineTab[7] = "H"
 
 
 ! ---- reset all lines
 hpib_cmd   = "R0X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 IF bRet == 0 THEN RETURN bRet
 
 ! ------------------------
 hpib_cmd   = "V00000000X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 IF bRet == 0 THEN RETURN bRet
 
 ! ------------------------
 hpib_cmd   = "W11111111X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "connect" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 LINPUT "Unit Col", "27", Unit
 LINPUT "PinList",   "1",    Pin
 
 ICCAP_FUNC("/Driver/Utilities/string/replace_char_string","Execute",VAL$(Pin),";",",")
 Pin = /Driver/Utilities/string/resstring
 
 bRet = 1
 ErrorMsg = ""
 
 hpib_cmd   = "C"
 
 ! ---- Plug all pins to row iRow
 ICCAP_FUNC("../../Utilities/string/cut_string_sep","execute",VAL$(Pin), ",")
 i = 0
 WHILE (i < SIZE(../../Utilities/string/substring))
   pin_val = VAL(VAL$(../../Utilities/string/substring[i]))
   !pin_val = ../../Utilities/string/substring[i]
   IF (pin_val >= SIZE(LineTab)) OR (pin_val < 0) THEN
     ErrorMsg = "Invalid pin value: "&VAL$(pin_val)&". Cannot connect scanner."
     bRet = 0
     RETURN
   ENDIF
 
   IF VAL$(CumulConnectCmd) == "" THEN 
     CumulConnectCmd = VAL$(LineTab[pin_val-1]) & VAL$(VAL(Unit),"%02.0f")
   ELSE 
     CumulConnectCmd = VAL$(CumulConnectCmd) & "," & VAL$(LineTab[pin_val-1]) & VAL$(VAL(Unit),"%02.0f")
   ENDIF
   i = i+1
 END WHILE
 
 hpib_cmd = "C" & VAL$(CumulConnectCmd) & "X"
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")	
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "disconnect_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg=""
 
 hpib_cmd   = "P0X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 CumulConnectCmd = ""
 i = 0
 WHILE i < SIZE(RowTab)
   RowTab[i] = ""
   i = i+1
 END WHILE
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "ground_all" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug>0 THEN PRINT ">>> executing Xfm " & whoami() & " ..."
 
 !----------
 bRet = 1
 ErrorMsg=""
 
 CumulConnectCmd = ""
 
 ! ---- connect all pins (line) to the ground(col).
 hpib_cmd   = "C"
 i = 0
 
 ! ---- connect all line to col GROUND
 WHILE i < pins_count
   i = i+1
   IF i < pins_count THEN
     hpib_cmd = VAL$(hpib_cmd) & VAL$(LineTab[i]) & VAL$(ground_col,"%02.0f") & ","
   ELSE
     hpib_cmd = VAL$(hpib_cmd) & VAL$(LineTab[i]) & VAL$(ground_col,"%02.0f")
   ENDIF
 END WHILE
 
 ! ----- add the X for execution
 hpib_cmd = VAL$(hpib_cmd) & "X"
 
 ICCAP_FUNC("/Driver/Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface), VAL$(hpib_addr), VAL$(hpib_suffix), VAL$(hpib_cmd),"1","", "", "")
 IF /Driver/Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = /Driver/Utilities/gpib/ErrorMsg
 
 
 RETURN bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
data "742.004"
{
}
}
}
LINK DUT "Chuck" "742.004"
{
View tree_dut 1 "0"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P15 C10 C10 C10"
element 0 "Name" ""
element 0 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK TCIRC "Test Circuit" "742.004"
{
data
{
circuitdeck
{
 
}
}
}
LINK DPS "Device Parameter Set" "742.004"
{
data
{
PSTABLE "Parameter Table"
{
}
}
}
LINK CONN "Connection" "742.004"
{
data
{
CNTABLE "Connection Table"
{
}
}
}
LINK DAT "ChuckMgr" "742.004"
{
View in_out 0 "0.45231602084012 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "None"
element 5 "Name" "chuck_addr"
element 5 "Value" "None"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "curr_temperature"
element 8 "Value" "25.0"
element 9 "Name" "_____________2"
element 9 "Value" ""
element 10 "Name" ""
element 10 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
View block_edit 0 "0,0"
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! ChuckMgr is called by WaferPro for a thermochuck action.
 ! It then requests from Wafer which chuck to address,
 ! and redirects the requested action to the Setup of
 ! the requested chuck.
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Chuck           !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Chuck[Name]", "Chuck")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 IF VAL$(Chuck)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Thermochuck Defined for this Bench","Y")
   bRet = 1
   RETURN_VALUE bRet
 END IF
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Thermochuck is accessed","Y")
   END IF
   bRet = 1
   RETURN_VALUE bRet
 END IF
 !========================================
 
 ChuckDriver = "../" & VAL$(Chuck) & "/"
 ChuckCmd    = ChuckDriver & "Init"
 
 ICCAP_FUNC(ChuckCmd, "Execute")
 
 bRet = lookup_var(ChuckDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ChuckDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Chuck           !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Chuck[Name]", "Chuck")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Chuck)=="" THEN 
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Thermochuck Defined for this Bench","Y")
   dummy = WPro_lookup_info("Context", "Temperature", "curr_temperature")
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Thermochuck is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ChuckDriver = "../" & VAL$(Chuck) & "/"
 ChuckCmd    = ChuckDriver & "get_temperature"
 
 ICCAP_FUNC(ChuckCmd, "Execute")
 
 bRet = lookup_var(ChuckDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ChuckDriver & "ErrorMsg"))
 curr_temperature = lookup_var(ChuckDriver & "curr_temperature")
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  Chuck           !SetupVariable
 
 !---------------------------------------------------------------------
 XfmMsg = ">>> exec. Xfm '" & whoami() & "' ..."
 IF Debug >= 1 THEN PRINT XfmMsg
 !---------------------------------------------------------------------
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "Set temperature", temperature
 
 !--- Define local variables for this Program
 Path2Setup  = WHOIS(".", "Parent Setup")
 DTypeName   = WHOIS(".", "Parent DUT PartName")
 DriverName  = WHOIS(".", "Parent Setup PartName")
 XFormName   = WHOAMI("PartName")
 FuncPath    = DTypeName&"/"&DriverName&"/"&XFormName
 
 dummy = WPro_lookup_info("Hardware", "Chuck[Name]", "Chuck")
 dummy = WPro_lookup_info("Run", "Mode", "Mode")
 
 IF Debug >= 2 THEN iccap_func("showMessage","Execute",VAL$(XfmMsg),"N")
 
 IF VAL$(Chuck)=="" THEN
   IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Thermochuck Defined for this Bench","Y")
   curr_temperature = temperature
   RETURN_VALUE 1
 END IF
 
 IF VAL$(Mode) <> "Measure" THEN
   IF VAL$(Mode) <> "Load From Record" THEN
     IF Debug >= 2 THEN iccap_func("showMessage","Execute",FuncPath&": No Measure Mode: No Thermochuck is accessed","Y")
   END IF
   RETURN_VALUE 1
 END IF
 
 !========================================
 
 ChuckDriver = "../" & VAL$(Chuck) & "/"
 ChuckCmd    = ChuckDriver & "set_temperature"
 
 ICCAP_FUNC(ChuckCmd, "Execute", temperature)
 
 bRet = lookup_var(ChuckDriver & "bRet")
 ErrorMsg = VAL$(lookup_var(ChuckDriver & "ErrorMsg"))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "showMessage" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [showMessage]
 
 GLOBAL_VAR  TmpVar          !ModelVariable
 
 GET_STRING "Message?", msg$
 GET_STRING "Show in Status Window?", stw$
 
 dummy = WPro_lookup_info("Run", "SingleExeRun", "TmpVar")
 
 IF VAL$(TmpVar)=="TRUE" THEN
   GET_STRING msg$ & "   [OK]", dummy
 END IF
 
 c$ = upc$(substr$(trim$(stw$),1,1))
 IF c$=="Y" OR c$=="T" OR c$=="1" THEN
   PRINT msg$
 END IF
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Manual" "742.004"
{
View in_out 0 "0.45231602084012 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "None"
element 5 "Name" "hpib_addr"
element 5 "Value" "0"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "curr_temperature"
element 8 "Value" "25.0"
element 9 "Name" "min_temperature"
element 9 "Value" ""
element 10 "Name" "max_temperature"
element 10 "Value" ""
element 11 "Name" "_____________2"
element 11 "Value" ""
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! Manual is called by ChuckMgr
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 !curr_temperature = "27"
 dummy = WPro_lookup_info("Context", "Temperature", "curr_temperature")
 
 Msg = "exec. Init Chuck"
 GET_STRING Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 Msg = "Enter current chuck temperature"
 GET_STRING Msg, curr_temperature, curr_temperature
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "set temperature", temperature
 
 Msg = "Set chuck temperature to " & VAL$(temperature)
 LINPUT Msg, "<-- Click OK -->", dummy
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Virtual" "742.004"
{
View in_out 0 "0.45231602084012 3556 2094"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "_____________0"
element 3 "Value" ""
element 4 "Name" "hpib_interface"
element 4 "Value" "None"
element 5 "Name" "hpib_addr"
element 5 "Value" "0"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "_____________1"
element 7 "Value" ""
element 8 "Name" "curr_temperature"
element 8 "Value" "25.0"
element 9 "Name" "min_temperature"
element 9 "Value" ""
element 10 "Name" "max_temperature"
element 10 "Value" ""
element 11 "Name" "_____________2"
element 11 "Value" ""
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [README]
 
 ! Virtual is called by ChuckMgr
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [Init]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  hpib_interface  !SetupVariable
 GLOBAL_VAR  hpib_addr       !SetupVariable
 GLOBAL_VAR  hpib_suffix     !SetupVariable
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 !curr_temperature = "27"
 dummy = WPro_lookup_info("Context", "Temperature", "curr_temperature")
 
 Msg = "exec. Init Chuck"
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [get_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 dummy = WPro_lookup_info("Context", "Temperature", "curr_temperature") 
 Msg = "Enter current chuck temperature: " & VAL$(curr_temperature)
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 !-- [set_temperature]
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  curr_temperature !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 LINPUT "set temperature", temperature
 
 Msg = "Set chuck temperature to " & VAL$(temperature) 
 dummy = WPro_set_info("Context", "Temperature", VAL$(temperature))
 PRINT Msg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "Accretech" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "curr_temperature"
element 3 "Value" "25.0"
element 4 "Name" "hpib_interface"
element 4 "Value" "hpib25"
element 5 "Name" "hpib_addr"
element 5 "Value" "27"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "min_temperature"
element 7 "Value" "-40"
element 8 "Name" "max_temperature"
element 8 "Value" "150"
element 9 "Name" "timeout_short"
element 9 "Value" "3"
element 10 "Name" "timeout_medium"
element 10 "Value" "30"
element 11 "Name" "timeout_long"
element 11 "Value" "1000"
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 bRet = 1
 ErrorMsg = ""
 
 !-- Set Available Temp Range
 min_temperature  = -40
 max_temperature  = 150
 curr_temperature = 0
 
 !-- Timeout Setting
 timeout_short  = 3
 timeout_medium = 30
 timeout_long   = 1000
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 !-- coordinate request
 hpib_cmd        = "f"      
 reply_prototype = "fCURTSETT\r"
 nb_chars        = STRLEN(reply_prototype)
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 curr_temperature = VAL(SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),2,5))//10
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 LINPUT "set temperature (C)", temperature
 
 temperature = VAL(temperature)
 
 IF temperature < min_temperature OR temperature > max_temperature THEN
   ErrorMsg = "Trying to set temperature outside chuck allowed range"
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 temperature = temperature*10
 temperature=VAL$(temperature,"%04.0f")
 
 hpib_cmd     = "h"&VAL$(temperature)
 timeout      = timeout_short
 success_ids  = "93"
 failure_ids  = "99;76"
 failure_msgs = "Cannot set temperature; chuck gpib error"
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = ../../Utilities/gpib/ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "ATT" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P11 P179 C15 C10"
element 0 "Name" "hpib_interface"
element 0 "Value" "gpib0"
element 1 "Name" "hpib_addr"
element 1 "Value" "22"
element 2 "Name" "hpib_suffix"
element 2 "Value" "\r"
element 3 "Name" "ErrorMsg"
element 3 "Value" ""
element 4 "Name" "bRet"
element 4 "Value" "1"
element 5 "Name" "PBresult"
element 5 "Value" "0: 26.16 C 2"
element 6 "Name" "requested_temperature"
element 6 "Value" "25"
element 7 "Name" "curr_temperature"
element 7 "Value" "25.0"
element 8 "Name" ""
element 8 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 ! March 2011,  franz.sischka@agilent.com
 
 
 ! driver for CascadeMicrotech ATT thermo chuck,
 ! controlled by ProberBench
 
 
 RETURN_VALUE 1
 
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR hpib_interface   !SetupVariable
 GLOBAL_VAR hpib_addr        !SetupVariable
 GLOBAL_VAR hpib_suffix      !SetupVariable
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 bRet = 1
 ErrorMsg = ""
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  curr_temperature
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !---get temperature
 ICCAP_FUNC("do_prober_cmd", "Execute", "GetHeaterTemp C")   !call macro and anticipate its GET_STRING
 
 curr_temperature=SUBSTR$(VAL$(PBresult), 4, STRLEN(VAL$(PBresult))-4)
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  requested_temperature
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 !----------this is answered by WaferPro
 GET_STRING "set temperature", "27", requested_temperature
 
 !---set temperature
 ICCAP_FUNC("do_prober_cmd", "Execute", "SetHeaterTemp "&VAL$(requested_temperature)&" C")   !call macro and anticipate its GET_STRING
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
LINK XFORM "do_prober_cmd" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program2"
}
BLKEDIT "Program Body"
{
 
 GLOBAL_VAR  Debug           !ModelVariable, WaferPro Debug Level
 GLOBAL_VAR  Mode            !ModelVariable, WaferPro Test Plan Mode
 GLOBAL_VAR  bRet            !Setup/ModelVariable, WaferPro Success(=1)/Nonsuccess(=0) Flag
 GLOBAL_VAR  ErrorMsg        !Setup/ModelVariable, Error Message sent to WaferPro when Nonsuccess
 
 GLOBAL_VAR  PBresult      ! returned PBresult from the prober
 GLOBAL_VAR  hpib_interface   ! Prober Interface, e.g. gpib0
 GLOBAL_VAR  hpib_addr      ! Prober Address, e.g. 27
 
 
 ! Jan.2011,     franz.sischka@agilent.com
 ! This Program sends a command to the Prober, 
 ! waits for the response of the fulfilled command 
 ! and returns that response into Variable 'PBresult'.
 !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 bRet = 1
 ErrorMsg = ""
 !------------
 
 PBresult = ""
 
 !---start of the program
 GET_STRING "Enter ProberBench command", "MoveChuckContact", PB_command
 IF Debug >= 1 THEN PRINT "  >sending prober command: ";PB_command;" ..."
 
 
 !---communicate with the prober
 hpib_num = HPIB_open(VAL$(hpib_interface))
 
 status   = HPIB_write(hpib_num, hpib_addr, VAL$(PB_command))
 
 status   = HPIB_timeout(hpib_num, 1000) ! Wait max. 1000 sec for reply (we set 1000 for proper handshake).
                                         ! Important Note: the long time-out is also required for long executing prober commands such as 'align', large 'move_index' etc.)
 
 status   = HPIB_read(hpib_num, hpib_addr, 200, "A", "PBresult")   ! read the big string into Setup Variable 'PBresult'
                      ! read all ('A') bytes, max. 200 bytes (chars)
 dummy    = HPIB_close(hpib_num)
 
 
 !---verify the execution
 IF STRPOS(VAL$(PBresult), "0:")==1 THEN 
   !PBresult string starts with "0:", i.e. no error had occurred
   !Note: more information (e.g. x-y position etc.) may be 
   !      included after the "0:", but is ignored here.
   RETURN_VALUE 1   !command performed without errors
 END IF
 
 
 IF VAL$(PBresult)=="" THEN PBresult="No connection to prober or time-out" 
 ErrorMsg="ERROR AT PROBER: "&VAL$(PBresult)
 bRet=0
 
 
 RETURN_VALUE 0
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "___________________1" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "PS21" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "curr_temperature"
element 3 "Value" "25.0"
element 4 "Name" "hpib_interface"
element 4 "Value" "hpib25"
element 5 "Name" "hpib_addr"
element 5 "Value" "28"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "min_temperature"
element 7 "Value" "-40"
element 8 "Name" "max_temperature"
element 8 "Value" "150"
element 9 "Name" "timeout_short"
element 9 "Value" "3"
element 10 "Name" "timeout_medium"
element 10 "Value" "30"
element 11 "Name" "timeout_long"
element 11 "Value" "1000"
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 bRet = 1
 ErrorMsg = ""
 
 !-- Set Available Temp Range
 min_temperature  = -40
 max_temperature  = 150
 curr_temperature = 0
 
 !-- Timeout Setting
 timeout_short  = 3
 timeout_medium = 30
 timeout_long   = 1000
 
 ! ----- set command mode to TEL
 hpib_cmd     = "$:set:mode TEL"
 timeout      = timeout_short
 success_ids  = ""
 failure_ids  = ""
 failure_msgs = ""
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = ../../Utilities/gpib/ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 !-- coordinate request
 hpib_cmd        = "f1"
 reply_prototype = "xxx.x\r"
 nb_chars        = STRLEN(reply_prototype)
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 curr_temperature = VAL(SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,5))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 LINPUT "set temperature (C)", temperature
 
 temperature = VAL(temperature)
 
 IF temperature < min_temperature OR temperature > max_temperature THEN
   ErrorMsg = "Trying to set temperature outside chuck allowed range"
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 ! request current tqrget temp
 hpib_cmd        = "f2"
 reply_prototype = "xxx.x\r"
 nb_chars        = STRLEN(reply_prototype)
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 curr_temperature = VAL(SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,5))
 
 IF curr_temperature == temperature THEN RETURN_VALUE bRet
 
 temperature=VAL$(temperature,"%03.0f")
 
 hpib_cmd="h"&VAL$(temperature)
 timeout      = timeout_long
 success_ids  = "89"
 failure_ids  = "80;254"
 failure_msgs = "Cannot set temperature; chuck gpib syntax error"
 bRet = 1
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = ../../Utilities/gpib/ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "SUMMIT" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "curr_temperature"
element 3 "Value" "25.0"
element 4 "Name" "hpib_interface"
element 4 "Value" "hpib"
element 5 "Name" "hpib_addr"
element 5 "Value" "27"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "min_temperature"
element 7 "Value" "-40"
element 8 "Name" "max_temperature"
element 8 "Value" "150"
element 9 "Name" "timeout_short"
element 9 "Value" "3"
element 10 "Name" "timeout_medium"
element 10 "Value" "30"
element 11 "Name" "timeout_long"
element 11 "Value" "1000"
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 bRet = 1
 ErrorMsg = ""
 
 !-- Set Available Temp Range
 min_temperature  = -40
 max_temperature  = 150
 curr_temperature = 0
 
 !-- Timeout Setting
 timeout_short  = 3
 timeout_medium = 30
 timeout_long   = 1000
 
 
 ! ----- set command mode to SUMMIT
 hpib_cmd     = "$:set:mode SUMMIT"
 timeout      = timeout_short
 success_ids  = ""
 failure_ids  = ""
 failure_msgs = ""
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
 ENDIF
 
 ! ----- set response on
 hpib_cmd     = "$:set:resp on"
 timeout      = timeout_short
 success_ids  = ""
 failure_ids  = ""
 failure_msgs = ""
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
 ENDIF
 
 ! ----- activate chuck
 hpib_cmd        = ":ther:acti"      
 reply_prototype = "COMPLETE"
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
 ENDIF
 IF SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,nb_chars) <> VAL$(reply_prototype) THEN
   ErrorMsg = ../../Utilities/gpib/gpib_answer
   bRet = 0
 ENDIF 
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 ! ----- get chuck temp
 hpib_cmd        = ":ther:temp:curr?"      
 reply_prototype = "sxxx.x                                                    "
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
 ENDIF
 
 curr_temperature = VAL(VAL$(../../Utilities/gpib/gpib_answer))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 LINPUT "set temperature (C)", temperature
 
 temperature = VAL(temperature)
 
 IF temperature < min_temperature OR temperature > max_temperature THEN
   ErrorMsg = "Trying to set temperature outside chuck allowed range"
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 temperature=VAL$(temperature,"%.1f")
 
 
 !----- deactivate
 hpib_cmd        = ":ther:deac"  !-- ":thermalchuck:deactivate"      
 reply_prototype = "COMPLETE"
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 IF SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,nb_chars) <> VAL$(reply_prototype) THEN
   ErrorMsg = ../../Utilities/gpib/gpib_answer
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 
 ! ----- set chuck temp
 hpib_cmd        = ":ther:temp:sett " & VAL$(temperature)
 reply_prototype = "COMPLETE"
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 IF SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,nb_chars) <> VAL$(reply_prototype) THEN
   ErrorMsg = ../../Utilities/gpib/gpib_answer
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 
 !----- activate
 hpib_cmd        = ":ther:acti"  !-- ":thermalchuck:activate"      
 reply_prototype = "COMPLETE"
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 IF SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,nb_chars) <> VAL$(reply_prototype) THEN
   ErrorMsg = ../../Utilities/gpib/gpib_answer
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "TEL" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "curr_temperature"
element 3 "Value" "25.0"
element 4 "Name" "hpib_interface"
element 4 "Value" "hpib25"
element 5 "Name" "hpib_addr"
element 5 "Value" "5"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "min_temperature"
element 7 "Value" "-40"
element 8 "Name" "max_temperature"
element 8 "Value" "150"
element 9 "Name" "timeout_short"
element 9 "Value" "10"
element 10 "Name" "timeout_medium"
element 10 "Value" "30"
element 11 "Name" "timeout_long"
element 11 "Value" "1000"
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 !-- Set Available Temp Range
 min_temperature  = -40
 max_temperature  = 150
 curr_temperature = 0
 
 !-- Timeout Setting
 timeout_short  = 10
 timeout_medium = 30
 timeout_long   = 1000
 
 bRet = 1
 ErrorMsg = ""
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 hpib_cmd        = "f1"      
 reply_prototype = "000.0rn"
 nb_chars        = STRLEN(reply_prototype)
 
 bRet = 1
 ErrorMsg = ""
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib_noClear","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib_noClear[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   RETURN_VALUE bRet
 ENDIF
 
 curr_temperature = VAL(SUBSTR$(VAL$(../../Utilities/gpib/gpib_answer),1,5))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib_noClear"
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 LINPUT "set temperature (degC)", temperature
 
 temperature = VAL(temperature)
 
 bRet = 1
 ErrorMsg = ""
 
 IF temperature < min_temperature OR temperature > max_temperature THEN
   bRet = 0
   ErrorMsg = "Trying to set temperature outside chuck allowed range"
   RETURN_VALUE bRet
 ENDIF
 
 temperature = VAL$(temperature,"%03.0f")
 
 hpib_cmd     = "h" & VAL$(temperature)
 timeout      = timeout_short
 success_ids  = "89"          !-- 0x59: Done
 failure_ids  = "80;254;255"  !-- 0x50;FE;FF
 failure_msgs = "prober error;command error;parameter error"
 
 bRet = 1
 ErrorMsg = ""
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
 ENDIF
 
 ErrorMsg = ../../Utilities/gpib/ErrorMsg
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
LINK DAT "TP032A" "742.004"
{
View in_out 0 "0.811427528295 3556 2094"
View plot 0 "1.8 7995 6071"
TABLE "Variable Table" "742.004"
{
View par_var_table 0 "V530 P22 P151 C15 C10"
element 0 "Name" "Chuck"
element 0 "Value" ""
element 1 "Name" "bRet"
element 1 "Value" "1"
element 2 "Name" "ErrorMsg"
element 2 "Value" ""
element 3 "Name" "curr_temperature"
element 3 "Value" "25.0"
element 4 "Name" "hpib_interface"
element 4 "Value" "hpib"
element 5 "Name" "hpib_addr"
element 5 "Value" "28"
element 6 "Name" "hpib_suffix"
element 6 "Value" "\r"
element 7 "Name" "min_temperature"
element 7 "Value" "-40"
element 8 "Name" "max_temperature"
element 8 "Value" "150"
element 9 "Name" "timeout_short"
element 9 "Value" "3"
element 10 "Name" "timeout_medium"
element 10 "Value" "30"
element 11 "Name" "timeout_long"
element 11 "Value" "1000"
element 12 "Name" ""
element 12 "Value" ""
}
TABLE "GUI Table" "742.004"
{
element 0 "Name" ""
element 0 "Value" ""
}
LINK SWEEP "See_under_ExtractOptimize" "742.004"
{
View draw_ds 0 "B,166,166"
data
{
HYPTABLE "Edit Sweep Info"
{
element "Mode" "V"
element "Sweep Type" "CON"
}
HYPTABLE "Edit Sweep Mode Def"
{
element "+ Node" ""
element "- Node" "GROUND"
element "Unit" ""
element "Compliance" " 0.000 "
}
HYPTABLE "Edit Sweep Def"
{
element "Value" " 0.000 "
}
}
}
LINK XFORM "README" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{

}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "Init" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 dummy = WPro_lookup_info("Hardware", "Chuck[Controller]", "hpib_interface")
 dummy = WPro_lookup_info("Hardware", "Chuck[Address]",    "hpib_addr")
 dummy = WPro_lookup_info("Hardware", "Chuck[CmdSuffix]",  "hpib_suffix")
 
 bRet = 1
 ErrorMsg = ""
 
 !-- Set Available Temp Range
 min_temperature  = -40
 max_temperature  = 150
 curr_temperature = 0
 
 !-- Timeout Setting
 timeout_short  = 3
 timeout_medium = 30
 timeout_long   = 1000
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
}
LINK XFORM "get_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 ! ----- get chuck temp
 hpib_cmd        = "TEMP?"
 reply_prototype = "sxxx.x                                                    "
 nb_chars        = STRLEN(reply_prototype)
 
 ICCAP_FUNC("../../Utilities/gpib/receive_gpib","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(nb_chars))
 IF ../../Utilities/gpib/receive_gpib[0] == 0 THEN
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
   bRet = 0
 ENDIF
 
 curr_temperature = VAL(VAL$(../../Utilities/gpib/gpib_answer))
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/receive_gpib"
}
LINK XFORM "set_temperature" "742.004"
{
data
{
HYPTABLE "Link Transform"
{
element "Function" "Program"
}
BLKEDIT "Program Body"
{
 UPDATE_EXPLICIT
 
 IF Debug >= 1 THEN PRINT ">>> exec. Xfm '" & whoami() & "' ..."
 
 !----------
 bRet = 1
 ErrorMsg = ""
 
 LINPUT "set temperature (C)", temperature
 
 temperature = VAL(temperature)
 
 IF temperature < min_temperature OR temperature > max_temperature THEN
   ErrorMsg = "Trying to set temperature outside chuck allowed range"
   bRet = 0
   RETURN_VALUE bRet
 ENDIF
 
 temperature=VAL$(temperature,"%05.1lf")
 
 ! ----- set chuck temp
 hpib_cmd     = "SETN 1"
 timeout      = timeout_short
 success_ids  = ""
 failure_ids  = ""
 failure_msgs = ""
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
 ENDIF
 
 
 hpib_cmd     = "SETP "& VAL$(temperature)
 timeout      = timeout_short
 success_ids  = ""
 failure_ids  = ""
 failure_msgs = ""
 
 ICCAP_FUNC("../../Utilities/gpib/send_gpib_cmd","Execute",VAL$(hpib_interface),VAL$(hpib_addr),VAL$(hpib_suffix),VAL$(hpib_cmd),VAL$(timeout),VAL$(success_ids),VAL$(failure_ids),VAL$(failure_msgs))
 IF ../../Utilities/gpib/send_gpib_cmd[0] == 0 THEN
   bRet = 0
   ErrorMsg = ../../Utilities/gpib/ErrorMsg
 ENDIF
 
 
 RETURN_VALUE bRet
}
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
dataset
{
datasize COMMON 1 1 1
type COMMON
point 0 1 1 0 0
}
}
member XFORM "Utilities/gpib/send_gpib_cmd"
}
LINK XFORM "___________________0" "742.004"
{
data
{
OPTIMEDIT
{
TABLE "More" 0 "742.004"
{
element 0 "Rank 1 Flag" "Yes"
element 0 "Param Delta" " 1.000m"
element 0 "Param Print" "A"
element 0 "Error Print" "A"
element 0 "Sens Print" "I"
element 0 "Normal Sens" "Yes"
element 0 "Optim Mode" "L"
element 0 "Rand Std Dev" " 300.0m"
element 0 "Rand Reward" " 500.0m"
element 0 "Rand Penalty" " 500.0m"
element 0 "Rand Seed" "0"
element 0 "Rand Iters" "25"
element 0 "Max Iters" "25"
}
TABLE "Input Table" 1 "742.004"
{
element 0 "Target" ""
element 0 "Simulated" ""
element 0 "Weight" " 1.000 "
element 0 "Target Min" " 0.000 "
element 0 "Target Max" " 0.000 "
element 0 "X Min" " 0.000 "
element 0 "X Max" " 0.000 "
element 0 "Curve Min" ""
element 0 "Curve Max" ""
element 0 "X Data Ref" ""
element 0 "Curve Data" ""
element 0 "Reference SetUp" ""
}
TABLE "Param Table" 1 "742.004"
{
element 0 "Use" "Yes"
element 0 "Name" ""
element 0 "Min" " 1.000f"
element 0 "Value" ""
element 0 "Max" " 1.000MEG"
element 0 "Stored" " 0.000 "
element 0 "Tuner (L)IN/LO(G)" "G"
}
TABLE "Options Table" 0 "742.004"
{
element 0 "Y Lower Bnd" " 0.000 "
element 0 "Y Upper Bnd" " 0.000 "
element 0 "X Lower Bnd" " 0.000 "
element 0 "X Upper Bnd" " 0.000 "
element 0 "Comb Filter" "1"
element 0 "RMS error" " 10.00m"
element 0 "Max error" " 10.00m"
element 0 "Abs Err Flag" "No"
element 0 "Param Tol" " 1.000m"
element 0 "Function Tol" " 1.000m"
element 0 "Max Evals" "100"
element 0 "Extract Flag" "No"
}
PLOTOPTIONS
ENDPLOTOPTIONS
}
HYPTABLE "Step Editor"
{
element "Step Name" ""
element "Step Source" "Local"
element "Auto Update" "No"
element "Setup Reference" ""
element "Step Type (O/T)" "T"
element "Sim Precondition" "No"
element "Range Precondition" "N"
element "Sim Speed" "F"
element "Plots Per Row" "0"
element "Optional" "No"
}
BLKEDIT "Step Description"
{

}
}
}
data "742.004"
{
}
}
}
}
